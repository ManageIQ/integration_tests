---
- MiqPolicySet:
    name: 820849ce-a7fb-11e0-abed-005056af0000
    description: ! 'Analysis: Do Not Analyze Active VDI VMs'
    set_type: MiqPolicySet
    guid: 820849ce-a7fb-11e0-abed-005056af0000
    read_only: 
    set_data:
      :notes: This policy profile checks to see if a VDI vm is being actively used
        by a user. If a user is currently connected to the session, it will prevent
        the vm from being analyzed
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 1c4c7772-a7fb-11e0-abed-005056af0000
      description: Do Not Analyze Active VDI VMs
      expression: 
      towhat: Vm
      guid: 1c4c7772-a7fb-11e0-abed-005056af0000
      created_by: admin
      updated_by: admin
      notes: This policy prevents analysis of a vm that has an active user session
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_start
          description: VM Analysis Start
          guid: 057b9baa-519c-11e0-8d82-005056af0000
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: 
      Condition:
      - name: 0a50f750-a7fb-11e0-abed-005056af0000
        description: VM has an active session
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            =:
              field: Vm-has_active_vdi_session
              value: 'true'
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 0a50f750-a7fb-11e0-abed-005056af0000
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000007
        notes: 
- MiqPolicySet:
    name: 43e76af6-3f8e-11e0-aaa0-00505688000a
    description: ! 'Analysis: Exclude Specially Tagged VMs'
    set_type: MiqPolicySet
    guid: 43e76af6-3f8e-11e0-aaa0-00505688000a
    read_only: 
    set_data:
      :notes: Prevents the analysis of vms tagged as do not analyze
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: ! 'Do Not Analyze '
      description: ! 'Analysis: Prevent Analysis of Selected VMs'
      expression: 
      towhat: Vm
      guid: 3a7959c0-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not
        Analyze '
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: request_vm_scan
          description: VM Analysis Request
          guid: e3292c46-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: 
      Condition:
      - name: Do Not Analyze
        description: VM classified as DO_NOT_ANALYZE
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-exclusions
              value: do_not_analyze
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 39ff4444-08e2-11de-829f-005056a164b2
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000001
        notes: 
- MiqPolicySet:
    name: 612b936c-3d2d-11df-a7e9-005056a40709
    description: ! 'Analysis: Manage VMs'
    set_type: MiqPolicySet
    guid: 612b936c-3d2d-11df-a7e9-005056a40709
    read_only: 
    set_data:
      :notes: ! '1)Create a new Tag Category called Operations (Show in EVM Console
        and Single Value)

        2)Create the following Tags under this new Operations Category (analysis_failed,
        analysis_required, analysis_success)

        3)Create Global Filters for VMs for Analysis Failed and Analysis Required
        to easily find tagged VMs.

        4)Set up a Schedule to run as desired that will process the VMs that currently
        match the Global Filter. Ex: Analyze all VMs that are tagged with "Analysis
        Required".


'
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: ! 'Do Not Analyze '
      description: ! 'Analysis: Prevent Analysis of Selected VMs'
      expression: 
      towhat: Vm
      guid: 3a7959c0-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not
        Analyze '
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: request_vm_scan
          description: VM Analysis Request
          guid: e3292c46-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: 
      Condition:
      - name: Do Not Analyze
        description: VM classified as DO_NOT_ANALYZE
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-exclusions
              value: do_not_analyze
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 39ff4444-08e2-11de-829f-005056a164b2
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000001
        notes: 
    - name: b968f0a0-3d2e-11df-a7e9-005056a40709
      description: ! 'Tag: VM that Requires Analysis'
      expression: 
      towhat: Vm
      guid: b968f0a0-3d2e-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reset
          description: VM Reset
          guid: 4c1b8a3a-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      Condition: []
    - name: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      description: ! 'Tag: VM on Successful Analysis'
      expression: 
      towhat: Vm
      guid: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: cd2f3222-3d2c-11df-a7e9-005056a40709
          description: Tag VM after Successful Analysis
          guid: cd2f3222-3d2c-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_success
      Condition: []
    - name: 07cea762-3d1b-11df-a7e9-005056a40709
      description: ! 'Tag: VM if Analysis not successful'
      expression: 
      towhat: Vm
      guid: 07cea762-3d1b-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_abort
          description: VM Analysis Failure
          guid: 4c48a6fa-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: fc7f2dde-3d22-11df-a7e9-005056a40709
          description: Tag VM that Fails Analysis
          guid: fc7f2dde-3d22-11df-a7e9-005056a40709
          action_type: tag
          options:
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            :tags:
            - /managed/operations/analysis_failed
      Condition: []
- MiqPolicySet:
    name: ab815d74-e54c-11e1-b69c-005056b057a8
    description: ! 'Analysis: Manage VMs'
    set_type: MiqPolicySet
    guid: ab815d74-e54c-11e1-b69c-005056b057a8
    read_only: 
    set_data:
      :notes: ! '1)Create a new Tag Category called Operations (Show in EVM Console
        and Single Value)

        2)Create the following Tags under this new Operations Category (analysis_failed,
        analysis_required, analysis_success)

        3)Create Global Filters for VMs for Analysis Failed and Analysis Required
        to easily find tagged VMs.

        4)Set up a Schedule to run as desired that will process the VMs that currently
        match the Global Filter. Ex: Analyze all VMs that are tagged with "Analysis
        Required".

'
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: b968f0a0-3d2e-11df-a7e9-005056a40709
      description: ! 'Tag: VM that Requires Analysis'
      expression: 
      towhat: Vm
      guid: b968f0a0-3d2e-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reset
          description: VM Reset
          guid: 4c1b8a3a-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      Condition: []
    - name: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      description: ! 'Tag: VM on Successful Analysis'
      expression: 
      towhat: Vm
      guid: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: cd2f3222-3d2c-11df-a7e9-005056a40709
          description: Tag VM after Successful Analysis
          guid: cd2f3222-3d2c-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_success
      Condition: []
    - name: 07cea762-3d1b-11df-a7e9-005056a40709
      description: ! 'Tag: VM if Analysis not successful'
      expression: 
      towhat: Vm
      guid: 07cea762-3d1b-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_abort
          description: VM Analysis Failure
          guid: 4c48a6fa-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: fc7f2dde-3d22-11df-a7e9-005056a40709
          description: Tag VM that Fails Analysis
          guid: fc7f2dde-3d22-11df-a7e9-005056a40709
          action_type: tag
          options:
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            :tags:
            - /managed/operations/analysis_failed
      Condition: []
    - name: ! 'Do Not Analyze '
      description: ! 'Analysis: Prevent Analysis of Selected VMs'
      expression: 
      towhat: Vm
      guid: 3a7959c0-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not
        Analyze '
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: request_vm_scan
          description: VM Analysis Request
          guid: e3292c46-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: 
      Condition:
      - name: Do Not Analyze
        description: VM classified as DO_NOT_ANALYZE
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-exclusions
              value: do_not_analyze
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 39ff4444-08e2-11de-829f-005056a164b2
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000001
        notes: 
- MiqPolicySet:
    name: 3872a0e8-50bc-11e0-880e-00505688000a
    description: ! 'Analysis: On VM Reconfiguration'
    set_type: MiqPolicySet
    guid: 3872a0e8-50bc-11e0-880e-00505688000a
    read_only: 
    set_data:
      :notes: Triggers a VM analysis when a VM is reconfigured
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 2f2a1a1c-4806-11df-badc-005056a7121f
      description: ! 'Analysis: VM Reconfiguration'
      expression: 
      towhat: Vm
      guid: 2f2a1a1c-4806-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Performs an analysis on any vm that has been reconfigured
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: 
      Condition: []
- MiqPolicySet:
    name: 079d2408-44ef-11e0-99a6-00505688000a
    description: ! 'Analysis: VDI Login'
    set_type: MiqPolicySet
    guid: 079d2408-44ef-11e0-99a6-00505688000a
    read_only: 
    set_data:
      :notes: This policy profile automatically analyzes a VDI session when a user
        logs in to it.
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 782068f8-44ee-11e0-99a6-00505688000a
      description: ! 'Analysis: VDI Login'
      expression: 
      towhat: Vm
      guid: 782068f8-44ee-11e0-99a6-00505688000a
      created_by: admin
      updated_by: admin
      notes: This policy triggers an analysis of a VDI session when a user logs in
        to that session
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_vdi_login_session
          description: VDI Login Session
          guid: 15fc3cce-448a-11e0-9ad1-00505688000a
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: 
      Condition: []
- MiqPolicySet:
    name: a7fc3c18-306a-11de-971a-005056a12545
    description: ! 'Compliance: DISA STIG'
    set_type: MiqPolicySet
    guid: a7fc3c18-306a-11de-971a-005056a12545
    read_only: 
    set_data:
      :notes: DISA STIG ESX SERVER V1R1 - Based on Security Technical Implementation
        Guide for ESX Server Version 1, Release 1 28 April 2008
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 56c4d50e-3069-11de-971a-005056a12545
      description: DISA ESX Server STIG - ESX1170 requires IAO/SA to remove or disable
        all unused hardware on VM
      expression: 
      towhat: Vm
      guid: 56c4d50e-3069-11de-971a-005056a12545
      created_by: 
      updated_by: 
      notes: 
      active: true
      mode: control
      MiqPolicyContent: []
      Condition:
      - name: 627379ac-3067-11de-971a-005056a12545
        description: ! 'ESX1170: CAT II - Guest OS remove all unused hardware'
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkcount:
                  =:
                    field: <count>
                    value: 0
                search:
                  INCLUDES:
                    field: Vm.hardware.disks-device_type
                    value: floppy
            - FIND:
                checkcount:
                  =:
                    field: <count>
                    value: 0
                search:
                  INCLUDES:
                    field: Vm.hardware.disks-device_type
                    value: cdrom
        towhat: Vm
        file_mtime: 
        guid: 627379ac-3067-11de-971a-005056a12545
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000010
        notes: 
    - name: 69b1559e-3068-11de-971a-005056a12545
      description: DISA ESX Server STIG requires that the Virtual Machine Administrator
        be responsible for the following
      expression: 
      towhat: Vm
      guid: 69b1559e-3068-11de-971a-005056a12545
      created_by: 
      updated_by: 
      notes: 
      active: true
      mode: control
      MiqPolicyContent: []
      Condition:
      - name: ed826874-3066-11de-971a-005056a12545
        description: ! 'ESX1030: CAT II - Test and Development VMs must be seperated
          from Production VMs'
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkcount:
                  ! '>=':
                    field: <count>
                    value: 1
                search:
                  STARTS WITH:
                    field: Vm.hardware.networks-ipaddress
                    value: '192.168'
            - CONTAINS:
                tag: Vm.managed-environment
                value: prod
        towhat: Vm
        file_mtime: 
        guid: ed826874-3066-11de-971a-005056a12545
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000011
        notes: 
      - name: 28e35e32-3067-11de-971a-005056a12545
        description: ! 'ESX0940: CAT II - prevent use of nonpersistent disk mode'
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkcount:
                =:
                  field: <count>
                  value: 0
              search:
                INCLUDES:
                  field: Vm.hardware.disks-mode
                  value: nonpersistent
        towhat: Vm
        file_mtime: 
        guid: 28e35e32-3067-11de-971a-005056a12545
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000011
        notes: 
    - name: de9aa7ec-3069-11de-971a-005056a12545
      description: DISA Information Assurance Vulnerability Alert - MS08-67
      expression: 
      towhat: Vm
      guid: de9aa7ec-3069-11de-971a-005056a12545
      created_by: 
      updated_by: 
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: e452e922-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: 7e492e4c-3067-11de-971a-005056a12545
        description: IAVA - MS08-067 for Windows 2000 Service Pack 4
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkall:
                  STARTS WITH:
                    field: Vm.filesystems-file_version
                    value: 5.00.2195.7203
                search:
                  =:
                    field: Vm.filesystems-name
                    value: c:/winnt/system32/netapi32.dll
            - KEY EXISTS:
                regkey: HKLM\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB958644\Filelist
        towhat: Vm
        file_mtime: 
        guid: 7e492e4c-3067-11de-971a-005056a12545
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            and:
            - STARTS WITH:
                field: Vm.operating_system-product_name
                value: Microsoft Windows 2000
            - =:
                field: Vm.operating_system-service_pack
                value: Service Pack 4
        miq_policy_id: 10000000000012
        notes: 
      - name: 8b0d83d0-3067-11de-971a-005056a12545
        description: IAVA - MS08-067 for Windows Server 2003 Service Pack 1 & 2
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - and:
              - =:
                  field: Vm.operating_system-service_pack
                  value: Service Pack 1
              - FIND:
                  checkall:
                    STARTS WITH:
                      field: Vm.filesystems-file_version
                      value: 5.2.3790.3229
                  search:
                    =:
                      field: Vm.filesystems-name
                      value: c:/windows/system32/netapi32.dll
            - and:
              - =:
                  field: Vm.operating_system-service_pack
                  value: Service Pack 2
              - FIND:
                  checkall:
                    STARTS WITH:
                      field: Vm.filesystems-file_version
                      value: 5.2.3790.4392
                  search:
                    =:
                      field: Vm.filesystems-name
                      value: c:/windows/system32/netapi32.dll
        towhat: Vm
        file_mtime: 
        guid: 8b0d83d0-3067-11de-971a-005056a12545
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            and:
            - STARTS WITH:
                field: Vm.operating_system-product_name
                value: Microsoft Windows Server 2003
            - or:
              - =:
                  field: Vm.operating_system-service_pack
                  value: Service Pack 1
              - =:
                  field: Vm.operating_system-service_pack
                  value: Service Pack 2
        miq_policy_id: 10000000000012
        notes: 
      - name: 9482beb2-3067-11de-971a-005056a12545
        description: IAVA - MS08-067 for Windows XP Service Pack 2 & 3
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkall:
                  STARTS WITH:
                    field: Vm.filesystems-file_version
                    value: 5.1.2600.3462
                search:
                  =:
                    field: Vm.filesystems-name
                    value: c:/windows/system32/netapi32.dll
            - KEY EXISTS:
                regkey: HKLM\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB958644\Filelist
        towhat: Vm
        file_mtime: 
        guid: 9482beb2-3067-11de-971a-005056a12545
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            and:
            - STARTS WITH:
                field: Vm.operating_system-product_name
                value: Microsoft Windows XP
            - or:
              - =:
                  field: Vm.operating_system-service_pack
                  value: Service Pack 2
              - =:
                  field: Vm.operating_system-service_pack
                  value: Service Pack 3
        miq_policy_id: 10000000000012
        notes: 
- MiqPolicySet:
    name: a884921a-d2e6-11de-b4f6-0050568a547d
    description: ! 'Compliance: DMZ Configuration'
    set_type: MiqPolicySet
    guid: a884921a-d2e6-11de-b4f6-0050568a547d
    read_only: 
    set_data: 
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 66fbec86-d2ef-11de-b4f6-0050568a547d
      description: ! 'Tag: VM Workload - DMZ'
      expression: 
      towhat: Vm
      guid: 66fbec86-d2ef-11de-b4f6-0050568a547d
      created_by: admin
      updated_by: admin
      notes: This policy will automatically apply a DMZ tag to a vm if it has access
        to the external vlan
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 330828a4-d2ef-11de-b4f6-0050568a547d
          description: Tag as DMZ
          guid: 330828a4-d2ef-11de-b4f6-0050568a547d
          action_type: tag
          options:
            :tags:
            - /managed/network_location/dmz
      Condition:
      - name: 8a975658-d2ef-11de-b4f6-0050568a547d
        description: VM - DMZ check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                IS NOT NULL:
                  field: Vm.lans-created_on
              search:
                INCLUDES:
                  field: Vm.lans-name
                  value: External
        towhat: Vm
        file_mtime: 
        guid: 8a975658-d2ef-11de-b4f6-0050568a547d
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000018
        notes: 
    - name: 98557866-d2ee-11de-b4f6-0050568a547d
      description: ! 'Tag: Host Workload - DMZ'
      expression: 
      towhat: Host
      guid: 98557866-d2ee-11de-b4f6-0050568a547d
      created_by: admin
      updated_by: admin
      notes: This policy will automatically apply a DMZ tag to a host if it has access
        to the external vlan
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: host_scan_complete
          description: Host Analysis Complete
          guid: ffcfb368-455d-11de-86a0-005056a81f62
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 330828a4-d2ef-11de-b4f6-0050568a547d
          description: Tag as DMZ
          guid: 330828a4-d2ef-11de-b4f6-0050568a547d
          action_type: tag
          options:
            :tags:
            - /managed/network_location/dmz
      Condition:
      - name: ed3edf84-d2ee-11de-b4f6-0050568a547d
        description: Host - DMZ vlan check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                IS NOT NULL:
                  field: Host.lans-created_on
              search:
                INCLUDES:
                  field: Host.lans-name
                  value: External
        towhat: Host
        file_mtime: 
        guid: ed3edf84-d2ee-11de-b4f6-0050568a547d
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000017
        notes: 
    - name: 39fbf6bc-d2fa-11de-b4f6-0050568a547d
      description: ! 'Configuration: VM - DMZ Fully Collapsed Windows Services'
      expression: 
      towhat: Vm
      guid: 39fbf6bc-d2fa-11de-b4f6-0050568a547d
      created_by: admin
      updated_by: admin
      notes: This policies verifies that certain services are disabled on DMZ vms
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: vm_migrate
          description: VM Live Migration (VMOTION)
          guid: 07500602-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_migrate
          description: VM Live Migration (VMOTION)
          guid: 07500602-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      Condition:
      - name: ed4daf4e-d2fa-11de-b4f6-0050568a547d
        description: dmz - windows alerter - disabled
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            =:
              regkey: HKLM\SYSTEM\CurrentControlSet\Services\Alerter
              regval: Start
              value: 4
        towhat: Vm
        file_mtime: 
        guid: ed4daf4e-d2fa-11de-b4f6-0050568a547d
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000016
        notes: 
      - name: 469a8766-d2fb-11de-b4f6-0050568a547d
        description: dmz - windows messenger - disabled
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            =:
              regkey: HKLM\SYSTEM\CurrentControlSet\Services\Messenger
              regval: Start
              value: 4
        towhat: Vm
        file_mtime: 
        guid: 469a8766-d2fb-11de-b4f6-0050568a547d
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000016
        notes: 
      - name: 7f648a84-d2fa-11de-b4f6-0050568a547d
        description: dmz - windows automatic update - disabled
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            =:
              regkey: HKLM\SYSTEM\CurrentControlSet\Services\wuauserv
              regval: Start
              value: 4
        towhat: Vm
        file_mtime: 
        guid: 7f648a84-d2fa-11de-b4f6-0050568a547d
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000016
        notes: 
    - name: 6adebf82-d2e4-11de-b4f6-0050568a547d
      description: ! 'Configuration: VM - DMZ  Fully Collapsed  Network'
      expression: 
      towhat: Vm
      guid: 6adebf82-d2e4-11de-b4f6-0050568a547d
      created_by: admin
      updated_by: admin
      notes: ! 'created by: Rod Moore

        purpose: validates vm vlan configuration'
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: vm_migrate
          description: VM Live Migration (VMOTION)
          guid: 07500602-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_migrate
          description: VM Live Migration (VMOTION)
          guid: 07500602-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      Condition:
      - name: 278843f0-d2e6-11de-b4f6-0050568a547d
        description: vm - vlan - webserver
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  IS NOT NULL:
                    field: Vm.lans-created_on
                search:
                  INCLUDES:
                    field: Vm.lans-name
                    value: External
            - CONTAINS:
                tag: Vm.managed-function
                value: web_server
        towhat: Vm
        file_mtime: 
        guid: 278843f0-d2e6-11de-b4f6-0050568a547d
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000015
        notes: 
    - name: de3af0f2-d2f0-11de-b4f6-0050568a547d
      description: ! 'Configuration: VM - Internal Network'
      expression: 
      towhat: Vm
      guid: de3af0f2-d2f0-11de-b4f6-0050568a547d
      created_by: admin
      updated_by: admin
      notes: This policy shutdown application or database vms that are incorrectly
        configured to access the dmz network
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: vm_migrate
          description: VM Live Migration (VMOTION)
          guid: 07500602-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_migrate
          description: VM Live Migration (VMOTION)
          guid: 07500602-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      Condition:
      - name: 020dd9c2-d2f1-11de-b4f6-0050568a547d
        description: vm - internal vlan check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  IS NOT NULL:
                    field: Vm.lans-created_on
                search:
                  INCLUDES:
                    field: Vm.lans-name
                    value: Internal
            - or:
              - CONTAINS:
                  tag: Vm.managed-function
                  value: application_servers
              - CONTAINS:
                  tag: Vm.managed-function
                  value: database
        towhat: Vm
        file_mtime: 
        guid: 020dd9c2-d2f1-11de-b4f6-0050568a547d
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000014
        notes: 
    - name: c66e6d58-d2fc-11de-b4f6-0050568a547d
      description: ! 'Configuration: Host - DMZ Fully Collapsed Advanced Settings'
      expression: 
      towhat: Host
      guid: c66e6d58-d2fc-11de-b4f6-0050568a547d
      created_by: admin
      updated_by: admin
      notes: This policy verifies designated host advanced settings values to ensure
        that they meet DMZ requirements
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_scan_complete
          description: Host Analysis Complete
          guid: ffcfb368-455d-11de-86a0-005056a81f62
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          description: Email - DMZ
          guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
          action_type: email
          options:
            :to: dmzalert@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      Condition:
      - name: 1ea32d10-d2fd-11de-b4f6-0050568a547d
        description: host - dmz - advanced settings - ssl
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Host.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Host.advanced_settings-name
                  value: Config.Defaults.security.host.ruissl
        towhat: Host
        file_mtime: 
        guid: 1ea32d10-d2fd-11de-b4f6-0050568a547d
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000013
        notes: 
- MiqPolicySet:
    name: 587352f0-fb88-11de-a067-005056ba0614
    description: ! 'Compliance: Hosts'
    set_type: MiqPolicySet
    guid: 587352f0-fb88-11de-a067-005056ba0614
    read_only: 
    set_data:
      :notes: This policy profile validates that an ESX host meets the standard defined
        in VMWare's security hardening documentation
    mode: pr
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: eb84f288-fa39-11de-83ca-005056ba0614
      description: Protect Root File System Filling /home
      expression: 
      towhat: Host
      guid: eb84f288-fa39-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /home directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 62447a1a-fa3a-11de-83ca-005056ba0614
        description: Protect Root File System Filling /home
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^[^#]*\/home
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/fstab
        towhat: Host
        file_mtime: 
        guid: 62447a1a-fa3a-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000019
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /home.
    - name: 04db603c-fa3a-11de-83ca-005056ba0614
      description: Firewall - Outgoing Security Level
      expression: 
      towhat: Host
      guid: 04db603c-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only a defined set of outgoing TCP and UDP
        Ports are open.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: f0afd7d6-fa3a-11de-83ca-005056ba0614
        description: Valid Outgoing TCP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              field: Host-enabled_tcp_outbound_ports
              value: '902,427,443,27000,27010'
        towhat: Host
        file_mtime: 
        guid: f0afd7d6-fa3a-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000020
        notes: This condition verifies that the only open outgoing TCP ports are 427,443,902,27000,
          and 27010.
      - name: 1778fb28-fa44-11de-83ca-005056ba0614
        description: Valid Outgoing UDP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              field: Host-enabled_udp_outbound_ports
              value: '427,123,902'
        towhat: Host
        file_mtime: 
        guid: 1778fb28-fa44-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000020
        notes: This condition verifies that the only open outgoing UDP ports are 123,427,
          and 902.
    - name: af2d74ea-fa39-11de-83ca-005056ba0614
      description: Firewall - Incoming Security Level
      expression: 
      towhat: Host
      guid: af2d74ea-fa39-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only a defined set of incoming TCP and UDP
        Ports are open.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: b4a0843a-fa43-11de-83ca-005056ba0614
        description: Valid Incoming UDP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              field: Host-enabled_udp_inbound_ports
              value: '427'
        towhat: Host
        file_mtime: 
        guid: b4a0843a-fa43-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000021
        notes: This condition verifies that the only open incoming UDP port is 427.
      - name: 03529e9e-f961-11de-9e9d-0050568a07c7
        description: Valid Incoming TCP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              field: Host-enabled_tcp_inbound_ports
              value: '902,80,443,427,5989,22,5988'
        towhat: Host
        file_mtime: 
        guid: 03529e9e-f961-11de-9e9d-0050568a07c7
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000021
        notes: This condition verifies that the only open incoming TCP ports are 22,80,427,443,902,5988,and
          5989.
    - name: 61b355f2-fee1-11de-83dd-005056ba5e76
      description: Network - Forged Transmits Must Be Disabled
      expression: 
      towhat: Host
      guid: 61b355f2-fee1-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: This policy insures that forged transmits are disabled on both vLans
        and vSwitches.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: f246e3e0-fee1-11de-83dd-005056ba5e76
        description: Forged Transmits Disabled in vLan
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                field: Host.lans-forged_transmits
                value: 'false'
        towhat: Host
        file_mtime: 
        guid: f246e3e0-fee1-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000022
        notes: This condition verifies that forged transmits are disabled on vlans.
      - name: a3ac5774-fee1-11de-83dd-005056ba5e76
        description: Forged Transmits Disabled in vSwitch
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                field: Host.switches-forged_transmits
                value: 'false'
        towhat: Host
        file_mtime: 
        guid: a3ac5774-fee1-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000022
        notes: This condition verifies that forged transmits are disabled on vSwitches.
    - name: 8d4a7bee-fa56-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers defined in step-tickers
      expression: 
      towhat: Host
      guid: 8d4a7bee-fa56-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 servers are defined in the NTP
        step-tickers configuration.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 0806448a-fa57-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in step-tickers File
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  field: Host.filesystems-contents
                  value: ! "count = 0\ncontext.each_line { |line|                              #
                    Break up the input by lines\n  count += 1 if line =~ /^[^#]*server\\s+[0-9A-Za-z]+/
                    \  # Increment Count if line matches our regular expression\n}\nreturn
                    true if count >= 3\nreturn false\n"
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/ntp/step-tickers
        towhat: Host
        file_mtime: 
        guid: 0806448a-fa57-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000023
        notes: This condition checks the file /etc/ntp/step-tickers and verifies that
          a minimum of three ntp servers are defined.
    - name: ab373d88-fa4a-11de-83ca-005056ba0614
      description: Settings - Display Logs on Different Terminals
      expression: 
      towhat: Host
      guid: ab373d88-fa4a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that critical, error, and warning level log messages
        are directed to distinct terminals.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: f383ec6c-fa4a-11de-83ca-005056ba0614
        description: Verify Different Logs Displayed on Different Terminals
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    field: Host.filesystems-contents
                    value: ^\s*\*\.crit\s+\/dev\/tty
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/syslog.conf
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    field: Host.filesystems-contents
                    value: ^\s*\*\.err\s+\/dev\/tty
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/syslog.conf
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    field: Host.filesystems-contents
                    value: ^\s*\*\.warning\s+\/dev\/tty
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/syslog.conf
        towhat: Host
        file_mtime: 
        guid: f383ec6c-fa4a-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000024
        notes: This condition checks the file /etc/syslog.conf has three seperate
          parameters defined for critical, error, and warning level log messages.
          These parameters specify the tty will display the specified log messages.
    - name: 498f5330-fa4b-11de-83ca-005056ba0614
      description: Settings -  Remote syslog Logging
      expression: 
      towhat: Host
      guid: 498f5330-fa4b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that syslog is configured to utilize a remote server.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: ee09af6e-fa4b-11de-83ca-005056ba0614
        description: Verify syslog Utilizes a Remote Host
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: /^[^#*]\s*.*@/
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/syslog.conf
        towhat: Host
        file_mtime: 
        guid: ee09af6e-fa4b-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000025
        notes: This condition checks the file /etc/syslog.conf and verifies the existence
          of the @ parameter, which is used to specify the use of a remote server.
    - name: eb0151ea-fa47-11de-83ca-005056ba0614
      description: Root Login on console should be Disabled
      expression: 
      towhat: Host
      guid: eb0151ea-fa47-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the root account cannot directly login via
        the console.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 571e6e76-fa48-11de-83ca-005056ba0614
        description: File /etc/securetty should be empty
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Host.filesystems-size
                  value: '0'
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/securetty
        towhat: Host
        file_mtime: 
        guid: 571e6e76-fa48-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000026
        notes: This condition checks the file /etc/securetty and verifies that it's
          empty by checking for a 0KB file size.
    - name: e4c93c82-fa3a-11de-83ca-005056ba0614
      description: Permissions - /etc/grub.conf
      expression: 
      towhat: Host
      guid: e4c93c82-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that editing the server's boot process requires
        root level authority.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: d2adb400-fa3b-11de-83ca-005056ba0614
        description: Permissions - /etc/grub.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  =:
                    field: Host.filesystems-permissions
                    value: '0600'
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/grub.conf
            - FIND:
                checkany:
                  =:
                    field: Host.filesystems-owner
                    value: root
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/grub.conf
        towhat: Host
        file_mtime: 
        guid: d2adb400-fa3b-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000027
        notes: This condition verifies that the file /etc/grub.conf's permissions
          are set to 0600 and is owned by root.
    - name: de683aa6-fedf-11de-83dd-005056ba5e76
      description: Network - Mac Changes not Allowed
      expression: 
      towhat: Host
      guid: de683aa6-fedf-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: This policy checks that MAC changes are not allowed on vSwitches and
        vLans.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 0a6eb332-fee0-11de-83dd-005056ba5e76
        description: Mac Changes Disabled in vSwitches
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                field: Host.switches-mac_changes
                value: 'false'
        towhat: Host
        file_mtime: 
        guid: 0a6eb332-fee0-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000028
        notes: This condition verifies that MAC changes are not allowed on vSwitches.
      - name: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
        description: Mac Changes Disabled in vLans
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                field: Host.lans-mac_changes
                value: 'false'
        towhat: Host
        file_mtime: 
        guid: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000028
        notes: This condition verifies that MAC changes are not allowed on vLans.
    - name: 7cc14778-fe0f-11de-83dd-005056ba5e76
      description: Network - Promiscuous Mode Setting Not Disabled
      expression: 
      towhat: Host
      guid: 7cc14778-fe0f-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: Check the Host VLan setting for Promiscuous Mode which should be disabled.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 2045b314-fe58-11de-83dd-005056ba5e76
        description: Check Host vSwitch - Promiscuous Mode Must Not Be Enable
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                field: Host.switches-allow_promiscuous
                value: 'true'
        towhat: Host
        file_mtime: 
        guid: 2045b314-fe58-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000029
        notes: This condition verifies that vSwitches do not allow Promiscuous mode
          via inheritance.
      - name: 80e5ff5e-fe16-11de-83dd-005056ba5e76
        description: Check Host Port - Promiscuous Mode Must Not Be Enabled
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                field: Host.lans-computed_allow_promiscuous
                value: 'true'
        towhat: Host
        file_mtime: 
        guid: 80e5ff5e-fe16-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000029
        notes: This condition verifies that vLans do not allow Promiscuous mode via
          inheritance.
    - name: a8e0ef7c-fa48-11de-83ca-005056ba0614
      description: Use sudo aliases
      expression: 
      towhat: Host
      guid: a8e0ef7c-fa48-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that user aliases are enabled in the configuration
        of the sudo command.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 99496ebc-fa49-11de-83ca-005056ba0614
        description: Aliases are being used for sudo authorization
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*User_Alias
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/sudoers
        towhat: Host
        file_mtime: 
        guid: 99496ebc-fa49-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000030
        notes: This condition checks the file /etc/sudoers and verifies that the parameter
          "User_Alias" is defined.
    - name: 4ed279b2-fa55-11de-83ca-005056ba0614
      description: Timekeeping - NTP Service Running
      expression: 
      towhat: Host
      guid: 4ed279b2-fa55-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the NTP servers is configured to automatically
        start.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 9a08d21e-fa55-11de-83ca-005056ba0614
        description: Verify NTP is Running
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                INCLUDES:
                  field: Host.host_services-enable_run_levels
                  value: '3'
              search:
                =:
                  field: Host.host_services-name
                  value: ntpd
        towhat: Host
        file_mtime: 
        guid: 9a08d21e-fa55-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000031
        notes: This condition verifies that the run level of the service ntpd is set
          to three.
    - name: a6c2a51e-fa57-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers Defined in ntp.conf
      expression: 
      towhat: Host
      guid: a6c2a51e-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 servers are defined in the NTP
        configuration.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 03c821bc-fa58-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in ntp.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  field: Host.filesystems-contents
                  value: ! "count = 0\ncontext.each_line { |line|                              #
                    Break up the input by lines\n  count += 1 if line =~ /^[^#]*server\\s+[0-9A-Za-z]+/
                    \  # Increment Count if line matches our regular expression\n}\nreturn
                    true if count >= 3\nreturn false"
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/ntp.conf
        towhat: Host
        file_mtime: 
        guid: 03c821bc-fa58-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000032
        notes: This condition checks the file /etc/ntp.conf and verifies that a minimum
          of three ntp servers are defined.
    - name: c4396f3a-fa55-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers Defined in hosts
      expression: 
      towhat: Host
      guid: c4396f3a-fa55-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 NTP servers are defined in the
        local hosts file.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 2698c39c-fa56-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in hosts File
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  field: Host.filesystems-contents
                  value: ! "count = 0\ncontext.each_line { |line|                              #
                    Break up the input by lines\n  count += 1 if line =~ /^[^#]*NTP/i
                    \  # Increment Count if line matches our regular expression\n}\nreturn
                    true if count >= 3\nreturn false\n"
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/hosts
        towhat: Host
        file_mtime: 
        guid: 2698c39c-fa56-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000033
        notes: ! 'This conditions checks the file /etc/hosts and veries that there
          are at least 3 uncommented lines that reference ntp servers. The included
          expression can be modified to match the appropriate values for the ntp servers
          for your environment.

'
    - name: 3819638c-fa57-11de-83ca-005056ba0614
      description: Timekeeping - Drift Enabled
      expression: 
      towhat: Host
      guid: 3819638c-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that NTP's driftfile support is enabled.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 71fae5da-fa57-11de-83ca-005056ba0614
        description: Verify NTP Uses a Driftfile
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*driftfile\s+\/var\/lib\/ntp\/drift
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/ntp.conf
        towhat: Host
        file_mtime: 
        guid: 71fae5da-fa57-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000034
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          driftfile parameter exists.
    - name: ebc02cea-fa57-11de-83ca-005056ba0614
      description: Time Keeping - Restrict Access for Machines without Loopback
      expression: 
      towhat: Host
      guid: ebc02cea-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only non-loopback machines can access the NTP
        service.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: ddc26260-fa58-11de-83ca-005056ba0614
        description: Access Restricted for Machines without Loopback
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*restrict\s+default\s+kod\s+nomodify\s+notrap
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/ntp.conf
        towhat: Host
        file_mtime: 
        guid: ddc26260-fa58-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000035
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          line "restrict default kod nomodify notrap" exists.
    - name: ccadf9fa-fa56-11de-83ca-005056ba0614
      description: Time Keeping - NTP Configured to Use Loopback Adapter
      expression: 
      towhat: Host
      guid: ccadf9fa-fa56-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that NTP performs all name resolutions via a loopback
        network.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 2b9bb8b2-fa57-11de-83ca-005056ba0614
        description: NTP Configured to Use Loopback Adapter
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*restrict\s+127\.0\.0\.1
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/ntp.conf
        towhat: Host
        file_mtime: 
        guid: 2b9bb8b2-fa57-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000036
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          restrict parameter's value is set to 127.0.0.1.
    - name: 4614d62e-fa52-11de-83ca-005056ba0614
      description: Settings - vmkwarning Compress Option
      expression: 
      towhat: Host
      guid: 4614d62e-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmkwarning log is compressed by default.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: a51cbaba-fa52-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmkwarning
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: \s+compress
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/logrotate.d/vmkwarning
        towhat: Host
        file_mtime: 
        guid: a51cbaba-fa52-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000037
        notes: This condition checks the file /etc/logrotate.d/vmkwarning and verifies
          that the option compress is enabled.
    - name: 6353b57e-fa53-11de-83ca-005056ba0614
      description: Settings - vmksummary Compress Option
      expression: 
      towhat: Host
      guid: 6353b57e-fa53-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmksummary log is compressed by default.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 510f7286-fa53-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmksummary
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: \s+compress
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/logrotate.d/vmksummary
        towhat: Host
        file_mtime: 
        guid: 510f7286-fa53-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000038
        notes: This condition checks the file /etc/logrotate.d/vmksummary and verifies
          that the option compress is enabled.
    - name: 0864fae6-fa54-11de-83ca-005056ba0614
      description: Settings - vmkernel Compress Option
      expression: 
      towhat: Host
      guid: 0864fae6-fa54-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmkernel log is compressed by default.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: fe7378be-fa53-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmkernel
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: \s+compress
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/logrotate.d/vmkernel
        towhat: Host
        file_mtime: 
        guid: fe7378be-fa53-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000039
        notes: This condition checks the file /etc/logrotate.d/vmkernel and verifies
          that the option compress is enabled.
    - name: 6576a074-fa48-11de-83ca-005056ba0614
      description: Settings - /etc/sudoers
      expression: 
      towhat: Host
      guid: 6576a074-fa48-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that sudo is configured to use syslog for logging.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: ade186c6-fa48-11de-83ca-005056ba0614
        description: Verify sudo is Logging via syslog
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*Defaults\s+syslog\=
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/sudoers
        towhat: Host
        file_mtime: 
        guid: ade186c6-fa48-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000040
        notes: This condition check the file /etc/sudoers and verifies that the parameter
          "Defaults syslog=" exists.
    - name: c340f524-fa3e-11de-83ca-005056ba0614
      description: Settings - /etc/grub.conf
      expression: 
      towhat: Host
      guid: c340f524-fa3e-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a password is required in order to edit the
        server's boot process.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 1f18225a-fa3f-11de-83ca-005056ba0614
        description: Verify /etc/grub.conf Settings
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*password\s\-\-md5
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/grub.conf
        towhat: Host
        file_mtime: 
        guid: 1f18225a-fa3f-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000041
        notes: This condition check the file /etc/grub.conf and verifies that the
          parameter "password --md5" exists.
    - name: c63b0560-fa45-11de-83ca-005056ba0614
      description: Root Login via SSH should be Disabled
      expression: 
      towhat: Host
      guid: c63b0560-fa45-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the root account cannot login to the host via
        SSH.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 4435b6d6-fa46-11de-83ca-005056ba0614
        description: PermitRootLogin = no in sshd_config file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*PermitRootLogin\s+no
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/ssh/sshd_config
        towhat: Host
        file_mtime: 
        guid: 4435b6d6-fa46-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000042
        notes: This condition checks the file /etc/ssh/sshd_config and verifies that
          the PermitRootLogin parameter's value is set to no.
    - name: 5ce6be9a-fa4c-11de-83ca-005056ba0614
      description: Require users to enter own password - no ROOTPW entry
      expression: 
      towhat: Host
      guid: 5ce6be9a-fa4c-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that when the sudo command is used, each user is
        prompted for their password and not the root password.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: a791b882-fa4c-11de-83ca-005056ba0614
        description: ROOTPW does not exist in sudoers file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  field: Host.filesystems-contents
                  value: /^[^#]*ROOTPW/i
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/sudoers
        towhat: Host
        file_mtime: 
        guid: a791b882-fa4c-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000043
        notes: This condition check the file /etc/sudoers and verifies that it does
          not contain the word ROOTPW on an uncommented line.
    - name: a128d356-fa36-11de-83ca-005056ba0614
      description: Protect Root File System Filling /tmp
      expression: 
      towhat: Host
      guid: a128d356-fa36-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /tmp directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 267dd9de-fa37-11de-83ca-005056ba0614
        description: Protect Root File System Filling  /tmp
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^[^#]*\/tmp
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/fstab
        towhat: Host
        file_mtime: 
        guid: 267dd9de-fa37-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000044
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /tmp.
    - name: 7ea7db8c-fa46-11de-83ca-005056ba0614
      description: Permissions - /etc/snmp/snmpd.conf
      expression: 
      towhat: Host
      guid: 7ea7db8c-fa46-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy ensures that access to SNMP configuration parameters are
        limited to the root user.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: ebb24a50-fa46-11de-83ca-005056ba0614
        description: Permissions - /etc/snmp/snmpd.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  =:
                    field: Host.filesystems-permissions
                    value: '0700'
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/snmp/snmpd.conf
            - FIND:
                checkany:
                  =:
                    field: Host.filesystems-owner
                    value: root
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/snmp/snmpd.conf
        towhat: Host
        file_mtime: 
        guid: ebb24a50-fa46-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000045
        notes: This condition verifies that the permissions of /etc/snmp/snmpd.conf
          are 0700 and is owned by root.
    - name: 40b796dc-fa50-11de-83ca-005056ba0614
      description: Password Expiration Warning Default
      expression: 
      towhat: Host
      guid: 40b796dc-fa50-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies the default setting for password expiration warning.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 0e842bde-fa51-11de-83ca-005056ba0614
        description: Password Expiration Warning Default >= 7days
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*PASS_WARN_AGE\s+([7-9]|[1-9][0-9]+)
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/login.defs
        towhat: Host
        file_mtime: 
        guid: 0e842bde-fa51-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000046
        notes: This condition checks the file /etc/login.defs and verifies that PASS_WARN_AGE
          parameter's value is set to 7 or greater.
    - name: 2f9fad14-fa4e-11de-83ca-005056ba0614
      description: Password Aging - Default Maximum
      expression: 
      towhat: Host
      guid: 2f9fad14-fa4e-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates the ESX host's maximum password age configuration.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: a4a0e740-fa4e-11de-83ca-005056ba0614
        description: Default Maximum Password Age <= 90days
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*PASS_MAX_DAYS\s+([0-9]|[1-8][0-9]|90)
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/login.defs
        towhat: Host
        file_mtime: 
        guid: a4a0e740-fa4e-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000047
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MAX_DAYS parameter's value is 90 days or greater.
    - name: 79548666-fa51-11de-83ca-005056ba0614
      description: Limit vmkwarning Size
      expression: 
      towhat: Host
      guid: 79548666-fa51-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmkwarning log is limited to a specified size.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 14d35e46-fa52-11de-83ca-005056ba0614
        description: vmkwarning Log Size <= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/logrotate.d/vmkwarning
        towhat: Host
        file_mtime: 
        guid: 14d35e46-fa52-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000048
        notes: This condition verifies that the file /etc/logrotate.d/vmkwarning is
          configured to limit the associated log to 4096KB.
    - name: c79821fa-fa53-11de-83ca-005056ba0614
      description: Limit vmkernel Size
      expression: 
      towhat: Host
      guid: c79821fa-fa53-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmkernel log is limited to a specified size.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: be9722e0-fa53-11de-83ca-005056ba0614
        description: vmkernel Log Size <= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/logrotate.d/vmkernel
        towhat: Host
        file_mtime: 
        guid: be9722e0-fa53-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000049
        notes: This condition verifies that the file /etc/logrotate.d/vmkernel is
          configured to limit the associated log to 4096KB.
    - name: 8cecc84c-fa46-11de-83ca-005056ba0614
      description: Limit su Access to root Account
      expression: 
      towhat: Host
      guid: 8cecc84c-fa46-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that only members of the group wheel can access
        the su command.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 63b243fc-fa47-11de-83ca-005056ba0614
        description: Only members of wheel group can execute su command
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*auth\s+required\s+.*pam_wheel\.so\s+use_uid
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/pam.d/su
        towhat: Host
        file_mtime: 
        guid: 63b243fc-fa47-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000050
        notes: This condition validates that the file /etc/pam.d/su contains a variation
          of the string "auth required pam_wheel.so use_uid".
    - name: 2cd1b736-fa52-11de-83ca-005056ba0614
      description: Limit Software and Services Running in Service Console
      expression: 
      towhat: Host
      guid: 2cd1b736-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that only an approved list of services are enabled
        at boot time on an ESX host.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: c4c80bfa-fa55-11de-83ca-005056ba0614
        description: Default Services Running in Service Console
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              field: Host-enabled_run_level_3_services
              value: crond, firewall, gpm, ipmi, irqbalance, mgmt-vmware, microcode_ctl,
                mptctlnode, network, ntpd, pegasus, portmap, random, rawdevices, sshd,
                syslog, vmware, vmware-autostart, vmware-late, vmware-vmkauthd, vmware-vpxa,
                vmware-webAccess, wsman, xinetd
        towhat: Host
        file_mtime: 
        guid: c4c80bfa-fa55-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000051
        notes: This conditions validates that a defined list of services are enabled
          with the ESX host is booted with networking support (run level 3). This
          list includes the generic services included in ESX. Additional hardware
          specific services can be added to the expression.
    - name: edaf1082-fa54-11de-83ca-005056ba0614
      description: Firewall - Outgoing NTP Port
      expression: 
      towhat: Host
      guid: edaf1082-fa54-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that the Firewall is configured properly for NTP
        support.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 1cb7f0ba-fa55-11de-83ca-005056ba0614
        description: Valid NTP Outgoing UDP Port
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            INCLUDES ANY:
              field: Host-enabled_udp_outbound_ports
              value: '123'
        towhat: Host
        file_mtime: 
        guid: 1cb7f0ba-fa55-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000052
        notes: This condition verifies that the outgoing UDP port required by NTP
          (port 123) is open.
    - name: 0f2cc826-fa4b-11de-83ca-005056ba0614
      description: Directory Service Used for Authentication for sudo
      expression: 
      towhat: Host
      guid: 0f2cc826-fa4b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that sudo is configured to use a directory for user
        authentication.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 684b2a60-fa4b-11de-83ca-005056ba0614
        description: Directory Service used for sudo authentication
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*auth\s+required\s+.*pam_stack\.so\s+service=system-auth
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/pam.d/sudo
        towhat: Host
        file_mtime: 
        guid: 684b2a60-fa4b-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000053
        notes: ! 'This condition verifies that the line "auth required pam_stack.so
          service=system-auth" exists in /etc/pam.d/sudo. '
    - name: 4b188948-fa45-11de-83ca-005056ba0614
      description: Settings - SNMP Read Only Access
      expression: 
      towhat: Host
      guid: 4b188948-fa45-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that SNMP is configured to only allow read-only
        access.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: e328c720-fa45-11de-83ca-005056ba0614
        description: SNMP Configured for Read-only Access
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    field: Host.filesystems-contents
                    value: ^\s*rocommunity
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/snmp/snmpd.conf
            - FIND:
                checkany:
                  REGULAR EXPRESSION DOES NOT MATCH:
                    field: Host.filesystems-contents
                    value: ^\s*rwcommunity
                search:
                  =:
                    field: Host.filesystems-name
                    value: /etc/snmp/snmpd.conf
        towhat: Host
        file_mtime: 
        guid: e328c720-fa45-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000054
        notes: This condition checks the file /etc/snmp/snmpd.conf and verfies that
          the rocommunity parameter is defined and the rwcommunity parameter is not.
    - name: 854d45aa-fa3a-11de-83ca-005056ba0614
      description: Protect Root File System Filling /var/log
      expression: 
      towhat: Host
      guid: 854d45aa-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /var/log directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: a84173e2-fa3a-11de-83ca-005056ba0614
        description: Protect Root File System Filling /var/log
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^[^#]*\/var\/log
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/fstab
        towhat: Host
        file_mtime: 
        guid: a84173e2-fa3a-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000055
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /var/log.
    - name: fc63df74-fa52-11de-83ca-005056ba0614
      description: Limit vmksummary Size
      expression: 
      towhat: Host
      guid: fc63df74-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmksummary log is limited to a specified size.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: def33840-fa52-11de-83ca-005056ba0614
        description: vmksummary Log Size <= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/logrotate.d/vmksummary
        towhat: Host
        file_mtime: 
        guid: def33840-fa52-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000056
        notes: This condition verifies that the file /etc/logrotate.d/vmksummary is
          configured to limit the associated log to 4096KB.
    - name: 305e6832-fa51-11de-83ca-005056ba0614
      description: Password Complexity - Minimum Length
      expression: 
      towhat: Host
      guid: 305e6832-fa51-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies the minimum password length.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: c0ba559e-fa51-11de-83ca-005056ba0614
        description: Minimum Password Length >= 8
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*PASS_MIN_LEN\s+([8-9]|[1-9][0-9]+)
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/login.defs
        towhat: Host
        file_mtime: 
        guid: c0ba559e-fa51-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000057
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MIN_LEN parameter's value  is 8 or greater.
    - name: e6f082ba-fa4c-11de-83ca-005056ba0614
      description: Password checking enabled for sudo
      expression: 
      towhat: Host
      guid: e6f082ba-fa4c-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that password checking is enabled for sudo.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 3d2074e2-fa4d-11de-83ca-005056ba0614
        description: NOPASSWD does not exist in sudoers file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  field: Host.filesystems-contents
                  value: /^[^#]*NOPASSWD/i
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/sudoers
        towhat: Host
        file_mtime: 
        guid: 3d2074e2-fa4d-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000058
        notes: This condition check the file /etc/sudoers and verifies that it does
          not contain the word NOPASSWORD on an uncommented line.
    - name: 32b26f2c-fa4f-11de-83ca-005056ba0614
      description: Password Aging - Default Minimum
      expression: 
      towhat: Host
      guid: 32b26f2c-fa4f-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates the ESX host's minimum password age configuration.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 79d39ad4-fa4f-11de-83ca-005056ba0614
        description: Default Minimum Password Age >= 0
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  field: Host.filesystems-contents
                  value: ^\s*PASS_MIN_DAYS\s+\d+
              search:
                =:
                  field: Host.filesystems-name
                  value: /etc/login.defs
        towhat: Host
        file_mtime: 
        guid: 79d39ad4-fa4f-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000059
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MIN_DAYS parameter's value is greater than or equal to 0 days.
- MiqPolicySet:
    name: 97c27462-1592-11df-b613-0050568a1ed6
    description: ! 'Compliance: VM'
    set_type: MiqPolicySet
    guid: 97c27462-1592-11df-b613-0050568a1ed6
    read_only: 
    set_data:
      :notes: This policy profile validates that a vm meets the standard defined in
        VMWare's security hardening documentation
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: f1af8b44-fa3b-11de-83ca-005056ba0614
      description: Limit Number of Log Files
      expression: 
      towhat: Vm
      guid: f1af8b44-fa3b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: f2ad72ac-fa3d-11de-83ca-005056ba0614
        description: Number of Log Files to Keep <= 10
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                <=:
                  field: Vm.advanced_settings-value
                  value: '10'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: log.keepOld
        towhat: Vm
        file_mtime: 
        guid: f2ad72ac-fa3d-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000060
        notes: 
    - name: 2d6bfc2c-fa3b-11de-83ca-005056ba0614
      description: Limit Log Size
      expression: 
      towhat: Vm
      guid: 2d6bfc2c-fa3b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 8b9cf076-fa3b-11de-83ca-005056ba0614
        description: Log Size Limit <= 100KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                <=:
                  field: Vm.advanced_settings-value
                  value: '100000'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: log.rotateSize
        towhat: Vm
        file_mtime: 
        guid: 8b9cf076-fa3b-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000061
        notes: 
- MiqPolicySet:
    name: 17fa069a-480b-11df-badc-005056a7121f
    description: ! 'Demo: CPU Reservation'
    set_type: MiqPolicySet
    guid: 17fa069a-480b-11df-badc-005056a7121f
    read_only: 
    set_data:
      :notes: This policy profile analyzes a vm's configuration data when it's reconfigured
        an sends an email if the cpu reservation is set to a value greater than 500.
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 467f80ce-4808-11df-badc-005056a7121f
      description: ! 'Analysis: VM Configuration Only Profile'
      expression: 
      towhat: Vm
      guid: 467f80ce-4808-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: ! 'This policy assigns an analysis profile that only gathers vm configuration
        data. Note: the specified action requires that you create an analysis profile
        that only scans vm configuration data. Once it has been created, associate
        it with the specified action'
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_start
          description: VM Analysis Start
          guid: 057b9baa-519c-11e0-8d82-005056af0000
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: b52a86f0-4807-11df-badc-005056a7121f
          description: ! 'Profile: VM configuration only'
          guid: b52a86f0-4807-11df-badc-005056a7121f
          action_type: assign_scan_profile
          options:
            :scan_item_set_name: vm configuration only
      Condition: []
    - name: 8a8f247a-480a-11df-badc-005056a7121f
      description: ! 'Configuration: VM - CPU Reservation > 500Mhz'
      expression: 
      towhat: Vm
      guid: 8a8f247a-480a-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Sends an email if CPU reservation is set to a value greater than 500Mhz
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 5189755e-480a-11df-badc-005056a7121f
          description: Alert - CPU Reservation > 500Mhz
          guid: 5189755e-480a-11df-badc-005056a7121f
          action_type: evaluate_alerts
          options:
            :alert_guids:
            - ca26a9c6-4802-11df-badc-005056a7121f
      Condition: []
    - name: 2f2a1a1c-4806-11df-badc-005056a7121f
      description: ! 'Analysis: VM Reconfiguration'
      expression: 
      towhat: Vm
      guid: 2f2a1a1c-4806-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Performs an analysis on any vm that has been reconfigured
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: 
      Condition: []
- MiqPolicySet:
    name: 3b818590-2866-11de-af2a-0050568026c2
    description: ! 'Demo: Service Level Resource Allocation'
    set_type: MiqPolicySet
    guid: 3b818590-2866-11de-af2a-0050568026c2
    read_only: 
    set_data:
      :notes: This policy demonstrates EVM's ability to check and , if necessary,
        reconfigure a VM's vCPU and Memory configuration based on designated service
        level
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: b265c970-3908-11de-b6d5-005056a11a54
      description: Service Level Platinum - RAM must be 2GB and 2 vCPUs - off
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: platinum
          - =:
              field: Vm-power_state
              value: 'off'
        context_type: 
      towhat: Vm
      guid: b265c970-3908-11de-b6d5-005056a11a54
      created_by: 
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of platinum
        has 2 vCPUs and 2GB of memory. If not it changes the vm to these values. This
        policy is used on a powered off vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_CPU_2
          description: Set VM CPU to 2
          guid: e2c3d64e-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '2'
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_RAM_2GB
          description: Set VM RAM to 2GB
          guid: cf1570b2-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 2048
      Condition:
      - name: 34218558-3909-11de-b6d5-005056a11a54
        description: Service Level Platinum - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                field: Vm.hardware-memory_cpu
                value: 2048
            - ! '!=':
                field: Vm.hardware-numvcpus
                value: 2
        towhat: Vm
        file_mtime: 
        guid: 34218558-3909-11de-b6d5-005056a11a54
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000066
        notes: 
    - name: 24b92088-399c-11de-ae27-005056a11a54
      description: Service Level Gold - RAM must be 1GB and 1 vCPU - off
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: gold
          - =:
              field: Vm-power_state
              value: 'off'
        context_type: 
      towhat: Vm
      guid: 24b92088-399c-11de-ae27-005056a11a54
      created_by: 
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of gold has
        1vCPU and 1GB of memory. If not it changes the vm to these values. This policy
        is used on a powered off vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_CPU_1
          description: Set VM CPU to 1
          guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '1'
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_RAM_1GB
          description: Set VM RAM to 1GB
          guid: 2d8445f2-9aec-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 1024
      Condition:
      - name: 1c6ec35e-3908-11de-b6d5-005056a11a54
        description: Service Level Gold - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                field: Vm.hardware-memory_cpu
                value: 1024
            - ! '!=':
                field: Vm.hardware-numvcpus
                value: 1
        towhat: Vm
        file_mtime: 
        guid: 1c6ec35e-3908-11de-b6d5-005056a11a54
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000067
        notes: 
    - name: Service Level Policy Verify Virtual Hardware - Silver Level
      description: Service Level Silver - RAM must be 512MB and 1 vCPU - off
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: silver
          - =:
              field: Vm-power_state
              value: 'off'
        context_type: 
      towhat: Vm
      guid: 3659b8bc-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of silver
        has 1 vCPU and 512MB of memory. If not it changes the vm to these values.
        This policy is used on a powered off vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_RAM_512MB
          description: Set VM RAM to 512MB
          guid: bab04cb4-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 512
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_CPU_1
          description: Set VM CPU to 1
          guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '1'
      Condition:
      - name: Service Level Validation Silver - Powered Off
        description: Service Level Silver - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                field: Vm.hardware-memory_cpu
                value: 512
            - ! '!=':
                field: Vm.hardware-numvcpus
                value: 1
        towhat: Vm
        file_mtime: 
        guid: 531575ae-9b1c-11dd-bbd7-005056ac7d2c
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000065
        notes: 
    - name: 7a91f3ac-3908-11de-b6d5-005056a11a54
      description: Service Level Gold - RAM must be 1GB and 1 vCPU - on
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: gold
          - =:
              field: Vm-power_state
              value: 'on'
        context_type: 
      towhat: Vm
      guid: 7a91f3ac-3908-11de-b6d5-005056a11a54
      created_by: 
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of gold has
        1vCPU and 1GB of memory. If not it changes the vm to these values. This policy
        is used on a powered on vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 4
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_start
          description: Start Virtual Machine
          guid: 55b5a422-3348-11de-bde2-005056a170fa
          action_type: default
          options: 
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_CPU_1
          description: Set VM CPU to 1
          guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '1'
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_RAM_1GB
          description: Set VM RAM to 1GB
          guid: 2d8445f2-9aec-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 1024
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: e452e922-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: 1c6ec35e-3908-11de-b6d5-005056a11a54
        description: Service Level Gold - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                field: Vm.hardware-memory_cpu
                value: 1024
            - ! '!=':
                field: Vm.hardware-numvcpus
                value: 1
        towhat: Vm
        file_mtime: 
        guid: 1c6ec35e-3908-11de-b6d5-005056a11a54
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000067
        notes: 
    - name: 4cb4d05c-3909-11de-b6d5-005056a11a54
      description: Service Level Platinum - RAM must be 2GB and 2 vCPUs - on
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: platinum
          - =:
              field: Vm-power_state
              value: 'on'
        context_type: 
      towhat: Vm
      guid: 4cb4d05c-3909-11de-b6d5-005056a11a54
      created_by: 
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of platinum
        has 2 vCPUs and 2GB of memory. If not it changes the vm to these values. This
        policy is used on a powered on vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 4
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_start
          description: Start Virtual Machine
          guid: 55b5a422-3348-11de-bde2-005056a170fa
          action_type: default
          options: 
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_CPU_2
          description: Set VM CPU to 2
          guid: e2c3d64e-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '2'
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_RAM_2GB
          description: Set VM RAM to 2GB
          guid: cf1570b2-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 2048
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: e452e922-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: 34218558-3909-11de-b6d5-005056a11a54
        description: Service Level Platinum - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                field: Vm.hardware-memory_cpu
                value: 2048
            - ! '!=':
                field: Vm.hardware-numvcpus
                value: 2
        towhat: Vm
        file_mtime: 
        guid: 34218558-3909-11de-b6d5-005056a11a54
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000066
        notes: 
    - name: d16643b6-3905-11de-b6d5-005056a11a54
      description: Service Level Silver - RAM must be 512MB and 1 vCPU - on
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - CONTAINS:
              tag: Vm.managed-service_level
              value: silver
          - =:
              field: Vm-power_state
              value: 'on'
        context_type: 
      towhat: Vm
      guid: d16643b6-3905-11de-b6d5-005056a11a54
      created_by: 
      updated_by: admin
      notes: This policy verifies that a vm that has a service level tag of silver
        has 1 vCPU and 512MB of memory. If not it changes the vm to these values.
        This policy is used on a powered on vm.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 4
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_start
          description: Start Virtual Machine
          guid: 55b5a422-3348-11de-bde2-005056a170fa
          action_type: default
          options: 
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_CPU_1
          description: Set VM CPU to 1
          guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_cpus
          options:
            :value: '1'
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: VM_RAM_512MB
          description: Set VM RAM to 512MB
          guid: bab04cb4-9af1-11dd-8e55-005056ac7d2c
          action_type: reconfigure_memory
          options:
            :value: 512
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: assigned_company_tag
          description: Tag Complete
          guid: e384ecb6-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: e452e922-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: Service Level Validation Silver - Powered Off
        description: Service Level Silver - VM RAM and CPU check
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - ! '!=':
                field: Vm.hardware-memory_cpu
                value: 512
            - ! '!=':
                field: Vm.hardware-numvcpus
                value: 1
        towhat: Vm
        file_mtime: 
        guid: 531575ae-9b1c-11dd-bbd7-005056ac7d2c
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000065
        notes: 
- MiqPolicySet:
    name: fc164798-3b81-11e0-9dc0-005056910001
    description: ! 'Demo: Windows Mandatory Patch'
    set_type: MiqPolicySet
    guid: fc164798-3b81-11e0-9dc0-005056910001
    read_only: 
    set_data: 
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: c5d44cb2-4734-11df-b577-005056a7121f
      description: ! 'Patch: MS10-008 Required'
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            tag: Vm.managed-environment
            value: prod
        context_type: 
      towhat: Vm
      guid: c5d44cb2-4734-11df-b577-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Prevents a VM that does not have MS10-008 installed from running in the
        virtual environment. It's scope limits it to vms tagged as production
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 3
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 722d25cc-56dc-11df-bb16-005056a7121f
          description: VM Attribute - Fails patch policy
          guid: 722d25cc-56dc-11df-bb16-005056a7121f
          action_type: set_custom_attribute
          options:
            :attribute: EVM Policy
            :value: Failed Windows Required Patch Policy
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: failure
        failure_sequence: 2
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: SendEmail
          description: SendEmail
          guid: abcf406c-02cd-11de-86d4-005056903dbc
          action_type: email
          options:
            :to: evm_demo@manageiq.com
            :from: evmadmin@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: e452e922-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: a3089008-4734-11df-b577-005056a7121f
        description: Verify KB978262 is installed
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              field: Vm.patches-name
              value: KB978262
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: a3089008-4734-11df-b577-005056a7121f
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000071
        notes: 
- MiqPolicySet:
    name: 3be240d8-2866-11de-af2a-0050568026c2
    description: ! 'Mandatory: Provisioning and Retirement'
    set_type: MiqPolicySet
    guid: 3be240d8-2866-11de-af2a-0050568026c2
    read_only: 
    set_data:
      :notes: ! 'This policy profile is REQUIRED if EVM is being used to Provision
        or Retire vms. It must be entitled to the desired management systems. Note:
        this policy profile will potentially result in the removal of a vm from the
        management system upon retirement if the associated VM Retirement statemachine
        [/Factory/StateMachine/VMRetirement] in the the Automate model is configured
        to delete vms. It is not configured for vm deletion out-of-the-box.'
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 427a4378-6519-11df-b637-005056a435be
      description: ! 'Analysis: Post Provisioning'
      expression: 
      towhat: Vm
      guid: 427a4378-6519-11df-b637-005056a435be
      created_by: admin
      updated_by: admin
      notes: This policy triggers a vm analysis of any newly provisioned VM
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_provisioned
          description: VM Provision Complete
          guid: 2a17a20a-3e8e-11df-9fe2-005056a435be
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: 
      Condition: []
    - name: Automation Policy - Scope VM Retirement Warning,  ResponseExecute Automation
        Model
      description: ! 'Operational: Retirement Warning'
      expression: 
      towhat: Vm
      guid: 39621392-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: This policy raises an automation event when a retirement warning event
        is raised
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_retire_warn
          description: VM Retirement Warning
          guid: 97c85330-fe93-11dd-b5e1-005056903dbc
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: bc3028c6-1d11-11e0-8317-005056ba6ef0
          action_type: default
          options: 
      Condition: []
    - name: Automation Policy - Scope VM Retired Response Execute Automation Model
      description: ! 'Operational: Vm Retired'
      expression: 
      towhat: Vm
      guid: 397700ae-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: This policy raises an automation event when a vm retirement event is
        raised
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_retired
          description: VM Retired
          guid: e363d8aa-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: bc3028c6-1d11-11e0-8317-005056ba6ef0
          action_type: default
          options: 
      Condition: []
- MiqPolicySet:
    name: 63aaa3aa-53fa-11e0-babf-00505688000a
    description: ! 'Operational: Prevent Cloning of Database VMs'
    set_type: MiqPolicySet
    guid: 63aaa3aa-53fa-11e0-babf-00505688000a
    read_only: 
    set_data:
      :notes: This policy profile prevents database vms from being cloned. Database
        vms are defined as those that have a workload tag value of database
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: Configuration Policy Restrict Cloning SQL Server
      description: ! 'Operational: Prevent Cloning of Database VMs'
      expression: 
      towhat: Vm
      guid: 39fdeba0-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: prevents cloning of vms with a workload tag value of database
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4468f036-0b6d-11df-bd07-005056a7121f
          description: VM Attribute - Prevent Clone of Database Server
          guid: 4468f036-0b6d-11df-bd07-005056a7121f
          action_type: set_custom_attribute
          options:
            :value: Clone Not Allowed for Database Server
            :attribute: EVM Policy
            :variables:
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: SendEmail
          description: SendEmail
          guid: abcf406c-02cd-11de-86d4-005056903dbc
          action_type: email
          options:
            :to: evm_demo@manageiq.com
            :from: evmadmin@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: cancel_task
          description: Cancel vCenter Task
          guid: e49bfee6-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: VMs running SQL Server
        description: VMs with Workload - Database
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-function
              value: db
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 121ecf62-01c6-11de-a701-005056903dbc
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000064
        notes: 
- MiqPolicySet:
    name: 6fb380a4-3b86-11e0-9dc0-005056910001
    description: ! 'Prevent Cloning of Database VMs '
    set_type: MiqPolicySet
    guid: 6fb380a4-3b86-11e0-9dc0-005056910001
    read_only: 
    set_data:
      :notes: This policy prevents any vm with a workload tag of database from being
        cloned
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: Configuration Policy Restrict Cloning SQL Server
      description: ! 'Operational: Prevent Cloning of Database VMs'
      expression: 
      towhat: Vm
      guid: 39fdeba0-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: prevents cloning of vms with a workload tag value of database
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4468f036-0b6d-11df-bd07-005056a7121f
          description: VM Attribute - Prevent Clone of Database Server
          guid: 4468f036-0b6d-11df-bd07-005056a7121f
          action_type: set_custom_attribute
          options:
            :value: Clone Not Allowed for Database Server
            :attribute: EVM Policy
            :variables:
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: SendEmail
          description: SendEmail
          guid: abcf406c-02cd-11de-86d4-005056903dbc
          action_type: email
          options:
            :to: evm_demo@manageiq.com
            :from: evmadmin@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: cancel_task
          description: Cancel vCenter Task
          guid: e49bfee6-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: VMs running SQL Server
        description: VMs with Workload - Database
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-function
              value: db
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 121ecf62-01c6-11de-a701-005056903dbc
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000064
        notes: 
- MiqPolicySet:
    name: 5a7d53b4-53f9-11e0-babf-00505688000a
    description: ! 'Snapshot Management: Delete Based On Count'
    set_type: MiqPolicySet
    guid: 5a7d53b4-53f9-11e0-babf-00505688000a
    read_only: 
    set_data:
      :notes: This policy profile deletes the most recent snapshot when more that
        2 snapshots exists
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 994efe7e-18e6-11e0-88b4-005056a7184a
      description: ! 'Snapshots: Delete based on Count'
      expression: 
      towhat: Vm
      guid: 994efe7e-18e6-11e0-88b4-005056a7184a
      created_by: admin
      updated_by: admin
      notes: This policy deletes the most recent snapshot when more that 2 snapshots
        exists
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_snapshot_complete
          description: VM Snapshot Create Complete
          guid: 7eb82802-135e-11e0-8706-005056a7184a
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: delete_most_recent_snapshot
          description: Delete Most Recent Snapshot
          guid: 7f6e2f8a-135e-11e0-8706-005056a7184a
          action_type: default
          options: 
      Condition:
      - name: 992035fc-18e7-11e0-88b4-005056a7184a
        description: Check for more than 2 snapshots
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '>':
              field: Vm-v_total_snapshots
              value: '2'
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 992035fc-18e7-11e0-88b4-005056a7184a
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000075
        notes: Checks to see if more than 2 snapshots exist
- MiqPolicySet:
    name: 3a78daca-99da-11e1-a4bf-005056b057a8
    description: ! 'Snapshot Management: Max of 2'
    set_type: MiqPolicySet
    guid: 3a78daca-99da-11e1-a4bf-005056b057a8
    read_only: 
    set_data: 
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: cf87e7fc-99d8-11e1-a4bf-005056b057a8
      description: ! 'Snapshots: limit to max of 2'
      expression: 
      towhat: Vm
      guid: cf87e7fc-99d8-11e1-a4bf-005056b057a8
      created_by: admin
      updated_by: admin
      notes: This policy prevents a vm from starting if there are more than 2 snapshots.
        If this number is exceeded, the vm is not allowed to start and the vm annotations
        are updated in the VC
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 8d6ebd90-99d9-11e1-a4bf-005056b057a8
          description: ! 'VM Attribute: Max Snapshots'
          guid: 8d6ebd90-99d9-11e1-a4bf-005056b057a8
          action_type: set_custom_attribute
          options:
            :attribute: EVM Policy
            :value: Snapshot Limit Exceeded
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: e452e922-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: 9db4783a-99d8-11e1-a4bf-005056b057a8
        description: Snapshot Count >=3
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '>=':
              value: '3'
              count: Vm.snapshots
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 9db4783a-99d8-11e1-a4bf-005056b057a8
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000079
        notes: This condition checks to see if 3 or more snapshots exist
- MiqPolicySet:
    name: 05b51354-53fd-11e0-babf-00505688000a
    description: Standards
    set_type: MiqPolicySet
    guid: 05b51354-53fd-11e0-babf-00505688000a
    read_only: 
    set_data:
      :notes: This policy profile is an example of creation of a single profile that
        contains all policies that should be enforced on all objects in the environment.
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: Configuration Policy Restrict Cloning SQL Server
      description: ! 'Operational: Prevent Cloning of Database VMs'
      expression: 
      towhat: Vm
      guid: 39fdeba0-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: prevents cloning of vms with a workload tag value of database
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 4468f036-0b6d-11df-bd07-005056a7121f
          description: VM Attribute - Prevent Clone of Database Server
          guid: 4468f036-0b6d-11df-bd07-005056a7121f
          action_type: set_custom_attribute
          options:
            :value: Clone Not Allowed for Database Server
            :attribute: EVM Policy
            :variables:
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
            - :oid: ''
              :var_type: <None>
              :value: ''
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: SendEmail
          description: SendEmail
          guid: abcf406c-02cd-11de-86d4-005056903dbc
          action_type: email
          options:
            :to: evm_demo@manageiq.com
            :from: evmadmin@manageiq.com
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_clone_start
          description: VM Clone Start
          guid: e30f6720-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: cancel_task
          description: Cancel vCenter Task
          guid: e49bfee6-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: VMs running SQL Server
        description: VMs with Workload - Database
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-function
              value: db
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 121ecf62-01c6-11de-a701-005056903dbc
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000064
        notes: 
    - name: 994efe7e-18e6-11e0-88b4-005056a7184a
      description: ! 'Snapshots: Delete based on Count'
      expression: 
      towhat: Vm
      guid: 994efe7e-18e6-11e0-88b4-005056a7184a
      created_by: admin
      updated_by: admin
      notes: This policy deletes the most recent snapshot when more that 2 snapshots
        exists
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_snapshot_complete
          description: VM Snapshot Create Complete
          guid: 7eb82802-135e-11e0-8706-005056a7184a
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: delete_most_recent_snapshot
          description: Delete Most Recent Snapshot
          guid: 7f6e2f8a-135e-11e0-8706-005056a7184a
          action_type: default
          options: 
      Condition:
      - name: 992035fc-18e7-11e0-88b4-005056a7184a
        description: Check for more than 2 snapshots
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '>':
              field: Vm-v_total_snapshots
              value: '2'
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 992035fc-18e7-11e0-88b4-005056a7184a
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000075
        notes: Checks to see if more than 2 snapshots exist
    - name: Automation Policy - Scope VM Retirement Warning,  ResponseExecute Automation
        Model
      description: ! 'Operational: Retirement Warning'
      expression: 
      towhat: Vm
      guid: 39621392-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: This policy raises an automation event when a retirement warning event
        is raised
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_retire_warn
          description: VM Retirement Warning
          guid: 97c85330-fe93-11dd-b5e1-005056903dbc
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: bc3028c6-1d11-11e0-8317-005056ba6ef0
          action_type: default
          options: 
      Condition: []
    - name: Automation Policy - Scope VM Retired Response Execute Automation Model
      description: ! 'Operational: Vm Retired'
      expression: 
      towhat: Vm
      guid: 397700ae-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: This policy raises an automation event when a vm retirement event is
        raised
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: vm_retired
          description: VM Retired
          guid: e363d8aa-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: raise_automation_event
          description: Raise Automation Event
          guid: bc3028c6-1d11-11e0-8317-005056ba6ef0
          action_type: default
          options: 
      Condition: []
    - name: 427a4378-6519-11df-b637-005056a435be
      description: ! 'Analysis: Post Provisioning'
      expression: 
      towhat: Vm
      guid: 427a4378-6519-11df-b637-005056a435be
      created_by: admin
      updated_by: admin
      notes: This policy triggers a vm analysis of any newly provisioned VM
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_provisioned
          description: VM Provision Complete
          guid: 2a17a20a-3e8e-11df-9fe2-005056a435be
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: 
      Condition: []
    - name: 0c2517d8-1ea2-11e0-8e71-005056910000
      description: ! 'Tag: VM Inherit Cluster Location Tag'
      expression: 
      towhat: Vm
      guid: 0c2517d8-1ea2-11e0-8e71-005056910000
      created_by: admin
      updated_by: admin
      notes: This policy allows a vm to inherit the location tag of it's parent cluster
        on creation or completion of analysis
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 60e5d690-1ea2-11e0-8e71-005056910000
          description: ! 'Tag: Inherit Cluster Location Tag'
          guid: 60e5d690-1ea2-11e0-8e71-005056910000
          action_type: inherit_parent_tags
          options:
            :cats:
            - location
            :parent_type: ems_cluster
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: 60e5d690-1ea2-11e0-8e71-005056910000
          description: ! 'Tag: Inherit Cluster Location Tag'
          guid: 60e5d690-1ea2-11e0-8e71-005056910000
          action_type: inherit_parent_tags
          options:
            :cats:
            - location
            :parent_type: ems_cluster
      Condition: []
    - name: ! 'Do Not Analyze '
      description: ! 'Analysis: Prevent Analysis of Selected VMs'
      expression: 
      towhat: Vm
      guid: 3a7959c0-2866-11de-af2a-0050568026c2
      created_by: 
      updated_by: admin
      notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not
        Analyze '
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        failure_synchronous: true
        MiqEvent:
          name: request_vm_scan
          description: VM Analysis Request
          guid: e3292c46-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: prevent
          description: Prevent current event from proceeding
          guid: d885a118-519b-11e0-8d82-005056af0000
          action_type: default
          options: 
      Condition:
      - name: Do Not Analyze
        description: VM classified as DO_NOT_ANALYZE
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            CONTAINS:
              tag: Vm.managed-exclusions
              value: do_not_analyze
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 39ff4444-08e2-11de-829f-005056a164b2
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000001
        notes: 
    - name: b968f0a0-3d2e-11df-a7e9-005056a40709
      description: ! 'Tag: VM that Requires Analysis'
      expression: 
      towhat: Vm
      guid: b968f0a0-3d2e-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reset
          description: VM Reset
          guid: 4c1b8a3a-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: a4ccd026-3d2e-11df-a7e9-005056a40709
          description: Tag VM that Requires Analysis
          guid: a4ccd026-3d2e-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_required
      Condition: []
    - name: 2f2a1a1c-4806-11df-badc-005056a7121f
      description: ! 'Analysis: VM Reconfiguration'
      expression: 
      towhat: Vm
      guid: 2f2a1a1c-4806-11df-badc-005056a7121f
      created_by: admin
      updated_by: admin
      notes: Performs an analysis on any vm that has been reconfigured
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_reconfigure
          description: VM Settings Change
          guid: 07367e62-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: 
      Condition: []
    - name: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      description: ! 'Tag: VM on Successful Analysis'
      expression: 
      towhat: Vm
      guid: 0ce6cf38-3d2d-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: cd2f3222-3d2c-11df-a7e9-005056a40709
          description: Tag VM after Successful Analysis
          guid: cd2f3222-3d2c-11df-a7e9-005056a40709
          action_type: tag
          options:
            :tags:
            - /managed/operations/analysis_success
      Condition: []
    - name: 07cea762-3d1b-11df-a7e9-005056a40709
      description: ! 'Tag: VM if Analysis not successful'
      expression: 
      towhat: Vm
      guid: 07cea762-3d1b-11df-a7e9-005056a40709
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_abort
          description: VM Analysis Failure
          guid: 4c48a6fa-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: fc7f2dde-3d22-11df-a7e9-005056a40709
          description: Tag VM that Fails Analysis
          guid: fc7f2dde-3d22-11df-a7e9-005056a40709
          action_type: tag
          options:
            :variables:
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            - :oid: ''
              :value: ''
              :var_type: <None>
            :tags:
            - /managed/operations/analysis_failed
      Condition: []
    - name: 782068f8-44ee-11e0-99a6-00505688000a
      description: ! 'Analysis: VDI Login'
      expression: 
      towhat: Vm
      guid: 782068f8-44ee-11e0-99a6-00505688000a
      created_by: admin
      updated_by: admin
      notes: This policy triggers an analysis of a VDI session when a user logs in
        to that session
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_vdi_login_session
          description: VDI Login Session
          guid: 15fc3cce-448a-11e0-9ad1-00505688000a
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_analyze
          description: Initiate SmartState Analysis for VM
          guid: 5cbe1082-ce35-11de-a117-005056b0503e
          action_type: default
          options: 
      Condition: []
- MiqPolicySet:
    name: fbc1c9bc-53f9-11e0-babf-00505688000a
    description: ! 'Tag Management: Inheritance Policy'
    set_type: MiqPolicySet
    guid: fbc1c9bc-53f9-11e0-babf-00505688000a
    read_only: 
    set_data:
      :notes: This policy profile contains policies that enforce Host and VM inheritence
        of parent cluster tags.
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: d9125b42-eb8a-11e0-98ad-005056be005b
      description: ! 'Tag: Host Inherit Selected Cluster Tags'
      expression: 
      towhat: Host
      guid: d9125b42-eb8a-11e0-98ad-005056be005b
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: host_connect
          description: Host Connect
          guid: 971e7436-e474-11e0-833e-005056be001b
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: b4c14218-eb89-11e0-98ad-005056be005b
          description: ! 'Tag: Inherit Selected Cluster Tags'
          guid: b4c14218-eb89-11e0-98ad-005056be005b
          action_type: inherit_parent_tags
          options:
            :cats:
            - environment
            - datacenter
            :parent_type: ems_cluster
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: host_scan_complete
          description: Host Analysis Complete
          guid: ffcfb368-455d-11de-86a0-005056a81f62
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: b4c14218-eb89-11e0-98ad-005056be005b
          description: ! 'Tag: Inherit Selected Cluster Tags'
          guid: b4c14218-eb89-11e0-98ad-005056be005b
          action_type: inherit_parent_tags
          options:
            :cats:
            - environment
            - datacenter
            :parent_type: ems_cluster
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: host_add_to_cluster
          description: Host Added to Cluster
          guid: 972ca5e2-e474-11e0-833e-005056be001b
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: b4c14218-eb89-11e0-98ad-005056be005b
          description: ! 'Tag: Inherit Selected Cluster Tags'
          guid: b4c14218-eb89-11e0-98ad-005056be005b
          action_type: inherit_parent_tags
          options:
            :cats:
            - environment
            - datacenter
            :parent_type: ems_cluster
      Condition: []
    - name: 56cae600-4b34-11e0-add8-00505688000a
      description: ! 'Tag: VM Inherit Selected Cluster Tags'
      expression: 
      towhat: Vm
      guid: 56cae600-4b34-11e0-add8-00505688000a
      created_by: admin
      updated_by: admin
      notes: This policy allows a vm to inherit selected tags of it's parent cluster
        on creation or completion of analysis. You should edit the associated action
        to specify the tag categories that should be inherited.
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: b4c14218-eb89-11e0-98ad-005056be005b
          description: ! 'Tag: Inherit Selected Cluster Tags'
          guid: b4c14218-eb89-11e0-98ad-005056be005b
          action_type: inherit_parent_tags
          options:
            :cats:
            - environment
            - datacenter
            :parent_type: ems_cluster
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_create
          description: VM Create Complete
          guid: 4c0b4f12-37c0-11df-b567-005056a40709
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: b4c14218-eb89-11e0-98ad-005056be005b
          description: ! 'Tag: Inherit Selected Cluster Tags'
          guid: b4c14218-eb89-11e0-98ad-005056be005b
          action_type: inherit_parent_tags
          options:
            :cats:
            - environment
            - datacenter
            :parent_type: ems_cluster
      Condition: []
- MiqPolicySet:
    name: 50b849f0-baec-11e1-9c90-005056b057a8
    description: VM vShield Configuration Compliance Validation
    set_type: MiqPolicySet
    guid: 50b849f0-baec-11e1-9c90-005056b057a8
    read_only: 
    set_data: 
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 207262d0-baec-11e1-9c90-005056b057a8
      description: vShield - VM configuration not compliant to support vShield
      expression: 
      towhat: Vm
      guid: 207262d0-baec-11e1-9c90-005056b057a8
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 23c99580-baeb-11e1-9c90-005056b057a8
        description: vShield - System Driver vmci set to Boot Start
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Vm.kernel_drivers-start
                  value: Boot Start
              search:
                =:
                  field: Vm.kernel_drivers-name
                  value: vmci
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 23c99580-baeb-11e1-9c90-005056b057a8
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000081
        notes: 
      - name: f114ece8-baea-11e1-9c90-005056b057a8
        description: vShield - System Driver vsdpflt set to Boot Start
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Vm.filesystem_drivers-start
                  value: Boot Start
              search:
                =:
                  field: Vm.filesystem_drivers-name
                  value: vsepflt
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: f114ece8-baea-11e1-9c90-005056b057a8
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000081
        notes: 
      - name: 88621d00-baeb-11e1-9c90-005056b057a8
        description: vShield - VMCI unrestricted on VM
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                INCLUDES:
                  field: Vm.advanced_settings-name
                  value: vmci0.unrestricted
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 88621d00-baeb-11e1-9c90-005056b057a8
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000081
        notes: 
- MiqPolicySet:
    name: 98eea278-8b9f-11e0-b8fc-005056a40e59
    description: VMs in DMZ NIC Check
    set_type: MiqPolicySet
    guid: 98eea278-8b9f-11e0-b8fc-005056a40e59
    read_only: 
    set_data:
      :notes: This Policy Profile will check VM Network Adapter count and if > 1 will
        Stop the VM. This will happen after VM Analysis is Complete or when the VM
        is Powered On.
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 0de66508-8b9f-11e0-b8fc-005056a40e59
      description: DMZ - Shutdown VM after Starting if it has more than 1 NIC
      expression: 
      towhat: Vm
      guid: 0de66508-8b9f-11e0-b8fc-005056a40e59
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 3
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: d91bbabc-b0be-11e1-b0dc-005056b057a8
          description: ! 'VM Attribute: Allowed NIC Count Exceeded'
          guid: d91bbabc-b0be-11e1-b0dc-005056b057a8
          action_type: set_custom_attribute
          options:
            :value: Allowed NIC Limit Exceeded
            :attribute: EVM Policy
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: evm_event
          description: Show EVM Event on Timeline
          guid: 16b1810c-44e8-11e0-acda-005056a40e59
          action_type: default
          options: 
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_start
          description: VM Power On
          guid: e27b2a1a-1e1e-11de-8918-0050568005db
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_stop
          description: Stop Virtual Machine
          guid: e452e922-1e1e-11de-8918-0050568005db
          action_type: default
          options: 
      Condition:
      - name: efcf3702-8b9e-11e0-b8fc-005056a40e59
        description: DMZ - VM has more than 1 NIC
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '>':
              value: '1'
              count: Vm.hardware.nics
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: efcf3702-8b9e-11e0-b8fc-005056a40e59
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000077
        notes: 
    - name: 69fbd202-8ba3-11e0-b8fc-005056a40e59
      description: DMZ - Shutdown VM after Analysis if it has more than 1 NIC
      expression: !ruby/object:MiqExpression
        exp:
          =:
            field: Vm-power_state
            value: 'on'
        context_type: 
      towhat: Vm
      guid: 69fbd202-8ba3-11e0-b8fc-005056a40e59
      created_by: admin
      updated_by: admin
      notes: 
      active: true
      mode: control
      MiqPolicyContent:
      - qualifier: success
        success_sequence: 2
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: evm_event
          description: Show EVM Event on Timeline
          guid: 16b1810c-44e8-11e0-acda-005056a40e59
          action_type: default
          options: 
      - qualifier: success
        success_sequence: 1
        MiqEvent:
          name: vm_scan_complete
          description: VM Analysis Complete
          guid: 077c3074-449a-11de-bd4f-005056a83e5d
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: vm_shutdown_guest
          description: Shutdown Virtual Machine Guest OS
          guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
          action_type: default
          options: 
      Condition:
      - name: efcf3702-8b9e-11e0-b8fc-005056a40e59
        description: DMZ - VM has more than 1 NIC
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            ! '>':
              value: '1'
              count: Vm.hardware.nics
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: efcf3702-8b9e-11e0-b8fc-005056a40e59
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000077
        notes: 
- MiqPolicySet:
    name: 9284188c-d400-11e1-9935-000c2999f7f1
    description: VMware Security Hardening Guide v4.x & v5.x (DMZ)
    set_type: MiqPolicySet
    guid: 9284188c-d400-11e1-9935-000c2999f7f1
    read_only: 
    set_data:
      :notes: VMware Security Hardening Guide v4.x & v5.x (DMZ)
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 17fce8ee-c39f-11e1-aed6-000c29cc1a4c
      description: VMware SHG - VMX24 - Disable certain unexposed features.
      expression: 
      towhat: Vm
      guid: 17fce8ee-c39f-11e1-aed6-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMware SHG - VMX24 - Disable certain unexposed features.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 98427d34-c39f-11e1-aed6-000c29cc1a4c
        description: Disable certain unexposed features
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.unity.push.update.disable
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.ghi.launchmenu.change
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.memSchedFakeSampleStats.disable
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.getCreds.disable
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 98427d34-c39f-11e1-aed6-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 82
        notes: 
    - name: cee396f8-c1f0-11e1-ae68-000c29cc1a4c
      description: VMware SHG v4.x & v5.x - VMX02 - Prevent other users from spying
        on administrator remote consoles.
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: VMware
            field: Vm-vendor
        context_type: 
      towhat: Vm
      guid: cee396f8-c1f0-11e1-ae68-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4.x & v5.x - VMX02 - Prevent other users from spying on administrator
        remote consoles.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 71089c6c-c1f1-11e1-ae68-000c29cc1a4c
        description: VMware SHG v4.x & v5.x - VMX02 - Prevent other users from spying
          on administrator remote consoles.
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                =:
                  value: '1'
                  field: Vm.advanced_settings-value
              search:
                =:
                  value: RemoteDisplay.maxConnections
                  field: Vm.advanced_settings-name
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 71089c6c-c1f1-11e1-ae68-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 83
        notes: VMware SHG v4.x & v5.x - VMX02 - Prevent other users from spying on
          administrator remote consoles. R1
    - name: 774404fc-c1c1-11e1-ae68-000c29cc1a4c
      description: VMWare SHG v4.x & v5.x - VMX22 - Avoid using independent nonpersistent
        disks.
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: VMware
            field: Vm-vendor
        context_type: 
      towhat: Vm
      guid: 774404fc-c1c1-11e1-ae68-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMWare SHG v4.x & v5.x - VMX22 - Avoid using independent nonpersistent
        disks.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: b6c3548e-c1c1-11e1-ae68-000c29cc1a4c
        description: VMWare SHG v4.x & v5.x - VMX22 - Avoid using independent nonpersistent
          disks.
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkcount:
                =:
                  value: '0'
                  field: <count>
              search:
                INCLUDES:
                  value: independent_nonpersistent
                  field: Vm.hardware.disks-mode
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: b6c3548e-c1c1-11e1-ae68-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 84
        notes: VMWare SHG v4.x & v5.x - VMX22 - Avoid using independent nonpersistent
          disks. R1
    - name: 5e3a568e-cfe3-11e1-986c-000c29cc1a4c
      description: VMWare SHG v4.x & v5.x - VSH05 - Install VMware vCenter Server
        using a service account
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            field: Vm.win32_services-name
            value: vpxd
        context_type: 
      towhat: Vm
      guid: 5e3a568e-cfe3-11e1-986c-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMWare SHG v4.x & v5.x - VSH05 - Install VMware vCenter Server using
        a service account R1
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 9e841928-cfe8-11e1-986c-000c29cc1a4c
        description: VMWare SHG v4.x & v5.x - VSH05 - Install VMware vCenter Server
          using a service account
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  field: Vm.win32_services-object_name
                  value: \bLocalSystem
              search:
                =:
                  field: Vm.win32_services-name
                  value: vpxd
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 9e841928-cfe8-11e1-986c-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 85
        notes: VMWare SHG v4.x & v5.x - VSH05 - Install VMware vCenter Server using
          a service account R1
- MiqPolicySet:
    name: ba92efe6-c1c3-11e1-ae68-000c29cc1a4c
    description: VMware Security Hardening Guide v4.x & v5.x (Enterprise)
    set_type: MiqPolicySet
    guid: ba92efe6-c1c3-11e1-ae68-000c29cc1a4c
    read_only: 
    set_data:
      :notes: VMware Security Hardening Guide v4.x & v5.x (Enterprise)
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: 2cd19756-c1ec-11e1-ae68-000c29cc1a4c
      description: VMWare SHG v4.x & v5.x - VMX01 - Prevent virtual disk shrinking.
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: VMware
            field: Vm-vendor
        context_type: 
      towhat: Vm
      guid: 2cd19756-c1ec-11e1-ae68-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMWare SHG v4.x & v5.x - VMX01 - Prevent virtual disk shrinking. R1
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 11564bce-c1ed-11e1-ae68-000c29cc1a4c
        description: VMWare SHG v4.x - VMX01 - Prevent virtual disk shrinking
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.diskShrink.disable
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.diskWiper.disable
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 11564bce-c1ed-11e1-ae68-000c29cc1a4c
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              value: '4'
              field: Vm.host-vmm_version
          context_type: 
        miq_policy_id: 94
        notes: VMWare SHG v4.x - VMX01 - Prevent virtual disk shrinking R1
      - name: d4bd19f4-d7d6-11e1-b3e5-000c2999f7f1
        description: VMWare SHG v5.x - VMX01 - Prevent virtual disk shrinking
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.diskWiper.disable
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: d4bd19f4-d7d6-11e1-b3e5-000c2999f7f1
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              field: Vm.host-vmm_version
              value: '5'
          context_type: 
        miq_policy_id: 94
        notes: VMWare SHG v5.x - VMX01 - Prevent virtual disk shrinking R1
    - name: 1d60a788-c1f3-11e1-ae68-000c29cc1a4c
      description: VMware SHG v4.x & v5.x - VMX11 Prevent unauthorized removal, connection
        and modification of devices
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - =:
              field: Vm-vendor
              value: VMware
          - STARTS WITH:
              value: '5'
              field: Vm.host-vmm_version
        context_type: 
      towhat: Vm
      guid: 1d60a788-c1f3-11e1-ae68-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4.x & v5.x - VMX11 Prevent unauthorized removal, connection
        and modification of devices
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 728e7050-c1f3-11e1-ae68-000c29cc1a4c
        description: VMware SHG v5.x - VMX11 Prevent unauthorized removal, connection
          and modification of devices
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                =:
                  value: 'true'
                  field: Vm.advanced_settings-value
              search:
                =:
                  value: isolation.device.connectable.disable
                  field: Vm.advanced_settings-name
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 728e7050-c1f3-11e1-ae68-000c29cc1a4c
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              field: Vm.host-vmm_version
              value: '5'
          context_type: 
        miq_policy_id: 93
        notes: VMware SHG v5.x - VMX11 Prevent unauthorized removal, connection and
          modification of devices R1
      - name: aaa64a08-d7d8-11e1-b3e5-000c2999f7f1
        description: VMware SHG v4.x - VMX11 Prevent unauthorized removal, connection
          and modification of devices
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  =:
                    value: 'true'
                    field: Vm.advanced_settings-value
                search:
                  =:
                    value: isolation.device.connectable.disable
                    field: Vm.advanced_settings-name
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.device.edit.disable
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: aaa64a08-d7d8-11e1-b3e5-000c2999f7f1
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              value: '4'
              field: Vm.host-vmm_version
          context_type: 
        miq_policy_id: 93
        notes: VMware SHG v4.x - VMX11 Prevent unauthorized removal, connection and
          modification of devices R1
    - name: 86c84f3a-d005-11e1-986c-000c29cc1a4c
      description: VMware SHG v4.x & v5.x - NCN10 - Ensure that port groups are configured
        with a clear network label
      expression: !ruby/object:MiqExpression
        exp:
          =:
            field: Host-vmm_product
            value: ESXi
        context_type: 
      towhat: Host
      guid: 86c84f3a-d005-11e1-986c-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4.x & v5.x - NCN10 - Ensure that port groups are configured
        with a clear network label R1
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: e1c666a0-d006-11e1-986c-000c29cc1a4c
        description: VMware SHG v4.x & v5.x - NCN10 - Ensure that port groups are
          configured with a clear network label
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - FIND:
                checkcount:
                  =:
                    field: <count>
                    value: '0'
                search:
                  IS NULL:
                    field: Host.lans-name
                    value: ''
            - FIND:
                checkcount:
                  =:
                    value: '0'
                    field: <count>
                search:
                  IS EMPTY:
                    value: ''
                    field: Host.lans-name
          context_type: 
        towhat: Host
        file_mtime: 
        guid: e1c666a0-d006-11e1-986c-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 92
        notes: VMware SHG v4.x & v5.x - NCN10 - Ensure that port groups are configured
          with a clear network label R1
    - name: e99a4c3e-d00b-11e1-986c-000c29cc1a4c
      description: VMware SHG v4x. & v5.x - NCN11 - Ensure that all vSwitches have
        a clear network label.
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: ESXi
            field: Host-vmm_product
        context_type: 
      towhat: Host
      guid: e99a4c3e-d00b-11e1-986c-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4x. & v5.x - NCN11 - Ensure that all vSwitches have a clear
        network label. R1
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 5ca4abca-d00c-11e1-986c-000c29cc1a4c
        description: VMware SHG v4x. & v5.x - NCN11 - Ensure that all vSwitches have
          a clear network label.
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            or:
            - FIND:
                checkall:
                  IS NOT NULL:
                    value: ''
                    field: Host.hardware.ports-device_name
                search:
                  =:
                    value: ethernet
                    field: Host.hardware.ports-device_type
            - FIND:
                checkall:
                  IS NOT EMPTY:
                    field: Host.hardware.ports-device_name
                    value: ''
                search:
                  =:
                    field: Host.hardware.ports-device_type
                    value: ethernet
          context_type: 
        towhat: Host
        file_mtime: 
        guid: 5ca4abca-d00c-11e1-986c-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 91
        notes: VMware SHG v4x. & v5.x - NCN11 - Ensure that all vSwitches have a clear
          network label. R1
    - name: d7ed01f4-d00e-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x & v5.x - NCN05 -Ensure that the \x80\x9CPromiscuous
        Mode\x80\x9D policy is set to \x80\x9Creject.\x80\x9D"
      expression: !ruby/object:MiqExpression
        exp:
          =:
            field: Host-vmm_product
            value: ESXi
        context_type: 
      towhat: Host
      guid: d7ed01f4-d00e-11e1-986c-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: ! "VMware SHG v4.x & v5.x - NCN05 -Ensure that the \x80\x9CPromiscuous
        Mode\x80\x9D policy is set to \x80\x9Creject.\x80\x9D R1"
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: abb1772c-d00f-11e1-986c-000c29cc1a4c
        description: ! "VMware SHG v4.x & v5.x - NCN05 -Ensure that the \x80\x9CPromiscuous
          Mode\x80\x9D policy is set to \x80\x9Creject.\x80\x9D"
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Host.lans-computed_allow_promiscuous
                  value: 'false'
              search:
                IS NOT NULL:
                  field: Host.lans-name
          context_type: 
        towhat: Host
        file_mtime: 
        guid: abb1772c-d00f-11e1-986c-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 90
        notes: ! "VMware SHG v4.x & v5.x - NCN05 -Ensure that the \x80\x9CPromiscuous
          Mode\x80\x9D policy is set to \x80\x9Creject.\x80\x9D R1"
    - name: e4d7e0e6-d00e-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x & v5.x - NCN04 - Ensure that the \x80\x9CForged
        Transmits\x80\x9D policy is set to \x80\x9Creject.\x80\x9D"
      expression: !ruby/object:MiqExpression
        exp:
          =:
            field: Host-vmm_product
            value: ESXi
        context_type: 
      towhat: Host
      guid: e4d7e0e6-d00e-11e1-986c-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: ! "VMware SHG v4.x & v5.x - NCN04 - Ensure that the \x80\x9CForged Transmits\x80\x9D
        policy is set to \x80\x9Creject.\x80\x9D R1"
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: ed54d6d8-d00f-11e1-986c-000c29cc1a4c
        description: ! "VMware SHG v4.x & v5.x - NCN04 - Ensure that the \x80\x9CForged
          Transmits\x80\x9D policy is set to \x80\x9Creject.\x80\x9D"
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Host.lans-computed_forged_transmits
                  value: 'false'
              search:
                IS NOT NULL:
                  field: Host.lans-name
          context_type: 
        towhat: Host
        file_mtime: 
        guid: ed54d6d8-d00f-11e1-986c-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 89
        notes: ! "VMware SHG v4.x & v5.x - NCN04 - Ensure that the \x80\x9CForged
          Transmits\x80\x9D policy is set to \x80\x9Creject.\x80\x9D R1"
    - name: 197d032e-d016-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x & v5.x - NCN03 - Ensure that the \x80\x9CMAC
        Address Change\x80\x9D policy is set to \x80\x9Creject.\x80\x9D"
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: ESXi
            field: Host-vmm_product
        context_type: 
      towhat: Host
      guid: 197d032e-d016-11e1-986c-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: ! "VMware SHG v4.x & v5.x - NCN03 - Ensure that the \x80\x9CMAC Address
        Change\x80\x9D policy is set to \x80\x9Creject.\x80\x9D R1"
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 3531486e-d016-11e1-986c-000c29cc1a4c
        description: ! "VMware SHG v4.x & v5.x - NCN03 - Ensure that the \x80\x9CMAC
          Address Change\x80\x9D policy is set to \x80\x9Creject.\x80\x9D"
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Host.lans-computed_mac_changes
                  value: 'false'
              search:
                IS NOT NULL:
                  field: Host.lans-name
          context_type: 
        towhat: Host
        file_mtime: 
        guid: 3531486e-d016-11e1-986c-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 88
        notes: ! "VMware SHG v4.x & v5.x - NCN03 - Ensure that the \x80\x9CMAC Address
          Change\x80\x9D policy is set to \x80\x9Creject.\x80\x9D R1"
    - name: 4dadd9bc-d443-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x & v5.x - HLG01 - Remote syslog should be configured
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: ESXi
            field: Host-vmm_product
        context_type: 
      towhat: Host
      guid: 4dadd9bc-d443-11e1-9935-000c2999f7f1
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4.x & v5.x - HLG01 - Remote syslog should be configured
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: b60247d2-d443-11e1-9935-000c2999f7f1
        description: VMware SHG v5.x - HLG01 - Remote syslog should be configured
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                IS NOT EMPTY:
                  value: ''
                  field: Host.advanced_settings-value
              search:
                =:
                  value: Syslog.global.logHost
                  field: Host.advanced_settings-name
          context_type: 
        towhat: Host
        file_mtime: 
        guid: b60247d2-d443-11e1-9935-000c2999f7f1
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              field: Host-vmm_version
              value: '5'
          context_type: 
        miq_policy_id: 87
        notes: VMware SHG - HLG01 - Remote syslog should be configured VERSION 5.x
          ONLY R1
      - name: 456a882a-d7ce-11e1-b3e5-000c2999f7f1
        description: VMware SHG v4.x - HLG01 - Remote syslog should be configured
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                IS NOT EMPTY:
                  field: Host.advanced_settings-value
                  value: ''
              search:
                =:
                  field: Host.advanced_settings-name
                  value: Syslog.Remote.Hostname
          context_type: 
        towhat: Host
        file_mtime: 
        guid: 456a882a-d7ce-11e1-b3e5-000c2999f7f1
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              field: Host-vmm_version
              value: '4'
          context_type: 
        miq_policy_id: 87
        notes: VMware SHG - HLG01 - Remote syslog should be configured VERSION 4.x
          ONLY R1
    - name: 36021318-d435-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x & v5.x - HCN07 - Set a timeout for Tech Support
        Mode.
      expression: !ruby/object:MiqExpression
        exp:
          =:
            field: Host-vmm_product
            value: ESXi
        context_type: 
      towhat: Host
      guid: 36021318-d435-11e1-9935-000c2999f7f1
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4.x & v5.x - HCN07 - Set a timeout for Tech Support Mode.
        R1
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 9f3b5376-d435-11e1-9935-000c2999f7f1
        description: VMware SHG v4.x - HCN07 - Set a timeout for Tech Support Mode.
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              FIND:
                checkall:
                  =:
                    field: Host.advanced_settings-value
                    value: '0'
                search:
                  =:
                    field: Host.advanced_settings-name
                    value: UserVars.TSMTimeOut
          context_type: 
        towhat: Host
        file_mtime: 
        guid: 9f3b5376-d435-11e1-9935-000c2999f7f1
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              field: Host-vmm_version
              value: '4'
          context_type: 
        miq_policy_id: 86
        notes: VMware SHG v4.x - HCN07 - Set a timeout for Tech Support Mode. R1
      - name: fc017d86-d7cf-11e1-b3e5-000c2999f7f1
        description: VMware SHG v5.x - HCN07 - Set a timeout for Tech Support Mode.
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              FIND:
                checkall:
                  =:
                    value: '0'
                    field: Host.advanced_settings-value
                search:
                  =:
                    value: UserVars.ESXiShellTimeOut
                    field: Host.advanced_settings-name
          context_type: 
        towhat: Host
        file_mtime: 
        guid: fc017d86-d7cf-11e1-b3e5-000c2999f7f1
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              value: '5'
              field: Host-vmm_version
          context_type: 
        miq_policy_id: 86
        notes: VMware SHG v5.x - HCN07 - Set a timeout for Tech Support Mode. R1
- MiqPolicySet:
    name: a5c34544-d400-11e1-9935-000c2999f7f1
    description: VMware Security Hardening Guide v4.x & v5.x (SSLF)
    set_type: MiqPolicySet
    guid: a5c34544-d400-11e1-9935-000c2999f7f1
    read_only: 
    set_data:
      :notes: VMware Security Hardening Guide v4.x & v5.x (SSLF)
    mode: control
    owner_type: 
    owner_id: 
    MiqPolicy:
    - name: e5871bee-d435-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x & v5.x - HCN05 - Disable DCUI to prevent all local
        administrative control
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: ESXi
            field: Host-vmm_product
        context_type: 
      towhat: Host
      guid: e5871bee-d435-11e1-9935-000c2999f7f1
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4.x & v5.x - HCN05 - Disable DCUI to prevent all local administrative
        control R1
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 0f6761b2-d436-11e1-9935-000c2999f7f1
        description: VMware SHG v4.x & v5.x - HCN05 - Disable DCUI to prevent all
          local administrative control
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  value: 'false'
                  field: Host.host_services-running
              search:
                =:
                  value: DCUI
                  field: Host.host_services-name
          context_type: 
        towhat: Host
        file_mtime: 
        guid: 0f6761b2-d436-11e1-9935-000c2999f7f1
        filename: 
        applies_to_exp: 
        miq_policy_id: 95
        notes: VMware SHG v4.x & v5.x - HCN05 - Disable DCUI to prevent all local
          administrative control R1
    - name: 17fce8ee-c39f-11e1-aed6-000c29cc1a4c
      description: VMware SHG - VMX24 - Disable certain unexposed features.
      expression: 
      towhat: Vm
      guid: 17fce8ee-c39f-11e1-aed6-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMware SHG - VMX24 - Disable certain unexposed features.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 98427d34-c39f-11e1-aed6-000c29cc1a4c
        description: Disable certain unexposed features
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.unity.push.update.disable
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.ghi.launchmenu.change
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.memSchedFakeSampleStats.disable
            - FIND:
                checkany:
                  =:
                    field: Vm.advanced_settings-value
                    value: 'true'
                search:
                  =:
                    field: Vm.advanced_settings-name
                    value: isolation.tools.getCreds.disable
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 98427d34-c39f-11e1-aed6-000c29cc1a4c
        filename: 
        applies_to_exp: 
        miq_policy_id: 82
        notes: 
    - name: 3a2acbde-d434-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x & v5.x - HCN06 - Disable Tech Support Mode unless
        needed for diagnostics and break-fix
      expression: !ruby/object:MiqExpression
        exp:
          =:
            field: Host-vmm_product
            value: ESXi
        context_type: 
      towhat: Host
      guid: 3a2acbde-d434-11e1-9935-000c2999f7f1
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4.x & v5.x - HCN06 - Disable Tech Support Mode unless needed
        for diagnostics and break-fix R1
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: e35c1be0-d434-11e1-9935-000c2999f7f1
        description: VMware SHG v4.x & v5.x - HCN06 - Disable Tech Support Mode unless
          needed for diagnostics and break-fix
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                =:
                  field: Host.host_services-running
                  value: 'false'
              search:
                =:
                  field: Host.host_services-name
                  value: TSM
          context_type: 
        towhat: Host
        file_mtime: 
        guid: e35c1be0-d434-11e1-9935-000c2999f7f1
        filename: 
        applies_to_exp: 
        miq_policy_id: 96
        notes: VMware SHG v4.x & v5.x - HCN06 - Disable Tech Support Mode unless needed
          for diagnostics and break-fix R1
    - name: 769b4b1e-c1f8-11e1-ae68-000c29cc1a4c
      description: VMware SHG v4.x & v5.x - VMX30 - Disable remote operations within
        the guest.
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: VMware
            field: Vm-vendor
        context_type: 
      towhat: Vm
      guid: 769b4b1e-c1f8-11e1-ae68-000c29cc1a4c
      created_by: admin
      updated_by: admin
      notes: VMware SHG v4.x & v5.x - VMX30 - Disable remote operations within the
        guest.
      active: true
      mode: compliance
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEvent:
          name: vm_compliance_check
          description: VM Compliance Check
          guid: 816a598a-f57d-11de-a41a-005056ba0614
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: ba452d94-f586-11de-8ebc-0050568a07c7
          action_type: default
          options: 
      Condition:
      - name: 8b7f39d2-c1f8-11e1-ae68-000c29cc1a4c
        description: VMware SHG v4.x - VMX30 - Disable remote operations within the
          guest.
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'false'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: guest.commands.enabled
          context_type: 
        towhat: Vm
        file_mtime: 
        guid: 8b7f39d2-c1f8-11e1-ae68-000c29cc1a4c
        filename: 
        applies_to_exp: !ruby/object:MiqExpression
          exp:
            STARTS WITH:
              value: '4'
              field: Vm.host-vmm_version
          context_type: 
        miq_policy_id: 97
        notes: VMware SHG v4.x - VMX30 - Disable remote operations within the guest.
          R1
