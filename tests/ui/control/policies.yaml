---
- MiqPolicy:
    name: aa4c4c70-7052-11e2-859c-001a4aa8c900
    description: AUTOTAG - Tag as Database
    expression: 
    towhat: Vm
    guid: aa4c4c70-7052-11e2-859c-001a4aa8c900
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4e8b5c4e-7171-11e2-9849-001a4aa8c901
        description: Tag - Database
        guid: 4e8b5c4e-7171-11e2-9849-001a4aa8c901
        action_type: tag
        options:
          :tags:
          - /managed/function/database
    Condition:
    - name: 2fdfd432-7171-11e2-9849-001a4aa8c901
      description: Identify Database Workloads
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - !binary "Q09OVEFJTlM=":
              !binary "ZmllbGQ=": Vm.guest_applications-name
              !binary "dmFsdWU=": mysql
          - !binary "Q09OVEFJTlM=":
              !binary "ZmllbGQ=": Vm.guest_applications-name
              !binary "dmFsdWU=": postgresql
          - !binary "Q09OVEFJTlM=":
              !binary "ZmllbGQ=": Vm.guest_applications-name
              !binary "dmFsdWU=": Microsoft SQL Server 2005
          - !binary "Q09OVEFJTlM=":
              !binary "ZmllbGQ=": Vm.guest_applications-name
              !binary "dmFsdWU=": PostgreSQL
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 2fdfd432-7171-11e2-9849-001a4aa8c901
      filename: 
      applies_to_exp: 
      miq_policy_id: 
      notes: 
- MiqPolicy:
    name: 427a4378-6519-11df-b637-005056a435be
    description: ! 'Analysis: Post Provisioning'
    expression: 
    towhat: Vm
    guid: 427a4378-6519-11df-b637-005056a435be
    created_by: admin
    updated_by: admin
    notes: This policy triggers a vm analysis of any newly provisioned VM
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_provisioned
        description: VM Provision Complete
        guid: 2a17a20a-3e8e-11df-9fe2-005056a435be
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_analyze
        description: Initiate SmartState Analysis for VM
        guid: 5cbe1082-ce35-11de-a117-005056b0503e
        action_type: default
        options: 
    Condition: []
- MiqPolicy:
    name: ! 'Do Not Analyze '
    description: ! 'Analysis: Prevent Analysis of Selected VMs'
    expression: 
    towhat: Vm
    guid: 3a7959c0-2866-11de-af2a-0050568026c2
    created_by: 
    updated_by: admin
    notes: ! 'This policies prevents analysis ofany vm that is tagged as Do Not Analyze '
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      failure_synchronous: true
      MiqEvent:
        name: request_vm_scan
        description: VM Analysis Request
        guid: e3292c46-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: prevent
        description: Prevent current event from proceeding
        guid: d885a118-519b-11e0-8d82-005056af0000
        action_type: default
        options: 
    Condition:
    - name: Do Not Analyze
      description: VM classified as DO_NOT_ANALYZE
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            tag: Vm.managed-exclusions
            value: do_not_analyze
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 39ff4444-08e2-11de-829f-005056a164b2
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000001
      notes: 
- MiqPolicy:
    name: 782068f8-44ee-11e0-99a6-00505688000a
    description: ! 'Analysis: VDI Login'
    expression: 
    towhat: Vm
    guid: 782068f8-44ee-11e0-99a6-00505688000a
    created_by: admin
    updated_by: admin
    notes: This policy triggers an analysis of a VDI session when a user logs in to
      that session
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_vdi_login_session
        description: VDI Login Session
        guid: 15fc3cce-448a-11e0-9ad1-00505688000a
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_analyze
        description: Initiate SmartState Analysis for VM
        guid: 5cbe1082-ce35-11de-a117-005056b0503e
        action_type: default
        options: 
    Condition: []
- MiqPolicy:
    name: 467f80ce-4808-11df-badc-005056a7121f
    description: ! 'Analysis: VM Configuration Only Profile'
    expression: 
    towhat: Vm
    guid: 467f80ce-4808-11df-badc-005056a7121f
    created_by: admin
    updated_by: admin
    notes: ! 'This policy assigns an analysis profile that only gathers vm configuration
      data. Note: the specified action requires that you create an analysis profile
      that only scans vm configuration data. Once it has been created, associate it
      with the specified action'
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_start
        description: VM Analysis Start
        guid: 057b9baa-519c-11e0-8d82-005056af0000
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: b52a86f0-4807-11df-badc-005056a7121f
        description: ! 'Profile: VM configuration only'
        guid: b52a86f0-4807-11df-badc-005056a7121f
        action_type: assign_scan_profile
        options:
          :scan_item_set_name: vm configuration only
    Condition: []
- MiqPolicy:
    name: 2f2a1a1c-4806-11df-badc-005056a7121f
    description: ! 'Analysis: VM Reconfiguration'
    expression: 
    towhat: Vm
    guid: 2f2a1a1c-4806-11df-badc-005056a7121f
    created_by: admin
    updated_by: admin
    notes: Performs an analysis on any vm that has been reconfigured
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_analyze
        description: Initiate SmartState Analysis for VM
        guid: 5cbe1082-ce35-11de-a117-005056b0503e
        action_type: default
        options: 
    Condition: []
- MiqPolicy:
    name: 875e819c-7160-11e2-916e-005056b25af6
    description: ! 'Analysis: VM Shutdown (RHEL6)'
    expression: !ruby/object:MiqExpression
      exp:
        STARTS WITH:
          field: Vm.operating_system-product_name
          value: Red Hat Enterprise Linux 6
      context_type: 
    towhat: Vm
    guid: 875e819c-7160-11e2-916e-005056b25af6
    created_by: admin
    updated_by: admin
    notes: Performs an analysis on any RHEL 6 vm that has been shutdown
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: vm_poweroff
        description: VM Power Off
        guid: 48beeadc-ae7c-11e1-a76f-005056b25af6
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_analyze
        description: Initiate SmartState Analysis for VM
        guid: 5cbe1082-ce35-11de-a117-005056b0503e
        action_type: default
        options: 
    Condition: []
- MiqPolicy:
    name: 93d1141a-7f54-11e2-b728-001a4aa8c901
    description: CONTROL - Stop VM if tagged as Messaging
    expression: 
    towhat: Vm
    guid: 93d1141a-7f54-11e2-b728-001a4aa8c901
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    Condition:
    - name: b0790bf4-7f54-11e2-b728-001a4aa8c901
      description: Tagged as Messaging
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          !binary "Q09OVEFJTlM=":
            !binary "dGFn": Vm.managed-function
            !binary "dmFsdWU=": messaging
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: b0790bf4-7f54-11e2-b728-001a4aa8c901
      filename: 
      applies_to_exp: 
      miq_policy_id: 
      notes: 
- MiqPolicy:
    name: d658fe5c-de2c-11e1-9088-005056af009e
    description: Collect Logged on User Info
    expression: 
    towhat: Vm
    guid: d658fe5c-de2c-11e1-9088-005056af009e
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: 
    Condition:
    - name: ab61c97a-de2e-11e1-9088-005056af009e
      description: Check files starting with nb
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkcount:
              ! '>=':
                value: '1'
                field: <count>
            search:
              INCLUDES:
                value: nb
                field: Vm.filesystems-name
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: ab61c97a-de2e-11e1-9088-005056af009e
      filename: 
      applies_to_exp: 
      miq_policy_id: 5
      notes: 
- MiqPolicy:
    name: c66e6d58-d2fc-11de-b4f6-0050568a547d
    description: ! 'Configuration: Host - DMZ Fully Collapsed Advanced Settings'
    expression: 
    towhat: Host
    guid: c66e6d58-d2fc-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policy verifies designated host advanced settings values to ensure
      that they meet DMZ requirements
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_scan_complete
        description: Host Analysis Complete
        guid: ffcfb368-455d-11de-86a0-005056a81f62
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    Condition:
    - name: 1ea32d10-d2fd-11de-b4f6-0050568a547d
      description: host - dmz - advanced settings - ssl
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: 'true'
                field: Host.advanced_settings-value
            search:
              =:
                value: Config.Defaults.security.host.ruissl
                field: Host.advanced_settings-name
      towhat: Host
      file_mtime: 
      guid: 1ea32d10-d2fd-11de-b4f6-0050568a547d
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000013
      notes: 
- MiqPolicy:
    name: 8a8f247a-480a-11df-badc-005056a7121f
    description: ! 'Configuration: VM - CPU Reservation > 500Mhz'
    expression: 
    towhat: Vm
    guid: 8a8f247a-480a-11df-badc-005056a7121f
    created_by: admin
    updated_by: admin
    notes: Sends an email if CPU reservation is set to a value greater than 500Mhz
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 5189755e-480a-11df-badc-005056a7121f
        description: Alert - CPU Reservation > 500Mhz
        guid: 5189755e-480a-11df-badc-005056a7121f
        action_type: evaluate_alerts
        options:
          :alert_guids:
          - ca26a9c6-4802-11df-badc-005056a7121f
    Condition: []
- MiqPolicy:
    name: 6adebf82-d2e4-11de-b4f6-0050568a547d
    description: ! 'Configuration: VM - DMZ  Fully Collapsed  Network'
    expression: 
    towhat: Vm
    guid: 6adebf82-d2e4-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: ! 'created by: Rod Moore

      purpose: validates vm vlan configuration'
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    Condition:
    - name: 278843f0-d2e6-11de-b4f6-0050568a547d
      description: vm - vlan - webserver
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                IS NOT NULL:
                  field: Vm.lans-created_on
              search:
                INCLUDES:
                  value: External
                  field: Vm.lans-name
          - CONTAINS:
              tag: Vm.managed-function
              value: web_server
      towhat: Vm
      file_mtime: 
      guid: 278843f0-d2e6-11de-b4f6-0050568a547d
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000015
      notes: 
- MiqPolicy:
    name: 39fbf6bc-d2fa-11de-b4f6-0050568a547d
    description: ! 'Configuration: VM - DMZ Fully Collapsed Windows Services'
    expression: 
    towhat: Vm
    guid: 39fbf6bc-d2fa-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policies verifies that certain services are disabled on DMZ vms
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    Condition:
    - name: ed4daf4e-d2fa-11de-b4f6-0050568a547d
      description: dmz - windows alerter - disabled
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          =:
            regkey: HKLM\SYSTEM\CurrentControlSet\Services\Alerter
            regval: Start
            value: 4
      towhat: Vm
      file_mtime: 
      guid: ed4daf4e-d2fa-11de-b4f6-0050568a547d
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000016
      notes: 
    - name: 469a8766-d2fb-11de-b4f6-0050568a547d
      description: dmz - windows messenger - disabled
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          =:
            regkey: HKLM\SYSTEM\CurrentControlSet\Services\Messenger
            regval: Start
            value: 4
      towhat: Vm
      file_mtime: 
      guid: 469a8766-d2fb-11de-b4f6-0050568a547d
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000016
      notes: 
    - name: 7f648a84-d2fa-11de-b4f6-0050568a547d
      description: dmz - windows automatic update - disabled
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          =:
            regkey: HKLM\SYSTEM\CurrentControlSet\Services\wuauserv
            regval: Start
            value: 4
      towhat: Vm
      file_mtime: 
      guid: 7f648a84-d2fa-11de-b4f6-0050568a547d
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000016
      notes: 
- MiqPolicy:
    name: de3af0f2-d2f0-11de-b4f6-0050568a547d
    description: ! 'Configuration: VM - Internal Network'
    expression: 
    towhat: Vm
    guid: de3af0f2-d2f0-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policy shutdown application or database vms that are incorrectly configured
      to access the dmz network
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_reconfigure
        description: VM Settings Change
        guid: 07367e62-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_migrate
        description: VM Live Migration (VMOTION)
        guid: 07500602-449a-11de-bd4f-005056a83e5d
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        description: Email - DMZ
        guid: 4ffb6baa-d2e6-11de-b4f6-0050568a547d
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :to: dmzalert@manageiq.com
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    Condition:
    - name: 020dd9c2-d2f1-11de-b4f6-0050568a547d
      description: vm - internal vlan check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                IS NOT NULL:
                  field: Vm.lans-created_on
              search:
                INCLUDES:
                  value: Internal
                  field: Vm.lans-name
          - or:
            - CONTAINS:
                tag: Vm.managed-function
                value: application_servers
            - CONTAINS:
                tag: Vm.managed-function
                value: database
      towhat: Vm
      file_mtime: 
      guid: 020dd9c2-d2f1-11de-b4f6-0050568a547d
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000014
      notes: 
- MiqPolicy:
    name: 56c4d50e-3069-11de-971a-005056a12545
    description: DISA ESX Server STIG - ESX1170 requires IAO/SA to remove or disable
      all unused hardware on VM
    expression: 
    towhat: Vm
    guid: 56c4d50e-3069-11de-971a-005056a12545
    created_by: 
    updated_by: 
    notes: 
    active: true
    mode: control
    MiqPolicyContent: []
    Condition:
    - name: 627379ac-3067-11de-971a-005056a12545
      description: ! 'ESX1170: CAT II - Guest OS remove all unused hardware'
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkcount:
                =:
                  value: 0
                  field: <count>
              search:
                INCLUDES:
                  value: floppy
                  field: Vm.hardware.disks-device_type
          - FIND:
              checkcount:
                =:
                  value: 0
                  field: <count>
              search:
                INCLUDES:
                  value: cdrom
                  field: Vm.hardware.disks-device_type
      towhat: Vm
      file_mtime: 
      guid: 627379ac-3067-11de-971a-005056a12545
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000010
      notes: 
- MiqPolicy:
    name: 69b1559e-3068-11de-971a-005056a12545
    description: DISA ESX Server STIG requires that the Virtual Machine Administrator
      be responsible for the following
    expression: 
    towhat: Vm
    guid: 69b1559e-3068-11de-971a-005056a12545
    created_by: 
    updated_by: 
    notes: 
    active: true
    mode: control
    MiqPolicyContent: []
    Condition:
    - name: ed826874-3066-11de-971a-005056a12545
      description: ! 'ESX1030: CAT II - Test and Development VMs must be seperated
        from Production VMs'
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkcount:
                ! '>=':
                  value: 1
                  field: <count>
              search:
                STARTS WITH:
                  value: '192.168'
                  field: Vm.hardware.networks-ipaddress
          - CONTAINS:
              tag: Vm.managed-environment
              value: prod
      towhat: Vm
      file_mtime: 
      guid: ed826874-3066-11de-971a-005056a12545
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000011
      notes: 
    - name: 28e35e32-3067-11de-971a-005056a12545
      description: ! 'ESX0940: CAT II - prevent use of nonpersistent disk mode'
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkcount:
              =:
                value: 0
                field: <count>
            search:
              INCLUDES:
                value: nonpersistent
                field: Vm.hardware.disks-mode
      towhat: Vm
      file_mtime: 
      guid: 28e35e32-3067-11de-971a-005056a12545
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000011
      notes: 
- MiqPolicy:
    name: de9aa7ec-3069-11de-971a-005056a12545
    description: DISA Information Assurance Vulnerability Alert - MS08-67
    expression: 
    towhat: Vm
    guid: de9aa7ec-3069-11de-971a-005056a12545
    created_by: 
    updated_by: 
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    Condition:
    - name: 7e492e4c-3067-11de-971a-005056a12545
      description: IAVA - MS08-067 for Windows 2000 Service Pack 4
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkall:
                STARTS WITH:
                  value: 5.00.2195.7203
                  field: Vm.filesystems-file_version
              search:
                =:
                  value: c:/winnt/system32/netapi32.dll
                  field: Vm.filesystems-name
          - KEY EXISTS:
              regkey: HKLM\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB958644\Filelist
      towhat: Vm
      file_mtime: 
      guid: 7e492e4c-3067-11de-971a-005056a12545
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          and:
          - STARTS WITH:
              value: Microsoft Windows 2000
              field: Vm.operating_system-product_name
          - =:
              value: Service Pack 4
              field: Vm.operating_system-service_pack
      miq_policy_id: 10000000000012
      notes: 
    - name: 8b0d83d0-3067-11de-971a-005056a12545
      description: IAVA - MS08-067 for Windows Server 2003 Service Pack 1 & 2
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - and:
            - =:
                value: Service Pack 1
                field: Vm.operating_system-service_pack
            - FIND:
                checkall:
                  STARTS WITH:
                    value: 5.2.3790.3229
                    field: Vm.filesystems-file_version
                search:
                  =:
                    value: c:/windows/system32/netapi32.dll
                    field: Vm.filesystems-name
          - and:
            - =:
                value: Service Pack 2
                field: Vm.operating_system-service_pack
            - FIND:
                checkall:
                  STARTS WITH:
                    value: 5.2.3790.4392
                    field: Vm.filesystems-file_version
                search:
                  =:
                    value: c:/windows/system32/netapi32.dll
                    field: Vm.filesystems-name
      towhat: Vm
      file_mtime: 
      guid: 8b0d83d0-3067-11de-971a-005056a12545
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          and:
          - STARTS WITH:
              value: Microsoft Windows Server 2003
              field: Vm.operating_system-product_name
          - or:
            - =:
                value: Service Pack 1
                field: Vm.operating_system-service_pack
            - =:
                value: Service Pack 2
                field: Vm.operating_system-service_pack
      miq_policy_id: 10000000000012
      notes: 
    - name: 9482beb2-3067-11de-971a-005056a12545
      description: IAVA - MS08-067 for Windows XP Service Pack 2 & 3
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkall:
                STARTS WITH:
                  value: 5.1.2600.3462
                  field: Vm.filesystems-file_version
              search:
                =:
                  value: c:/windows/system32/netapi32.dll
                  field: Vm.filesystems-name
          - KEY EXISTS:
              regkey: HKLM\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB958644\Filelist
      towhat: Vm
      file_mtime: 
      guid: 9482beb2-3067-11de-971a-005056a12545
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          and:
          - STARTS WITH:
              value: Microsoft Windows XP
              field: Vm.operating_system-product_name
          - or:
            - =:
                value: Service Pack 2
                field: Vm.operating_system-service_pack
            - =:
                value: Service Pack 3
                field: Vm.operating_system-service_pack
      miq_policy_id: 10000000000012
      notes: 
- MiqPolicy:
    name: 69fbd202-8ba3-11e0-b8fc-005056a40e59
    description: DMZ - Shutdown VM after Analysis if it has more than 1 NIC
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: 'on'
          field: Vm-power_state
      context_type: 
    towhat: Vm
    guid: 69fbd202-8ba3-11e0-b8fc-005056a40e59
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: evm_event
        description: Show EVM Event on Timeline
        guid: 16b1810c-44e8-11e0-acda-005056a40e59
        action_type: default
        options: 
    Condition:
    - name: efcf3702-8b9e-11e0-b8fc-005056a40e59
      description: DMZ - VM has more than 1 NIC
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          ! '>':
            count: Vm.hardware.nics
            value: '1'
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: efcf3702-8b9e-11e0-b8fc-005056a40e59
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000077
      notes: 
- MiqPolicy:
    name: 0de66508-8b9f-11e0-b8fc-005056a40e59
    description: DMZ - Shutdown VM after Starting if it has more than 1 NIC
    expression: 
    towhat: Vm
    guid: 0de66508-8b9f-11e0-b8fc-005056a40e59
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: evm_event
        description: Show EVM Event on Timeline
        guid: 16b1810c-44e8-11e0-acda-005056a40e59
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: d91bbabc-b0be-11e1-b0dc-005056b057a8
        description: ! 'VM Attribute: Allowed NIC Count Exceeded'
        guid: d91bbabc-b0be-11e1-b0dc-005056b057a8
        action_type: set_custom_attribute
        options:
          :attribute: EVM Policy
          :value: Allowed NIC Limit Exceeded
    Condition:
    - name: efcf3702-8b9e-11e0-b8fc-005056a40e59
      description: DMZ - VM has more than 1 NIC
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          ! '>':
            count: Vm.hardware.nics
            value: '1'
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: efcf3702-8b9e-11e0-b8fc-005056a40e59
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000077
      notes: 
- MiqPolicy:
    name: 26700c34-720a-11e2-a37d-005056b25af6
    description: ! 'Demo: Shutdown Unpatched Windows VM'
    expression: !ruby/object:MiqExpression
      exp:
        STARTS WITH:
          field: Vm.operating_system-product_name
          value: Windows 7
      context_type: 
    towhat: Vm
    guid: 26700c34-720a-11e2-a37d-005056b25af6
    created_by: admin
    updated_by: admin
    notes: This policy will shutdown a windows vm that does not have a particular
      patch installed
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_shutdown_guest
        description: Shutdown Virtual Machine Guest OS
        guid: 26b84380-bbd5-11de-aaab-0050568a2c6a
        action_type: default
        options: 
    Condition:
    - name: a132cff6-720a-11e2-916e-005056b25af6
      description: Patch KB2633952 is not installed
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              field: Vm.patches-name
              value: KB2633952
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: a132cff6-720a-11e2-916e-005056b25af6
      filename: 
      applies_to_exp: 
      miq_policy_id: 
      notes: This condition returns true if the patch named KB2633952 is not installed
- MiqPolicy:
    name: 0f2cc826-fa4b-11de-83ca-005056ba0614
    description: Directory Service Used for Authentication for sudo
    expression: 
    towhat: Host
    guid: 0f2cc826-fa4b-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that sudo is configured to use a directory for user
      authentication.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 684b2a60-fa4b-11de-83ca-005056ba0614
      description: Directory Service used for sudo authentication
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*auth\s+required\s+.*pam_stack\.so\s+service=system-auth
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/pam.d/sudo
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 684b2a60-fa4b-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000053
      notes: ! 'This condition verifies that the line "auth required pam_stack.so
        service=system-auth" exists in /etc/pam.d/sudo. '
- MiqPolicy:
    name: 1c4c7772-a7fb-11e0-abed-005056af0000
    description: Do Not Analyze Active VDI VMs
    expression: 
    towhat: Vm
    guid: 1c4c7772-a7fb-11e0-abed-005056af0000
    created_by: admin
    updated_by: admin
    notes: This policy prevents analysis of a vm that has an active user session
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_start
        description: VM Analysis Start
        guid: 057b9baa-519c-11e0-8d82-005056af0000
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: prevent
        description: Prevent current event from proceeding
        guid: d885a118-519b-11e0-8d82-005056af0000
        action_type: default
        options: 
    Condition:
    - name: 0a50f750-a7fb-11e0-abed-005056af0000
      description: VM has an active session
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          =:
            value: 'true'
            field: Vm-has_active_vdi_session
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 0a50f750-a7fb-11e0-abed-005056af0000
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000007
      notes: 
- MiqPolicy:
    name: af2d74ea-fa39-11de-83ca-005056ba0614
    description: Firewall - Incoming Security Level
    expression: 
    towhat: Host
    guid: af2d74ea-fa39-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that only a defined set of incoming TCP and UDP Ports
      are open.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: b4a0843a-fa43-11de-83ca-005056ba0614
      description: Valid Incoming UDP Ports
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: '427'
            field: Host-enabled_udp_inbound_ports
      towhat: Host
      file_mtime: 
      guid: b4a0843a-fa43-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000021
      notes: This condition verifies that the only open incoming UDP port is 427.
    - name: 03529e9e-f961-11de-9e9d-0050568a07c7
      description: Valid Incoming TCP Ports
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: '902,80,443,427,5989,22,5988'
            field: Host-enabled_tcp_inbound_ports
      towhat: Host
      file_mtime: 
      guid: 03529e9e-f961-11de-9e9d-0050568a07c7
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000021
      notes: This condition verifies that the only open incoming TCP ports are 22,80,427,443,902,5988,and
        5989.
- MiqPolicy:
    name: edaf1082-fa54-11de-83ca-005056ba0614
    description: Firewall - Outgoing NTP Port
    expression: 
    towhat: Host
    guid: edaf1082-fa54-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates that the Firewall is configured properly for NTP
      support.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 1cb7f0ba-fa55-11de-83ca-005056ba0614
      description: Valid NTP Outgoing UDP Port
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          INCLUDES ANY:
            value: '123'
            field: Host-enabled_udp_outbound_ports
      towhat: Host
      file_mtime: 
      guid: 1cb7f0ba-fa55-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000052
      notes: This condition verifies that the outgoing UDP port required by NTP (port
        123) is open.
- MiqPolicy:
    name: 04db603c-fa3a-11de-83ca-005056ba0614
    description: Firewall - Outgoing Security Level
    expression: 
    towhat: Host
    guid: 04db603c-fa3a-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that only a defined set of outgoing TCP and UDP Ports
      are open.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: f0afd7d6-fa3a-11de-83ca-005056ba0614
      description: Valid Outgoing TCP Ports
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: '902,427,443,27000,27010'
            field: Host-enabled_tcp_outbound_ports
      towhat: Host
      file_mtime: 
      guid: f0afd7d6-fa3a-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000020
      notes: This condition verifies that the only open outgoing TCP ports are 427,443,902,27000,
        and 27010.
    - name: 1778fb28-fa44-11de-83ca-005056ba0614
      description: Valid Outgoing UDP Ports
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: '427,123,902'
            field: Host-enabled_udp_outbound_ports
      towhat: Host
      file_mtime: 
      guid: 1778fb28-fa44-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000020
      notes: This condition verifies that the only open outgoing UDP ports are 123,427,
        and 902.
- MiqPolicy:
    name: 2d6bfc2c-fa3b-11de-83ca-005056ba0614
    description: Limit Log Size
    expression: 
    towhat: Vm
    guid: 2d6bfc2c-fa3b-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 8b9cf076-fa3b-11de-83ca-005056ba0614
      description: Log Size Limit <= 100KB
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              <=:
                value: '100000'
                field: Vm.advanced_settings-value
            search:
              =:
                value: log.rotateSize
                field: Vm.advanced_settings-name
      towhat: Vm
      file_mtime: 
      guid: 8b9cf076-fa3b-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000061
      notes: 
- MiqPolicy:
    name: f1af8b44-fa3b-11de-83ca-005056ba0614
    description: Limit Number of Log Files
    expression: 
    towhat: Vm
    guid: f1af8b44-fa3b-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: f2ad72ac-fa3d-11de-83ca-005056ba0614
      description: Number of Log Files to Keep <= 10
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              <=:
                value: '10'
                field: Vm.advanced_settings-value
            search:
              =:
                value: log.keepOld
                field: Vm.advanced_settings-name
      towhat: Vm
      file_mtime: 
      guid: f2ad72ac-fa3d-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000060
      notes: 
- MiqPolicy:
    name: 2cd1b736-fa52-11de-83ca-005056ba0614
    description: Limit Software and Services Running in Service Console
    expression: 
    towhat: Host
    guid: 2cd1b736-fa52-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates that only an approved list of services are enabled
      at boot time on an ESX host.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: c4c80bfa-fa55-11de-83ca-005056ba0614
      description: Default Services Running in Service Console
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          LIMITED TO:
            value: crond, firewall, gpm, ipmi, irqbalance, mgmt-vmware, microcode_ctl,
              mptctlnode, network, ntpd, pegasus, portmap, random, rawdevices, sshd,
              syslog, vmware, vmware-autostart, vmware-late, vmware-vmkauthd, vmware-vpxa,
              vmware-webAccess, wsman, xinetd
            field: Host-enabled_run_level_3_services
      towhat: Host
      file_mtime: 
      guid: c4c80bfa-fa55-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000051
      notes: This conditions validates that a defined list of services are enabled
        with the ESX host is booted with networking support (run level 3). This list
        includes the generic services included in ESX. Additional hardware specific
        services can be added to the expression.
- MiqPolicy:
    name: 8cecc84c-fa46-11de-83ca-005056ba0614
    description: Limit su Access to root Account
    expression: 
    towhat: Host
    guid: 8cecc84c-fa46-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates that only members of the group wheel can access the
      su command.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 63b243fc-fa47-11de-83ca-005056ba0614
      description: Only members of wheel group can execute su command
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*auth\s+required\s+.*pam_wheel\.so\s+use_uid
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/pam.d/su
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 63b243fc-fa47-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000050
      notes: This condition validates that the file /etc/pam.d/su contains a variation
        of the string "auth required pam_wheel.so use_uid".
- MiqPolicy:
    name: c79821fa-fa53-11de-83ca-005056ba0614
    description: Limit vmkernel Size
    expression: 
    towhat: Host
    guid: c79821fa-fa53-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy checks the vmkernel log is limited to a specified size.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: be9722e0-fa53-11de-83ca-005056ba0614
      description: vmkernel Log Size <= 4096KB
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmkernel
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: be9722e0-fa53-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000049
      notes: This condition verifies that the file /etc/logrotate.d/vmkernel is configured
        to limit the associated log to 4096KB.
- MiqPolicy:
    name: fc63df74-fa52-11de-83ca-005056ba0614
    description: Limit vmksummary Size
    expression: 
    towhat: Host
    guid: fc63df74-fa52-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy checks the vmksummary log is limited to a specified size.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: def33840-fa52-11de-83ca-005056ba0614
      description: vmksummary Log Size <= 4096KB
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmksummary
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: def33840-fa52-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000056
      notes: This condition verifies that the file /etc/logrotate.d/vmksummary is
        configured to limit the associated log to 4096KB.
- MiqPolicy:
    name: 79548666-fa51-11de-83ca-005056ba0614
    description: Limit vmkwarning Size
    expression: 
    towhat: Host
    guid: 79548666-fa51-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy checks the vmkwarning log is limited to a specified size.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 14d35e46-fa52-11de-83ca-005056ba0614
      description: vmkwarning Log Size <= 4096KB
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*size\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\d{1,3})k
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmkwarning
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 14d35e46-fa52-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000048
      notes: This condition verifies that the file /etc/logrotate.d/vmkwarning is
        configured to limit the associated log to 4096KB.
- MiqPolicy:
    name: 61b355f2-fee1-11de-83dd-005056ba5e76
    description: Network - Forged Transmits Must Be Disabled
    expression: 
    towhat: Host
    guid: 61b355f2-fee1-11de-83dd-005056ba5e76
    created_by: admin
    updated_by: admin
    notes: This policy insures that forged transmits are disabled on both vLans and
      vSwitches.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: f246e3e0-fee1-11de-83dd-005056ba5e76
      description: Forged Transmits Disabled in vLan
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'false'
              field: Host.lans-forged_transmits
      towhat: Host
      file_mtime: 
      guid: f246e3e0-fee1-11de-83dd-005056ba5e76
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000022
      notes: This condition verifies that forged transmits are disabled on vlans.
    - name: a3ac5774-fee1-11de-83dd-005056ba5e76
      description: Forged Transmits Disabled in vSwitch
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'false'
              field: Host.switches-forged_transmits
      towhat: Host
      file_mtime: 
      guid: a3ac5774-fee1-11de-83dd-005056ba5e76
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000022
      notes: This condition verifies that forged transmits are disabled on vSwitches.
- MiqPolicy:
    name: de683aa6-fedf-11de-83dd-005056ba5e76
    description: Network - Mac Changes not Allowed
    expression: 
    towhat: Host
    guid: de683aa6-fedf-11de-83dd-005056ba5e76
    created_by: admin
    updated_by: admin
    notes: This policy checks that MAC changes are not allowed on vSwitches and vLans.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 0a6eb332-fee0-11de-83dd-005056ba5e76
      description: Mac Changes Disabled in vSwitches
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'false'
              field: Host.switches-mac_changes
      towhat: Host
      file_mtime: 
      guid: 0a6eb332-fee0-11de-83dd-005056ba5e76
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000028
      notes: This condition verifies that MAC changes are not allowed on vSwitches.
    - name: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
      description: Mac Changes Disabled in vLans
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'false'
              field: Host.lans-mac_changes
      towhat: Host
      file_mtime: 
      guid: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000028
      notes: This condition verifies that MAC changes are not allowed on vLans.
- MiqPolicy:
    name: 7cc14778-fe0f-11de-83dd-005056ba5e76
    description: Network - Promiscuous Mode Setting Not Disabled
    expression: 
    towhat: Host
    guid: 7cc14778-fe0f-11de-83dd-005056ba5e76
    created_by: admin
    updated_by: admin
    notes: Check the Host VLan setting for Promiscuous Mode which should be disabled.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 2045b314-fe58-11de-83dd-005056ba5e76
      description: Check Host vSwitch - Promiscuous Mode Must Not Be Enable
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'true'
              field: Host.switches-allow_promiscuous
      towhat: Host
      file_mtime: 
      guid: 2045b314-fe58-11de-83dd-005056ba5e76
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000029
      notes: This condition verifies that vSwitches do not allow Promiscuous mode
        via inheritance.
    - name: 80e5ff5e-fe16-11de-83dd-005056ba5e76
      description: Check Host Port - Promiscuous Mode Must Not Be Enabled
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            CONTAINS:
              value: 'true'
              field: Host.lans-computed_allow_promiscuous
      towhat: Host
      file_mtime: 
      guid: 80e5ff5e-fe16-11de-83dd-005056ba5e76
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000029
      notes: This condition verifies that vLans do not allow Promiscuous mode via
        inheritance.
- MiqPolicy:
    name: Configuration Policy Restrict Cloning SQL Server
    description: ! 'Operational: Prevent Cloning of Database VMs'
    expression: 
    towhat: Vm
    guid: 39fdeba0-2866-11de-af2a-0050568026c2
    created_by: 
    updated_by: admin
    notes: prevents cloning of vms with a workload tag value of database
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_clone_start
        description: VM Clone Start
        guid: e30f6720-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: cancel_task
        description: Cancel vCenter Task
        guid: e49bfee6-1e1e-11de-8918-0050568005db
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: vm_clone_start
        description: VM Clone Start
        guid: e30f6720-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: SendEmail
        description: SendEmail
        guid: abcf406c-02cd-11de-86d4-005056903dbc
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :from: evmadmin@manageiq.com
          :to: evm_demo@manageiq.com
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: vm_clone_start
        description: VM Clone Start
        guid: e30f6720-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 4468f036-0b6d-11df-bd07-005056a7121f
        description: VM Attribute - Prevent Clone of SQL Server
        guid: 4468f036-0b6d-11df-bd07-005056a7121f
        action_type: set_custom_attribute
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :value: Clone Prevented for SQL Server VM
          :attribute: EVM Policy
    Condition:
    - name: VMs running SQL Server
      description: VMs with Workload - Database
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            tag: Vm.managed-function
            value: database
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 121ecf62-01c6-11de-a701-005056903dbc
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000064
      notes: 
- MiqPolicy:
    name: Automation Policy - Scope VM Retirement Warning,  ResponseExecute Automation
      Model
    description: ! 'Operational: Retirement Warning'
    expression: 
    towhat: Vm
    guid: 39621392-2866-11de-af2a-0050568026c2
    created_by: 
    updated_by: admin
    notes: This policy raises an automation event when a retirement warning event
      is raised
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      failure_synchronous: true
      MiqEvent:
        name: vm_retire_warn
        description: VM Retirement Warning
        guid: 97c85330-fe93-11dd-b5e1-005056903dbc
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: 
    Condition: []
- MiqPolicy:
    name: Automation Policy - Scope VM Retired Response Execute Automation Model
    description: ! 'Operational: Vm Retired'
    expression: 
    towhat: Vm
    guid: 397700ae-2866-11de-af2a-0050568026c2
    created_by: 
    updated_by: admin
    notes: This policy raises an automation event when a vm retirement event is raised
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      failure_synchronous: true
      MiqEvent:
        name: vm_retired
        description: VM Retired
        guid: e363d8aa-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: 
    Condition: []
- MiqPolicy:
    name: 2f9fad14-fa4e-11de-83ca-005056ba0614
    description: Password Aging - Default Maximum
    expression: 
    towhat: Host
    guid: 2f9fad14-fa4e-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates the ESX host's maximum password age configuration.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: a4a0e740-fa4e-11de-83ca-005056ba0614
      description: Default Maximum Password Age <= 90days
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PASS_MAX_DAYS\s+([0-9]|[1-8][0-9]|90)
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/login.defs
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: a4a0e740-fa4e-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000047
      notes: This condition checks the file /etc/login.defs and verifies that the
        PASS_MAX_DAYS parameter's value is 90 days or greater.
- MiqPolicy:
    name: 32b26f2c-fa4f-11de-83ca-005056ba0614
    description: Password Aging - Default Minimum
    expression: 
    towhat: Host
    guid: 32b26f2c-fa4f-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy validates the ESX host's minimum password age configuration.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 79d39ad4-fa4f-11de-83ca-005056ba0614
      description: Default Minimum Password Age >= 0
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PASS_MIN_DAYS\s+\d+
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/login.defs
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 79d39ad4-fa4f-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000059
      notes: This condition checks the file /etc/login.defs and verifies that the
        PASS_MIN_DAYS parameter's value is greater than or equal to 0 days.
- MiqPolicy:
    name: 305e6832-fa51-11de-83ca-005056ba0614
    description: Password Complexity - Minimum Length
    expression: 
    towhat: Host
    guid: 305e6832-fa51-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies the minimum password length.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: c0ba559e-fa51-11de-83ca-005056ba0614
      description: Minimum Password Length >= 8
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PASS_MIN_LEN\s+([8-9]|[1-9][0-9]+)
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/login.defs
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: c0ba559e-fa51-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000057
      notes: This condition checks the file /etc/login.defs and verifies that the
        PASS_MIN_LEN parameter's value  is 8 or greater.
- MiqPolicy:
    name: 40b796dc-fa50-11de-83ca-005056ba0614
    description: Password Expiration Warning Default
    expression: 
    towhat: Host
    guid: 40b796dc-fa50-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies the default setting for password expiration warning.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 0e842bde-fa51-11de-83ca-005056ba0614
      description: Password Expiration Warning Default >= 7days
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PASS_WARN_AGE\s+([7-9]|[1-9][0-9]+)
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/login.defs
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 0e842bde-fa51-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000046
      notes: This condition checks the file /etc/login.defs and verifies that PASS_WARN_AGE
        parameter's value is set to 7 or greater.
- MiqPolicy:
    name: e6f082ba-fa4c-11de-83ca-005056ba0614
    description: Password checking enabled for sudo
    expression: 
    towhat: Host
    guid: e6f082ba-fa4c-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that password checking is enabled for sudo.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 3d2074e2-fa4d-11de-83ca-005056ba0614
      description: NOPASSWD does not exist in sudoers file
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION DOES NOT MATCH:
                value: /^[^#]*NOPASSWD/i
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/sudoers
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 3d2074e2-fa4d-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000058
      notes: This condition check the file /etc/sudoers and verifies that it does
        not contain the word NOPASSWORD on an uncommented line.
- MiqPolicy:
    name: c5d44cb2-4734-11df-b577-005056a7121f
    description: ! 'Patch: MS10-008 Required'
    expression: !ruby/object:MiqExpression
      exp:
        CONTAINS:
          tag: Vm.managed-environment
          value: prod
      context_type: 
    towhat: Vm
    guid: c5d44cb2-4734-11df-b577-005056a7121f
    created_by: admin
    updated_by: admin
    notes: Prevents a VM that does not have MS10-008 installed from running in the
      virtual environment. It's scope limits it to vms tagged as production
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    - qualifier: failure
      failure_sequence: 2
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: SendEmail
        description: SendEmail
        guid: abcf406c-02cd-11de-86d4-005056903dbc
        action_type: email
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :from: evmadmin@manageiq.com
          :to: evm_demo@manageiq.com
    - qualifier: failure
      failure_sequence: 3
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 722d25cc-56dc-11df-bb16-005056a7121f
        description: VM Attribute - Fails patch policy
        guid: 722d25cc-56dc-11df-bb16-005056a7121f
        action_type: set_custom_attribute
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :value: Failed Windows Required Patch Policy
          :attribute: EVM Policy
    Condition:
    - name: a3089008-4734-11df-b577-005056a7121f
      description: Verify KB978262 is installed
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            value: KB978262
            field: Vm.patches-name
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: a3089008-4734-11df-b577-005056a7121f
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000071
      notes: 
- MiqPolicy:
    name: e4c93c82-fa3a-11de-83ca-005056ba0614
    description: Permissions - /etc/grub.conf
    expression: 
    towhat: Host
    guid: e4c93c82-fa3a-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that editing the server's boot process requires root
      level authority.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: d2adb400-fa3b-11de-83ca-005056ba0614
      description: Permissions - /etc/grub.conf
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  value: '0600'
                  field: Host.filesystems-permissions
              search:
                =:
                  value: /etc/grub.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                =:
                  value: root
                  field: Host.filesystems-owner
              search:
                =:
                  value: /etc/grub.conf
                  field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: d2adb400-fa3b-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000027
      notes: This condition verifies that the file /etc/grub.conf's permissions are
        set to 0600 and is owned by root.
- MiqPolicy:
    name: 7ea7db8c-fa46-11de-83ca-005056ba0614
    description: Permissions - /etc/snmp/snmpd.conf
    expression: 
    towhat: Host
    guid: 7ea7db8c-fa46-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy ensures that access to SNMP configuration parameters are limited
      to the root user.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: ebb24a50-fa46-11de-83ca-005056ba0614
      description: Permissions - /etc/snmp/snmpd.conf
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  value: '0700'
                  field: Host.filesystems-permissions
              search:
                =:
                  value: /etc/snmp/snmpd.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                =:
                  value: root
                  field: Host.filesystems-owner
              search:
                =:
                  value: /etc/snmp/snmpd.conf
                  field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: ebb24a50-fa46-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000045
      notes: This condition verifies that the permissions of /etc/snmp/snmpd.conf
        are 0700 and is owned by root.
- MiqPolicy:
    name: 7408efa8-21b3-11e2-a38c-0050568b19a3
    description: Power-Off Virtual Machines
    expression: 
    towhat: Vm
    guid: 7408efa8-21b3-11e2-a38c-0050568b19a3
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    Condition:
    - name: d514b2fa-21b3-11e2-a38c-0050568b19a3
      description: VM with Workload Tag Messaging
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          !binary "Q09OVEFJTlM=":
            !binary "dGFn": Vm.managed-function
            !binary "dmFsdWU=": messaging
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: d514b2fa-21b3-11e2-a38c-0050568b19a3
      filename: 
      applies_to_exp: 
      miq_policy_id: 
      notes: 
- MiqPolicy:
    name: f4f0e916-bbd5-11e1-a4a4-005056b25af6
    description: Prevent PowerOn of Quarantined VM
    expression: 
    towhat: Vm
    guid: f4f0e916-bbd5-11e1-a4a4-005056b25af6
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: request_vm_start
        description: VM Power On Request
        guid: 48b02c4a-ae7c-11e1-a76f-005056b25af6
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    Condition:
    - name: 1cbc27da-bbd6-11e1-ac0c-005056b25af6
      description: VM Tagged as Do Not PowerOn
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          CONTAINS:
            tag: Vm.managed-exclusions
            value: do_not_power_on
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 1cbc27da-bbd6-11e1-ac0c-005056b25af6
      filename: 
      applies_to_exp: 
      miq_policy_id: 
      notes: 
- MiqPolicy:
    name: eb84f288-fa39-11de-83ca-005056ba0614
    description: Protect Root File System Filling /home
    expression: 
    towhat: Host
    guid: eb84f288-fa39-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the /home directory is mounted on a different
      partition than the root filesystem.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 62447a1a-fa3a-11de-83ca-005056ba0614
      description: Protect Root File System Filling /home
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^[^#]*\/home
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/fstab
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 62447a1a-fa3a-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000019
      notes: This condition verifies that the file /etc/fstab has an uncommented line
        that references the directory /home.
- MiqPolicy:
    name: a128d356-fa36-11de-83ca-005056ba0614
    description: Protect Root File System Filling /tmp
    expression: 
    towhat: Host
    guid: a128d356-fa36-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the /tmp directory is mounted on a different
      partition than the root filesystem.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 267dd9de-fa37-11de-83ca-005056ba0614
      description: Protect Root File System Filling  /tmp
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^[^#]*\/tmp
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/fstab
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 267dd9de-fa37-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000044
      notes: This condition verifies that the file /etc/fstab has an uncommented line
        that references the directory /tmp.
- MiqPolicy:
    name: 854d45aa-fa3a-11de-83ca-005056ba0614
    description: Protect Root File System Filling /var/log
    expression: 
    towhat: Host
    guid: 854d45aa-fa3a-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the /var/log directory is mounted on a different
      partition than the root filesystem.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: a84173e2-fa3a-11de-83ca-005056ba0614
      description: Protect Root File System Filling /var/log
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^[^#]*\/var\/log
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/fstab
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: a84173e2-fa3a-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000055
      notes: This condition verifies that the file /etc/fstab has an uncommented line
        that references the directory /var/log.
- MiqPolicy:
    name: 57189108-d1d3-11e1-9ede-005056af009e
    description: Record Last RDP User
    expression: 
    towhat: Vm
    guid: 57189108-d1d3-11e1-9ede-005056af009e
    created_by: admin
    updated_by: admin
    notes: ! 'When a user logs on to the VM through an RDP session, the file c:\rdp_login\rdp.log
      is automatically created by the logon script.


      A analysis profile should be set to retrieve this file and its content.


      This policy will automatically raise an automate event so the content of the
      file can be parsed and elements set as custom attributes of the VM '
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: raise_automation_event
        description: Raise Automation Event
        guid: e7da3b7a-1139-11e1-9333-005056af009e
        action_type: default
        options: 
    Condition:
    - name: 5a4c3456-de30-11e1-9088-005056af009e
      description: Check for files starting with rep
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkcount:
              ! '>=':
                field: <count>
                value: '1'
            search:
              INCLUDES:
                field: Vm.filesystems-name
                value: rdp
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 5a4c3456-de30-11e1-9088-005056af009e
      filename: 
      applies_to_exp: 
      miq_policy_id: 4
      notes: 
- MiqPolicy:
    name: 5ce6be9a-fa4c-11de-83ca-005056ba0614
    description: Require users to enter own password - no ROOTPW entry
    expression: 
    towhat: Host
    guid: 5ce6be9a-fa4c-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that when the sudo command is used, each user is prompted
      for their password and not the root password.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: a791b882-fa4c-11de-83ca-005056ba0614
      description: ROOTPW does not exist in sudoers file
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION DOES NOT MATCH:
                value: /^[^#]*ROOTPW/i
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/sudoers
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: a791b882-fa4c-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000043
      notes: This condition check the file /etc/sudoers and verifies that it does
        not contain the word ROOTPW on an uncommented line.
- MiqPolicy:
    name: 11881e2a-ee42-11e1-bcd2-005056b25af6
    description: Reset CPU configuration to base level
    expression: 
    towhat: Vm
    guid: 11881e2a-ee42-11e1-bcd2-005056b25af6
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent: []
    Condition: []
- MiqPolicy:
    name: eb0151ea-fa47-11de-83ca-005056ba0614
    description: Root Login on console should be Disabled
    expression: 
    towhat: Host
    guid: eb0151ea-fa47-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the root account cannot directly login via the
      console.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 571e6e76-fa48-11de-83ca-005056ba0614
      description: File /etc/securetty should be empty
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: '0'
                field: Host.filesystems-size
            search:
              =:
                value: /etc/securetty
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 571e6e76-fa48-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000026
      notes: This condition checks the file /etc/securetty and verifies that it's
        empty by checking for a 0KB file size.
- MiqPolicy:
    name: c63b0560-fa45-11de-83ca-005056ba0614
    description: Root Login via SSH should be Disabled
    expression: 
    towhat: Host
    guid: c63b0560-fa45-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the root account cannot login to the host via
      SSH.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 4435b6d6-fa46-11de-83ca-005056ba0614
      description: PermitRootLogin = no in sshd_config file
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*PermitRootLogin\s+no
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ssh/sshd_config
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 4435b6d6-fa46-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000042
      notes: This condition checks the file /etc/ssh/sshd_config and verifies that
        the PermitRootLogin parameter's value is set to no.
- MiqPolicy:
    name: 24b92088-399c-11de-ae27-005056a11a54
    description: Service Level Gold - RAM must be 1GB and 1 vCPU - off
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: gold
        - =:
            value: 'off'
            field: Vm-power_state
      context_type: 
    towhat: Vm
    guid: 24b92088-399c-11de-ae27-005056a11a54
    created_by: 
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of gold has
      1vCPU and 1GB of memory. If not it changes the vm to these values. This policy
      is used on a powered off vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_RAM_1GB
        description: Set VM RAM to 1GB
        guid: 2d8445f2-9aec-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 1024
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_CPU_1
        description: Set VM CPU to 1
        guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '1'
    Condition:
    - name: 1c6ec35e-3908-11de-b6d5-005056a11a54
      description: Service Level Gold - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 1024
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 1
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime: 
      guid: 1c6ec35e-3908-11de-b6d5-005056a11a54
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000069
      notes: 
- MiqPolicy:
    name: 7a91f3ac-3908-11de-b6d5-005056a11a54
    description: Service Level Gold - RAM must be 1GB and 1 vCPU - on
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: gold
        - =:
            value: 'on'
            field: Vm-power_state
      context_type: 
    towhat: Vm
    guid: 7a91f3ac-3908-11de-b6d5-005056a11a54
    created_by: 
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of gold has
      1vCPU and 1GB of memory. If not it changes the vm to these values. This policy
      is used on a powered on vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_RAM_1GB
        description: Set VM RAM to 1GB
        guid: 2d8445f2-9aec-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 1024
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_CPU_1
        description: Set VM CPU to 1
        guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '1'
    - qualifier: success
      success_sequence: 4
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_start
        description: Start Virtual Machine
        guid: 55b5a422-3348-11de-bde2-005056a170fa
        action_type: default
        options: 
    Condition:
    - name: 1c6ec35e-3908-11de-b6d5-005056a11a54
      description: Service Level Gold - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 1024
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 1
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime: 
      guid: 1c6ec35e-3908-11de-b6d5-005056a11a54
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000069
      notes: 
- MiqPolicy:
    name: b265c970-3908-11de-b6d5-005056a11a54
    description: Service Level Platinum - RAM must be 2GB and 2 vCPUs - off
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: platinum
        - =:
            value: 'off'
            field: Vm-power_state
      context_type: 
    towhat: Vm
    guid: b265c970-3908-11de-b6d5-005056a11a54
    created_by: 
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of platinum
      has 2 vCPUs and 2GB of memory. If not it changes the vm to these values. This
      policy is used on a powered off vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_RAM_2GB
        description: Set VM RAM to 2GB
        guid: cf1570b2-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 2048
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_CPU_2
        description: Set VM CPU to 2
        guid: e2c3d64e-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '2'
    Condition:
    - name: 34218558-3909-11de-b6d5-005056a11a54
      description: Service Level Platinum - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 2048
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 2
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime: 
      guid: 34218558-3909-11de-b6d5-005056a11a54
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000070
      notes: 
- MiqPolicy:
    name: 4cb4d05c-3909-11de-b6d5-005056a11a54
    description: Service Level Platinum - RAM must be 2GB and 2 vCPUs - on
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: platinum
        - =:
            value: 'on'
            field: Vm-power_state
      context_type: 
    towhat: Vm
    guid: 4cb4d05c-3909-11de-b6d5-005056a11a54
    created_by: 
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of platinum
      has 2 vCPUs and 2GB of memory. If not it changes the vm to these values. This
      policy is used on a powered on vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_RAM_2GB
        description: Set VM RAM to 2GB
        guid: cf1570b2-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 2048
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_CPU_2
        description: Set VM CPU to 2
        guid: e2c3d64e-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '2'
    - qualifier: success
      success_sequence: 4
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_start
        description: Start Virtual Machine
        guid: 55b5a422-3348-11de-bde2-005056a170fa
        action_type: default
        options: 
    Condition:
    - name: 34218558-3909-11de-b6d5-005056a11a54
      description: Service Level Platinum - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 2048
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 2
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime: 
      guid: 34218558-3909-11de-b6d5-005056a11a54
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000070
      notes: 
- MiqPolicy:
    name: Service Level Policy Verify Virtual Hardware - Silver Level
    description: Service Level Silver - RAM must be 512MB and 1 vCPU - off
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: silver
        - =:
            value: 'off'
            field: Vm-power_state
      context_type: 
    towhat: Vm
    guid: 3659b8bc-2866-11de-af2a-0050568026c2
    created_by: 
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of silver has
      1 vCPU and 512MB of memory. If not it changes the vm to these values. This policy
      is used on a powered off vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_CPU_1
        description: Set VM CPU to 1
        guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '1'
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_RAM_512MB
        description: Set VM RAM to 512MB
        guid: bab04cb4-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 512
    Condition:
    - name: Service Level Validation Silver - Powered Off
      description: Service Level Silver - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 512
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 1
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime: 
      guid: 531575ae-9b1c-11dd-bbd7-005056ac7d2c
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000068
      notes: 
- MiqPolicy:
    name: d16643b6-3905-11de-b6d5-005056a11a54
    description: Service Level Silver - RAM must be 512MB and 1 vCPU - on
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - CONTAINS:
            tag: Vm.managed-service_level
            value: silver
        - =:
            value: 'on'
            field: Vm-power_state
      context_type: 
    towhat: Vm
    guid: d16643b6-3905-11de-b6d5-005056a11a54
    created_by: 
    updated_by: admin
    notes: This policy verifies that a vm that has a service level tag of silver has
      1 vCPU and 512MB of memory. If not it changes the vm to these values. This policy
      is used on a powered on vm.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_RAM_512MB
        description: Set VM RAM to 512MB
        guid: bab04cb4-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_memory
        options:
          :value: 512
    - qualifier: success
      success_sequence: 3
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: VM_CPU_1
        description: Set VM CPU to 1
        guid: d97dafba-9af1-11dd-8e55-005056ac7d2c
        action_type: reconfigure_cpus
        options:
          :value: '1'
    - qualifier: success
      success_sequence: 4
      MiqEvent:
        name: assigned_company_tag
        description: Tag Complete
        guid: e384ecb6-1e1e-11de-8918-0050568005db
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_start
        description: Start Virtual Machine
        guid: 55b5a422-3348-11de-bde2-005056a170fa
        action_type: default
        options: 
    Condition:
    - name: Service Level Validation Silver - Powered Off
      description: Service Level Silver - VM RAM and CPU check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - ! '!=':
              value: 512
              field: Vm.hardware-memory_cpu
          - ! '!=':
              value: 1
              field: Vm.hardware-numvcpus
      towhat: Vm
      file_mtime: 
      guid: 531575ae-9b1c-11dd-bbd7-005056ac7d2c
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000068
      notes: 
- MiqPolicy:
    name: 498f5330-fa4b-11de-83ca-005056ba0614
    description: Settings -  Remote syslog Logging
    expression: 
    towhat: Host
    guid: 498f5330-fa4b-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that syslog is configured to utilize a remote server.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: ee09af6e-fa4b-11de-83ca-005056ba0614
      description: Verify syslog Utilizes a Remote Host
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: /^[^#*]\s*.*@/
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/syslog.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: ee09af6e-fa4b-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000025
      notes: This condition checks the file /etc/syslog.conf and verifies the existence
        of the @ parameter, which is used to specify the use of a remote server.
- MiqPolicy:
    name: c340f524-fa3e-11de-83ca-005056ba0614
    description: Settings - /etc/grub.conf
    expression: 
    towhat: Host
    guid: c340f524-fa3e-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that a password is required in order to edit the server's
      boot process.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 1f18225a-fa3f-11de-83ca-005056ba0614
      description: Verify /etc/grub.conf Settings
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*password\s\-\-md5
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/grub.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 1f18225a-fa3f-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000041
      notes: This condition check the file /etc/grub.conf and verifies that the parameter
        "password --md5" exists.
- MiqPolicy:
    name: 6576a074-fa48-11de-83ca-005056ba0614
    description: Settings - /etc/sudoers
    expression: 
    towhat: Host
    guid: 6576a074-fa48-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that sudo is configured to use syslog for logging.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: ade186c6-fa48-11de-83ca-005056ba0614
      description: Verify sudo is Logging via syslog
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*Defaults\s+syslog\=
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/sudoers
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: ade186c6-fa48-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000040
      notes: This condition check the file /etc/sudoers and verifies that the parameter
        "Defaults syslog=" exists.
- MiqPolicy:
    name: ab373d88-fa4a-11de-83ca-005056ba0614
    description: Settings - Display Logs on Different Terminals
    expression: 
    towhat: Host
    guid: ab373d88-fa4a-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that critical, error, and warning level log messages
      are directed to distinct terminals.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: f383ec6c-fa4a-11de-83ca-005056ba0614
      description: Verify Different Logs Displayed on Different Terminals
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*\*\.crit\s+\/dev\/tty
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/syslog.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*\*\.err\s+\/dev\/tty
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/syslog.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*\*\.warning\s+\/dev\/tty
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/syslog.conf
                  field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: f383ec6c-fa4a-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000024
      notes: This condition checks the file /etc/syslog.conf has three seperate parameters
        defined for critical, error, and warning level log messages. These parameters
        specify the tty will display the specified log messages.
- MiqPolicy:
    name: 4b188948-fa45-11de-83ca-005056ba0614
    description: Settings - SNMP Read Only Access
    expression: 
    towhat: Host
    guid: 4b188948-fa45-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that SNMP is configured to only allow read-only access.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: e328c720-fa45-11de-83ca-005056ba0614
      description: SNMP Configured for Read-only Access
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: ^\s*rocommunity
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/snmp/snmpd.conf
                  field: Host.filesystems-name
          - FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  value: ^\s*rwcommunity
                  field: Host.filesystems-contents
              search:
                =:
                  value: /etc/snmp/snmpd.conf
                  field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: e328c720-fa45-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000054
      notes: This condition checks the file /etc/snmp/snmpd.conf and verfies that
        the rocommunity parameter is defined and the rwcommunity parameter is not.
- MiqPolicy:
    name: 0864fae6-fa54-11de-83ca-005056ba0614
    description: Settings - vmkernel Compress Option
    expression: 
    towhat: Host
    guid: 0864fae6-fa54-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the vmkernel log is compressed by default.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: fe7378be-fa53-11de-83ca-005056ba0614
      description: Verify Compression Enabled in vmkernel
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: \s+compress
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmkernel
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: fe7378be-fa53-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000039
      notes: This condition checks the file /etc/logrotate.d/vmkernel and verifies
        that the option compress is enabled.
- MiqPolicy:
    name: 6353b57e-fa53-11de-83ca-005056ba0614
    description: Settings - vmksummary Compress Option
    expression: 
    towhat: Host
    guid: 6353b57e-fa53-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the vmksummary log is compressed by default.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 510f7286-fa53-11de-83ca-005056ba0614
      description: Verify Compression Enabled in vmksummary
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: \s+compress
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmksummary
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 510f7286-fa53-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000038
      notes: This condition checks the file /etc/logrotate.d/vmksummary and verifies
        that the option compress is enabled.
- MiqPolicy:
    name: 4614d62e-fa52-11de-83ca-005056ba0614
    description: Settings - vmkwarning Compress Option
    expression: 
    towhat: Host
    guid: 4614d62e-fa52-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the vmkwarning log is compressed by default.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: a51cbaba-fa52-11de-83ca-005056ba0614
      description: Verify Compression Enabled in vmkwarning
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: \s+compress
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/logrotate.d/vmkwarning
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: a51cbaba-fa52-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000037
      notes: This condition checks the file /etc/logrotate.d/vmkwarning and verifies
        that the option compress is enabled.
- MiqPolicy:
    name: 994efe7e-18e6-11e0-88b4-005056a7184a
    description: ! 'Snapshots: Delete based on Count'
    expression: 
    towhat: Vm
    guid: 994efe7e-18e6-11e0-88b4-005056a7184a
    created_by: admin
    updated_by: admin
    notes: This policy deletes the most recent snapshot when more that 2 snapshots
      exists
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_snapshot_complete
        description: VM Snapshot Create Complete
        guid: 7eb82802-135e-11e0-8706-005056a7184a
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: delete_most_recent_snapshot
        description: Delete Most Recent Snapshot
        guid: 7f6e2f8a-135e-11e0-8706-005056a7184a
        action_type: default
        options: 
    Condition:
    - name: 992035fc-18e7-11e0-88b4-005056a7184a
      description: Check for more than 2 snapshots
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          ! '>':
            value: '2'
            field: Vm-v_total_snapshots
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 992035fc-18e7-11e0-88b4-005056a7184a
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000075
      notes: Checks to see if more than 2 snapshots exist
- MiqPolicy:
    name: cf87e7fc-99d8-11e1-a4bf-005056b057a8
    description: ! 'Snapshots: limit to max of 2'
    expression: 
    towhat: Vm
    guid: cf87e7fc-99d8-11e1-a4bf-005056b057a8
    created_by: admin
    updated_by: admin
    notes: This policy prevents a vm from starting if there are more than 2 snapshots.
      If this number is exceeded, the vm is not allowed to start and the vm annotations
      are updated in the VC
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: vm_stop
        description: Stop Virtual Machine
        guid: 65a63b58-70ac-11e2-9dd9-27a89ff23dc5
        action_type: default
        options: 
    - qualifier: success
      success_sequence: 2
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 8d6ebd90-99d9-11e1-a4bf-005056b057a8
        description: ! 'VM Attribute: Max Snapshots'
        guid: 8d6ebd90-99d9-11e1-a4bf-005056b057a8
        action_type: set_custom_attribute
        options:
          :value: Snapshot Limit Exceeded
          :attribute: EVM Policy
    Condition:
    - name: 9db4783a-99d8-11e1-a4bf-005056b057a8
      description: Snapshot Count >=3
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          ! '>=':
            count: Vm.snapshots
            value: '3'
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 9db4783a-99d8-11e1-a4bf-005056b057a8
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000079
      notes: This condition checks to see if 3 or more snapshots exist
- MiqPolicy:
    name: d9125b42-eb8a-11e0-98ad-005056be005b
    description: ! 'Tag: Host Inherit Selected Cluster Tags'
    expression: 
    towhat: Host
    guid: d9125b42-eb8a-11e0-98ad-005056be005b
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: host_add_to_cluster
        description: Host Added to Cluster
        guid: 972ca5e2-e474-11e0-833e-005056be001b
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: b4c14218-eb89-11e0-98ad-005056be005b
        description: ! 'Tag: Inherit Selected Cluster Tags'
        guid: b4c14218-eb89-11e0-98ad-005056be005b
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - environment
          - datacenter
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: host_scan_complete
        description: Host Analysis Complete
        guid: ffcfb368-455d-11de-86a0-005056a81f62
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: b4c14218-eb89-11e0-98ad-005056be005b
        description: ! 'Tag: Inherit Selected Cluster Tags'
        guid: b4c14218-eb89-11e0-98ad-005056be005b
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - environment
          - datacenter
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: host_connect
        description: Host Connect
        guid: 971e7436-e474-11e0-833e-005056be001b
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: b4c14218-eb89-11e0-98ad-005056be005b
        description: ! 'Tag: Inherit Selected Cluster Tags'
        guid: b4c14218-eb89-11e0-98ad-005056be005b
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - environment
          - datacenter
    Condition: []
- MiqPolicy:
    name: 98557866-d2ee-11de-b4f6-0050568a547d
    description: ! 'Tag: Host Workload - DMZ'
    expression: 
    towhat: Host
    guid: 98557866-d2ee-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policy will automatically apply a DMZ tag to a host if it has access
      to the external vlan
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: host_scan_complete
        description: Host Analysis Complete
        guid: ffcfb368-455d-11de-86a0-005056a81f62
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 330828a4-d2ef-11de-b4f6-0050568a547d
        description: Tag as DMZ
        guid: 330828a4-d2ef-11de-b4f6-0050568a547d
        action_type: tag
        options:
          :tags:
          - /managed/network_location/dmz
    Condition:
    - name: ed3edf84-d2ee-11de-b4f6-0050568a547d
      description: Host - DMZ vlan check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              IS NOT NULL:
                field: Host.lans-created_on
            search:
              INCLUDES:
                value: External
                field: Host.lans-name
      towhat: Host
      file_mtime: 
      guid: ed3edf84-d2ee-11de-b4f6-0050568a547d
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000017
      notes: 
- MiqPolicy:
    name: 0c2517d8-1ea2-11e0-8e71-005056910000
    description: ! 'Tag: VM Inherit Cluster Location Tag'
    expression: 
    towhat: Vm
    guid: 0c2517d8-1ea2-11e0-8e71-005056910000
    created_by: admin
    updated_by: admin
    notes: This policy allows a vm to inherit the location tag of it's parent cluster
      on creation or completion of analysis
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_create
        description: VM Create Complete
        guid: 4c0b4f12-37c0-11df-b567-005056a40709
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 60e5d690-1ea2-11e0-8e71-005056910000
        description: ! 'Tag: Inherit Cluster Location Tag'
        guid: 60e5d690-1ea2-11e0-8e71-005056910000
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - location
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 60e5d690-1ea2-11e0-8e71-005056910000
        description: ! 'Tag: Inherit Cluster Location Tag'
        guid: 60e5d690-1ea2-11e0-8e71-005056910000
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - location
    Condition: []
- MiqPolicy:
    name: 56cae600-4b34-11e0-add8-00505688000a
    description: ! 'Tag: VM Inherit Selected Cluster Tags'
    expression: 
    towhat: Vm
    guid: 56cae600-4b34-11e0-add8-00505688000a
    created_by: admin
    updated_by: admin
    notes: This policy allows a vm to inherit selected tags of it's parent cluster
      on creation or completion of analysis. You should edit the associated action
      to specify the tag categories that should be inherited.
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_create
        description: VM Create Complete
        guid: 4c0b4f12-37c0-11df-b567-005056a40709
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: b4c14218-eb89-11e0-98ad-005056be005b
        description: ! 'Tag: Inherit Selected Cluster Tags'
        guid: b4c14218-eb89-11e0-98ad-005056be005b
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - environment
          - datacenter
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: b4c14218-eb89-11e0-98ad-005056be005b
        description: ! 'Tag: Inherit Selected Cluster Tags'
        guid: b4c14218-eb89-11e0-98ad-005056be005b
        action_type: inherit_parent_tags
        options:
          :parent_type: ems_cluster
          :cats:
          - environment
          - datacenter
    Condition: []
- MiqPolicy:
    name: 66fbec86-d2ef-11de-b4f6-0050568a547d
    description: ! 'Tag: VM Workload - DMZ'
    expression: 
    towhat: Vm
    guid: 66fbec86-d2ef-11de-b4f6-0050568a547d
    created_by: admin
    updated_by: admin
    notes: This policy will automatically apply a DMZ tag to a vm if it has access
      to the external vlan
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: 330828a4-d2ef-11de-b4f6-0050568a547d
        description: Tag as DMZ
        guid: 330828a4-d2ef-11de-b4f6-0050568a547d
        action_type: tag
        options:
          :tags:
          - /managed/network_location/dmz
    Condition:
    - name: 8a975658-d2ef-11de-b4f6-0050568a547d
      description: VM - DMZ check
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              IS NOT NULL:
                field: Vm.lans-created_on
            search:
              INCLUDES:
                value: External
                field: Vm.lans-name
      towhat: Vm
      file_mtime: 
      guid: 8a975658-d2ef-11de-b4f6-0050568a547d
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000018
      notes: 
- MiqPolicy:
    name: 07cea762-3d1b-11df-a7e9-005056a40709
    description: ! 'Tag: VM if Analysis not successful'
    expression: 
    towhat: Vm
    guid: 07cea762-3d1b-11df-a7e9-005056a40709
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_abort
        description: VM Analysis Failure
        guid: 4c48a6fa-37c0-11df-b567-005056a40709
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: fc7f2dde-3d22-11df-a7e9-005056a40709
        description: Tag VM that Fails Analysis
        guid: fc7f2dde-3d22-11df-a7e9-005056a40709
        action_type: tag
        options:
          :variables:
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          - :value: ''
            :oid: ''
            :var_type: <None>
          :tags:
          - /managed/operations/analysis_failed
    Condition: []
- MiqPolicy:
    name: 0ce6cf38-3d2d-11df-a7e9-005056a40709
    description: ! 'Tag: VM on Successful Analysis'
    expression: 
    towhat: Vm
    guid: 0ce6cf38-3d2d-11df-a7e9-005056a40709
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_scan_complete
        description: VM Analysis Complete
        guid: 9aaef9a2-70ac-11e2-a69b-69fdb2b8c1d1
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: cd2f3222-3d2c-11df-a7e9-005056a40709
        description: Tag VM after Successful Analysis
        guid: cd2f3222-3d2c-11df-a7e9-005056a40709
        action_type: tag
        options:
          :tags:
          - /managed/operations/analysis_success
    Condition: []
- MiqPolicy:
    name: b968f0a0-3d2e-11df-a7e9-005056a40709
    description: ! 'Tag: VM that Requires Analysis'
    expression: 
    towhat: Vm
    guid: b968f0a0-3d2e-11df-a7e9-005056a40709
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: a4ccd026-3d2e-11df-a7e9-005056a40709
        description: Tag VM that Requires Analysis
        guid: a4ccd026-3d2e-11df-a7e9-005056a40709
        action_type: tag
        options:
          :tags:
          - /managed/operations/analysis_required
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_create
        description: VM Create Complete
        guid: 4c0b4f12-37c0-11df-b567-005056a40709
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: a4ccd026-3d2e-11df-a7e9-005056a40709
        description: Tag VM that Requires Analysis
        guid: a4ccd026-3d2e-11df-a7e9-005056a40709
        action_type: tag
        options:
          :tags:
          - /managed/operations/analysis_required
    - qualifier: success
      success_sequence: 1
      MiqEvent:
        name: vm_reset
        description: VM Reset
        guid: 4c1b8a3a-37c0-11df-b567-005056a40709
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: a4ccd026-3d2e-11df-a7e9-005056a40709
        description: Tag VM that Requires Analysis
        guid: a4ccd026-3d2e-11df-a7e9-005056a40709
        action_type: tag
        options:
          :tags:
          - /managed/operations/analysis_required
    Condition: []
- MiqPolicy:
    name: bfdeb9d0-1ee3-11e2-9d4b-005056b25af6
    description: Test
    expression: 
    towhat: Vm
    guid: bfdeb9d0-1ee3-11e2-9d4b-005056b25af6
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      failure_synchronous: true
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition: []
- MiqPolicy:
    name: ccadf9fa-fa56-11de-83ca-005056ba0614
    description: Time Keeping - NTP Configured to Use Loopback Adapter
    expression: 
    towhat: Host
    guid: ccadf9fa-fa56-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that NTP performs all name resolutions via a loopback
      network.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 2b9bb8b2-fa57-11de-83ca-005056ba0614
      description: NTP Configured to Use Loopback Adapter
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*restrict\s+127\.0\.0\.1
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 2b9bb8b2-fa57-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000036
      notes: This condition checks the file /etc/ntp.conf and verifies that the restrict
        parameter's value is set to 127.0.0.1.
- MiqPolicy:
    name: ebc02cea-fa57-11de-83ca-005056ba0614
    description: Time Keeping - Restrict Access for Machines without Loopback
    expression: 
    towhat: Host
    guid: ebc02cea-fa57-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that only non-loopback machines can access the NTP
      service.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: ddc26260-fa58-11de-83ca-005056ba0614
      description: Access Restricted for Machines without Loopback
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*restrict\s+default\s+kod\s+nomodify\s+notrap
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: ddc26260-fa58-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000035
      notes: This condition checks the file /etc/ntp.conf and verifies that the line
        "restrict default kod nomodify notrap" exists.
- MiqPolicy:
    name: 3819638c-fa57-11de-83ca-005056ba0614
    description: Timekeeping - Drift Enabled
    expression: 
    towhat: Host
    guid: 3819638c-fa57-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that NTP's driftfile support is enabled.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 71fae5da-fa57-11de-83ca-005056ba0614
      description: Verify NTP Uses a Driftfile
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*driftfile\s+\/var\/lib\/ntp\/drift
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 71fae5da-fa57-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000034
      notes: This condition checks the file /etc/ntp.conf and verifies that the driftfile
        parameter exists.
- MiqPolicy:
    name: c4396f3a-fa55-11de-83ca-005056ba0614
    description: Timekeeping - Minimum of 3 NTP Servers Defined in hosts
    expression: 
    towhat: Host
    guid: c4396f3a-fa55-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that a minimum of 3 NTP servers are defined in the
      local hosts file.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 2698c39c-fa56-11de-83ca-005056ba0614
      description: Verify 3 NTP Servers Defined in hosts File
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              RUBY:
                value: ! "count = 0\ncontext.each_line { |line|                              #
                  Break up the input by lines\n  count += 1 if line =~ /^[^#]*NTP/i
                  \  # Increment Count if line matches our regular expression\n}\nreturn
                  true if count >= 3\nreturn false\n"
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/hosts
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 2698c39c-fa56-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000033
      notes: ! 'This conditions checks the file /etc/hosts and veries that there are
        at least 3 uncommented lines that reference ntp servers. The included expression
        can be modified to match the appropriate values for the ntp servers for your
        environment.

'
- MiqPolicy:
    name: a6c2a51e-fa57-11de-83ca-005056ba0614
    description: Timekeeping - Minimum of 3 NTP Servers Defined in ntp.conf
    expression: 
    towhat: Host
    guid: a6c2a51e-fa57-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that a minimum of 3 servers are defined in the NTP
      configuration.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 03c821bc-fa58-11de-83ca-005056ba0614
      description: Verify 3 NTP Servers Defined in ntp.conf
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              RUBY:
                value: ! "count = 0\ncontext.each_line { |line|                              #
                  Break up the input by lines\n  count += 1 if line =~ /^[^#]*server\\s+[0-9A-Za-z]+/
                  \  # Increment Count if line matches our regular expression\n}\nreturn
                  true if count >= 3\nreturn false"
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp.conf
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 03c821bc-fa58-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000032
      notes: This condition checks the file /etc/ntp.conf and verifies that a minimum
        of three ntp servers are defined.
- MiqPolicy:
    name: 8d4a7bee-fa56-11de-83ca-005056ba0614
    description: Timekeeping - Minimum of 3 NTP Servers defined in step-tickers
    expression: 
    towhat: Host
    guid: 8d4a7bee-fa56-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that a minimum of 3 servers are defined in the NTP
      step-tickers configuration.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 0806448a-fa57-11de-83ca-005056ba0614
      description: Verify 3 NTP Servers Defined in step-tickers File
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              RUBY:
                value: ! "count = 0\ncontext.each_line { |line|                              #
                  Break up the input by lines\n  count += 1 if line =~ /^[^#]*server\\s+[0-9A-Za-z]+/
                  \  # Increment Count if line matches our regular expression\n}\nreturn
                  true if count >= 3\nreturn false\n"
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/ntp/step-tickers
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 0806448a-fa57-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000023
      notes: This condition checks the file /etc/ntp/step-tickers and verifies that
        a minimum of three ntp servers are defined.
- MiqPolicy:
    name: 4ed279b2-fa55-11de-83ca-005056ba0614
    description: Timekeeping - NTP Service Running
    expression: 
    towhat: Host
    guid: 4ed279b2-fa55-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that the NTP servers is configured to automatically
      start.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 9a08d21e-fa55-11de-83ca-005056ba0614
      description: Verify NTP is Running
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              INCLUDES:
                value: '3'
                field: Host.host_services-enable_run_levels
            search:
              =:
                value: ntpd
                field: Host.host_services-name
      towhat: Host
      file_mtime: 
      guid: 9a08d21e-fa55-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000031
      notes: This condition verifies that the run level of the service ntpd is set
        to three.
- MiqPolicy:
    name: a8e0ef7c-fa48-11de-83ca-005056ba0614
    description: Use sudo aliases
    expression: 
    towhat: Host
    guid: a8e0ef7c-fa48-11de-83ca-005056ba0614
    created_by: admin
    updated_by: admin
    notes: This policy verifies that user aliases are enabled in the configuration
      of the sudo command.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 99496ebc-fa49-11de-83ca-005056ba0614
      description: Aliases are being used for sudo authorization
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION MATCHES:
                value: ^\s*User_Alias
                field: Host.filesystems-contents
            search:
              =:
                value: /etc/sudoers
                field: Host.filesystems-name
      towhat: Host
      file_mtime: 
      guid: 99496ebc-fa49-11de-83ca-005056ba0614
      filename: 
      applies_to_exp: 
      miq_policy_id: 10000000000030
      notes: This condition checks the file /etc/sudoers and verifies that the parameter
        "User_Alias" is defined.
- MiqPolicy:
    name: 2cd19756-c1ec-11e1-ae68-000c29cc1a4c
    description: VMWare SHG v4.x & v5.x - VMX01 - Prevent virtual disk shrinking.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: VMware
          field: Vm-vendor
      context_type: 
    towhat: Vm
    guid: 2cd19756-c1ec-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMWare SHG v4.x & v5.x - VMX01 - Prevent virtual disk shrinking. R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 11564bce-c1ed-11e1-ae68-000c29cc1a4c
      description: VMWare SHG v4.x - VMX01 - Prevent virtual disk shrinking
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.diskShrink.disable
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.diskWiper.disable
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 11564bce-c1ed-11e1-ae68-000c29cc1a4c
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            value: '4'
            field: Vm.host-vmm_version
        context_type: 
      miq_policy_id: 13
      notes: VMWare SHG v4.x - VMX01 - Prevent virtual disk shrinking R1
    - name: d4bd19f4-d7d6-11e1-b3e5-000c2999f7f1
      description: VMWare SHG v5.x - VMX01 - Prevent virtual disk shrinking
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              =:
                field: Vm.advanced_settings-value
                value: 'true'
            search:
              =:
                field: Vm.advanced_settings-name
                value: isolation.tools.diskWiper.disable
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: d4bd19f4-d7d6-11e1-b3e5-000c2999f7f1
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Vm.host-vmm_version
            value: '5'
        context_type: 
      miq_policy_id: 13
      notes: VMWare SHG v5.x - VMX01 - Prevent virtual disk shrinking R1
- MiqPolicy:
    name: 774404fc-c1c1-11e1-ae68-000c29cc1a4c
    description: VMWare SHG v4.x & v5.x - VMX22 - Avoid using independent nonpersistent
      disks.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: VMware
          field: Vm-vendor
      context_type: 
    towhat: Vm
    guid: 774404fc-c1c1-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMWare SHG v4.x & v5.x - VMX22 - Avoid using independent nonpersistent
      disks.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: b6c3548e-c1c1-11e1-ae68-000c29cc1a4c
      description: VMWare SHG v4.x & v5.x - VMX22 - Avoid using independent nonpersistent
        disks.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkcount:
              =:
                value: '0'
                field: <count>
            search:
              INCLUDES:
                value: independent_nonpersistent
                field: Vm.hardware.disks-mode
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: b6c3548e-c1c1-11e1-ae68-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 3
      notes: VMWare SHG v4.x & v5.x - VMX22 - Avoid using independent nonpersistent
        disks. R1
- MiqPolicy:
    name: 5e3a568e-cfe3-11e1-986c-000c29cc1a4c
    description: VMWare SHG v4.x & v5.x - VSH05 - Install VMware vCenter Server using
      a service account
    expression: !ruby/object:MiqExpression
      exp:
        CONTAINS:
          field: Vm.win32_services-name
          value: vpxd
      context_type: 
    towhat: Vm
    guid: 5e3a568e-cfe3-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMWare SHG v4.x & v5.x - VSH05 - Install VMware vCenter Server using a
      service account R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 9e841928-cfe8-11e1-986c-000c29cc1a4c
      description: VMWare SHG v4.x & v5.x - VSH05 - Install VMware vCenter Server
        using a service account
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              REGULAR EXPRESSION DOES NOT MATCH:
                field: Vm.win32_services-object_name
                value: \bLocalSystem
            search:
              =:
                field: Vm.win32_services-name
                value: vpxd
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 9e841928-cfe8-11e1-986c-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 4
      notes: VMWare SHG v4.x & v5.x - VSH05 - Install VMware vCenter Server using
        a service account R1
- MiqPolicy:
    name: 17fce8ee-c39f-11e1-aed6-000c29cc1a4c
    description: VMware SHG - VMX24 - Disable certain unexposed features.
    expression: 
    towhat: Vm
    guid: 17fce8ee-c39f-11e1-aed6-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG - VMX24 - Disable certain unexposed features.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 98427d34-c39f-11e1-aed6-000c29cc1a4c
      description: Disable certain unexposed features
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.unity.push.update.disable
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.ghi.launchmenu.change
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.memSchedFakeSampleStats.disable
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.tools.getCreds.disable
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 98427d34-c39f-11e1-aed6-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 1
      notes: 
- MiqPolicy:
    name: e5871bee-d435-11e1-9935-000c2999f7f1
    description: VMware SHG v4.x & v5.x - HCN05 - Disable DCUI to prevent all local
      administrative control
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: ESXi
          field: Host-vmm_product
      context_type: 
    towhat: Host
    guid: e5871bee-d435-11e1-9935-000c2999f7f1
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x & v5.x - HCN05 - Disable DCUI to prevent all local administrative
      control R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 0f6761b2-d436-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x & v5.x - HCN05 - Disable DCUI to prevent all local
        administrative control
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: 'false'
                field: Host.host_services-running
            search:
              =:
                value: DCUI
                field: Host.host_services-name
        context_type: 
      towhat: Host
      file_mtime: 
      guid: 0f6761b2-d436-11e1-9935-000c2999f7f1
      filename: 
      applies_to_exp: 
      miq_policy_id: 14
      notes: VMware SHG v4.x & v5.x - HCN05 - Disable DCUI to prevent all local administrative
        control R1
- MiqPolicy:
    name: 3a2acbde-d434-11e1-9935-000c2999f7f1
    description: VMware SHG v4.x & v5.x - HCN06 - Disable Tech Support Mode unless
      needed for diagnostics and break-fix
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type: 
    towhat: Host
    guid: 3a2acbde-d434-11e1-9935-000c2999f7f1
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x & v5.x - HCN06 - Disable Tech Support Mode unless needed
      for diagnostics and break-fix R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: e35c1be0-d434-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x & v5.x - HCN06 - Disable Tech Support Mode unless
        needed for diagnostics and break-fix
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                field: Host.host_services-running
                value: 'false'
            search:
              =:
                field: Host.host_services-name
                value: TSM
        context_type: 
      towhat: Host
      file_mtime: 
      guid: e35c1be0-d434-11e1-9935-000c2999f7f1
      filename: 
      applies_to_exp: 
      miq_policy_id: 15
      notes: VMware SHG v4.x & v5.x - HCN06 - Disable Tech Support Mode unless needed
        for diagnostics and break-fix R1
- MiqPolicy:
    name: 36021318-d435-11e1-9935-000c2999f7f1
    description: VMware SHG v4.x & v5.x - HCN07 - Set a timeout for Tech Support Mode.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type: 
    towhat: Host
    guid: 36021318-d435-11e1-9935-000c2999f7f1
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x & v5.x - HCN07 - Set a timeout for Tech Support Mode. R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 9f3b5376-d435-11e1-9935-000c2999f7f1
      description: VMware SHG v4.x - HCN07 - Set a timeout for Tech Support Mode.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            FIND:
              checkall:
                =:
                  field: Host.advanced_settings-value
                  value: '0'
              search:
                =:
                  field: Host.advanced_settings-name
                  value: UserVars.TSMTimeOut
        context_type: 
      towhat: Host
      file_mtime: 
      guid: 9f3b5376-d435-11e1-9935-000c2999f7f1
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Host-vmm_version
            value: '4'
        context_type: 
      miq_policy_id: 5
      notes: VMware SHG v4.x - HCN07 - Set a timeout for Tech Support Mode. R1
    - name: fc017d86-d7cf-11e1-b3e5-000c2999f7f1
      description: VMware SHG v5.x - HCN07 - Set a timeout for Tech Support Mode.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          not:
            FIND:
              checkall:
                =:
                  value: '0'
                  field: Host.advanced_settings-value
              search:
                =:
                  value: UserVars.ESXiShellTimeOut
                  field: Host.advanced_settings-name
        context_type: 
      towhat: Host
      file_mtime: 
      guid: fc017d86-d7cf-11e1-b3e5-000c2999f7f1
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            value: '5'
            field: Host-vmm_version
        context_type: 
      miq_policy_id: 5
      notes: VMware SHG v5.x - HCN07 - Set a timeout for Tech Support Mode. R1
- MiqPolicy:
    name: 4dadd9bc-d443-11e1-9935-000c2999f7f1
    description: VMware SHG v4.x & v5.x - HLG01 - Remote syslog should be configured
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: ESXi
          field: Host-vmm_product
      context_type: 
    towhat: Host
    guid: 4dadd9bc-d443-11e1-9935-000c2999f7f1
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x & v5.x - HLG01 - Remote syslog should be configured
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: b60247d2-d443-11e1-9935-000c2999f7f1
      description: VMware SHG v5.x - HLG01 - Remote syslog should be configured
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              IS NOT EMPTY:
                value: ''
                field: Host.advanced_settings-value
            search:
              =:
                value: Syslog.global.logHost
                field: Host.advanced_settings-name
        context_type: 
      towhat: Host
      file_mtime: 
      guid: b60247d2-d443-11e1-9935-000c2999f7f1
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Host-vmm_version
            value: '5'
        context_type: 
      miq_policy_id: 6
      notes: VMware SHG - HLG01 - Remote syslog should be configured VERSION 5.x ONLY
        R1
    - name: 456a882a-d7ce-11e1-b3e5-000c2999f7f1
      description: VMware SHG v4.x - HLG01 - Remote syslog should be configured
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              IS NOT EMPTY:
                field: Host.advanced_settings-value
                value: ''
            search:
              =:
                field: Host.advanced_settings-name
                value: Syslog.Remote.Hostname
        context_type: 
      towhat: Host
      file_mtime: 
      guid: 456a882a-d7ce-11e1-b3e5-000c2999f7f1
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Host-vmm_version
            value: '4'
        context_type: 
      miq_policy_id: 6
      notes: VMware SHG - HLG01 - Remote syslog should be configured VERSION 4.x ONLY
        R1
- MiqPolicy:
    name: 197d032e-d016-11e1-986c-000c29cc1a4c
    description: ! "VMware SHG v4.x & v5.x - NCN03 - Ensure that the â\x80\x9CMAC
      Address Changeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: ESXi
          field: Host-vmm_product
      context_type: 
    towhat: Host
    guid: 197d032e-d016-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: ! "VMware SHG v4.x & v5.x - NCN03 - Ensure that the â\x80\x9CMAC Address
      Changeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D R1"
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 3531486e-d016-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x & v5.x - NCN03 - Ensure that the â\x80\x9CMAC
        Address Changeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: 'false'
                field: Host.lans-mac_changes
            search:
              IS NOT NULL:
                value: ''
                field: Host.lans-name
        context_type: 
      towhat: Host
      file_mtime: 
      guid: 3531486e-d016-11e1-986c-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 7
      notes: ! "VMware SHG v4.x & v5.x - NCN03 - Ensure that the â\x80\x9CMAC Address
        Changeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D R1"
- MiqPolicy:
    name: e4d7e0e6-d00e-11e1-986c-000c29cc1a4c
    description: ! "VMware SHG v4.x & v5.x - NCN04 - Ensure that the â\x80\x9CForged
      Transmitsâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type: 
    towhat: Host
    guid: e4d7e0e6-d00e-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: ! "VMware SHG v4.x & v5.x - NCN04 - Ensure that the â\x80\x9CForged Transmitsâ\x80\x9D
      policy is set to â\x80\x9Creject.â\x80\x9D R1"
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: ed54d6d8-d00f-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x & v5.x - NCN04 - Ensure that the â\x80\x9CForged
        Transmitsâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                value: 'false'
                field: Host.lans-forged_transmits
            search:
              IS NOT NULL:
                value: ''
                field: Host.lans-name
        context_type: 
      towhat: Host
      file_mtime: 
      guid: ed54d6d8-d00f-11e1-986c-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 8
      notes: ! "VMware SHG v4.x & v5.x - NCN04 - Ensure that the â\x80\x9CForged Transmitsâ\x80\x9D
        policy is set to â\x80\x9Creject.â\x80\x9D R1"
- MiqPolicy:
    name: d7ed01f4-d00e-11e1-986c-000c29cc1a4c
    description: ! "VMware SHG v4.x & v5.x - NCN05 -Ensure that the â\x80\x9CPromiscuous
      Modeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type: 
    towhat: Host
    guid: d7ed01f4-d00e-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: ! "VMware SHG v4.x & v5.x - NCN05 -Ensure that the â\x80\x9CPromiscuous
      Modeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D R1"
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: abb1772c-d00f-11e1-986c-000c29cc1a4c
      description: ! "VMware SHG v4.x & v5.x - NCN05 -Ensure that the â\x80\x9CPromiscuous
        Modeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D"
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkall:
              =:
                field: Host.lans-allow_promiscuous
                value: 'false'
            search:
              IS NOT NULL:
                field: Host.lans-name
                value: ''
        context_type: 
      towhat: Host
      file_mtime: 
      guid: abb1772c-d00f-11e1-986c-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 9
      notes: ! "VMware SHG v4.x & v5.x - NCN05 -Ensure that the â\x80\x9CPromiscuous
        Modeâ\x80\x9D policy is set to â\x80\x9Creject.â\x80\x9D R1"
- MiqPolicy:
    name: 86c84f3a-d005-11e1-986c-000c29cc1a4c
    description: VMware SHG v4.x & v5.x - NCN10 - Ensure that port groups are configured
      with a clear network label
    expression: !ruby/object:MiqExpression
      exp:
        =:
          field: Host-vmm_product
          value: ESXi
      context_type: 
    towhat: Host
    guid: 86c84f3a-d005-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x & v5.x - NCN10 - Ensure that port groups are configured
      with a clear network label R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: e1c666a0-d006-11e1-986c-000c29cc1a4c
      description: VMware SHG v4.x & v5.x - NCN10 - Ensure that port groups are configured
        with a clear network label
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - FIND:
              checkcount:
                =:
                  field: <count>
                  value: '0'
              search:
                IS NULL:
                  field: Host.lans-name
                  value: ''
          - FIND:
              checkcount:
                =:
                  value: '0'
                  field: <count>
              search:
                IS EMPTY:
                  value: ''
                  field: Host.lans-name
        context_type: 
      towhat: Host
      file_mtime: 
      guid: e1c666a0-d006-11e1-986c-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 11
      notes: VMware SHG v4.x & v5.x - NCN10 - Ensure that port groups are configured
        with a clear network label R1
- MiqPolicy:
    name: cee396f8-c1f0-11e1-ae68-000c29cc1a4c
    description: VMware SHG v4.x & v5.x - VMX02 - Prevent other users from spying
      on administrator remote consoles.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: VMware
          field: Vm-vendor
      context_type: 
    towhat: Vm
    guid: cee396f8-c1f0-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x & v5.x - VMX02 - Prevent other users from spying on administrator
      remote consoles.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 71089c6c-c1f1-11e1-ae68-000c29cc1a4c
      description: VMware SHG v4.x & v5.x - VMX02 - Prevent other users from spying
        on administrator remote consoles.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              =:
                value: '1'
                field: Vm.advanced_settings-value
            search:
              =:
                value: RemoteDisplay.maxConnections
                field: Vm.advanced_settings-name
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 71089c6c-c1f1-11e1-ae68-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 2
      notes: VMware SHG v4.x & v5.x - VMX02 - Prevent other users from spying on administrator
        remote consoles. R1
- MiqPolicy:
    name: 1d60a788-c1f3-11e1-ae68-000c29cc1a4c
    description: VMware SHG v4.x & v5.x - VMX11 Prevent unauthorized removal, connection
      and modification of devices
    expression: !ruby/object:MiqExpression
      exp:
        and:
        - =:
            field: Vm-vendor
            value: VMware
        - STARTS WITH:
            value: '5'
            field: Vm.host-vmm_version
      context_type: 
    towhat: Vm
    guid: 1d60a788-c1f3-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x & v5.x - VMX11 Prevent unauthorized removal, connection
      and modification of devices
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 728e7050-c1f3-11e1-ae68-000c29cc1a4c
      description: VMware SHG v5.x - VMX11 Prevent unauthorized removal, connection
        and modification of devices
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              =:
                value: 'true'
                field: Vm.advanced_settings-value
            search:
              =:
                value: isolation.device.connectable.disable
                field: Vm.advanced_settings-name
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 728e7050-c1f3-11e1-ae68-000c29cc1a4c
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            field: Vm.host-vmm_version
            value: '5'
        context_type: 
      miq_policy_id: 12
      notes: VMware SHG v5.x - VMX11 Prevent unauthorized removal, connection and
        modification of devices R1
    - name: aaa64a08-d7d8-11e1-b3e5-000c2999f7f1
      description: VMware SHG v4.x - VMX11 Prevent unauthorized removal, connection
        and modification of devices
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          and:
          - FIND:
              checkany:
                =:
                  value: 'true'
                  field: Vm.advanced_settings-value
              search:
                =:
                  value: isolation.device.connectable.disable
                  field: Vm.advanced_settings-name
          - FIND:
              checkany:
                =:
                  field: Vm.advanced_settings-value
                  value: 'true'
              search:
                =:
                  field: Vm.advanced_settings-name
                  value: isolation.device.edit.disable
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: aaa64a08-d7d8-11e1-b3e5-000c2999f7f1
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            value: '4'
            field: Vm.host-vmm_version
        context_type: 
      miq_policy_id: 12
      notes: VMware SHG v4.x - VMX11 Prevent unauthorized removal, connection and
        modification of devices R1
- MiqPolicy:
    name: 769b4b1e-c1f8-11e1-ae68-000c29cc1a4c
    description: VMware SHG v4.x & v5.x - VMX30 - Disable remote operations within
      the guest.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: VMware
          field: Vm-vendor
      context_type: 
    towhat: Vm
    guid: 769b4b1e-c1f8-11e1-ae68-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4.x & v5.x - VMX30 - Disable remote operations within the guest.
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: vm_compliance_check
        description: VM Compliance Check
        guid: 816a598a-f57d-11de-a41a-005056ba0614
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 8b7f39d2-c1f8-11e1-ae68-000c29cc1a4c
      description: VMware SHG v4.x - VMX30 - Disable remote operations within the
        guest.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          FIND:
            checkany:
              =:
                field: Vm.advanced_settings-value
                value: 'false'
            search:
              =:
                field: Vm.advanced_settings-name
                value: guest.commands.enabled
        context_type: 
      towhat: Vm
      file_mtime: 
      guid: 8b7f39d2-c1f8-11e1-ae68-000c29cc1a4c
      filename: 
      applies_to_exp: !ruby/object:MiqExpression
        exp:
          STARTS WITH:
            value: '4'
            field: Vm.host-vmm_version
        context_type: 
      miq_policy_id: 16
      notes: VMware SHG v4.x - VMX30 - Disable remote operations within the guest.
        R1
- MiqPolicy:
    name: e99a4c3e-d00b-11e1-986c-000c29cc1a4c
    description: VMware SHG v4x. & v5.x - NCN11 - Ensure that all vSwitches have a
      clear network label.
    expression: !ruby/object:MiqExpression
      exp:
        =:
          value: ESXi
          field: Host-vmm_product
      context_type: 
    towhat: Host
    guid: e99a4c3e-d00b-11e1-986c-000c29cc1a4c
    created_by: admin
    updated_by: admin
    notes: VMware SHG v4x. & v5.x - NCN11 - Ensure that all vSwitches have a clear
      network label. R1
    active: true
    mode: compliance
    MiqPolicyContent:
    - qualifier: failure
      failure_sequence: 1
      MiqEvent:
        name: host_compliance_check
        description: Host Compliance Check
        guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: compliance_failed
        description: Mark as Non-Compliant
        guid: ba452d94-f586-11de-8ebc-0050568a07c7
        action_type: default
        options: 
    Condition:
    - name: 5ca4abca-d00c-11e1-986c-000c29cc1a4c
      description: VMware SHG v4x. & v5.x - NCN11 - Ensure that all vSwitches have
        a clear network label.
      modifier: allow
      expression: !ruby/object:MiqExpression
        exp:
          or:
          - FIND:
              checkall:
                IS NOT NULL:
                  value: ''
                  field: Host.hardware.ports-device_name
              search:
                =:
                  value: ethernet
                  field: Host.hardware.ports-device_type
          - FIND:
              checkall:
                IS NOT EMPTY:
                  field: Host.hardware.ports-device_name
                  value: ''
              search:
                =:
                  field: Host.hardware.ports-device_type
                  value: ethernet
        context_type: 
      towhat: Host
      file_mtime: 
      guid: 5ca4abca-d00c-11e1-986c-000c29cc1a4c
      filename: 
      applies_to_exp: 
      miq_policy_id: 10
      notes: VMware SHG v4x. & v5.x - NCN11 - Ensure that all vSwitches have a clear
        network label. R1
- MiqPolicy:
    name: d4640a18-e15d-11e1-acfa-005056b25af6
    description: powervm
    expression: 
    towhat: Vm
    guid: d4640a18-e15d-11e1-acfa-005056b25af6
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent:
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: vm_start
        description: VM Power On
        guid: 99cb5bb6-70ac-11e2-9a67-85261e94c1fd
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: b0138b70-e15d-11e1-8744-005056b25af6
        description: powerVM
        guid: b0138b70-e15d-11e1-8744-005056b25af6
        action_type: custom_automation
        options:
          :ae_message: create
          :ae_request: powerVM
    - qualifier: success
      success_sequence: 1
      success_synchronous: true
      MiqEvent:
        name: vm_poweroff
        description: VM Power Off
        guid: 48beeadc-ae7c-11e1-a76f-005056b25af6
        event_type: Default
        definition: 
        default: 
        enabled: 
      MiqAction:
        name: b0138b70-e15d-11e1-8744-005056b25af6
        description: powerVM
        guid: b0138b70-e15d-11e1-8744-005056b25af6
        action_type: custom_automation
        options:
          :ae_message: create
          :ae_request: powerVM
    Condition: []
- MiqPolicy:
    name: 51af8026-e661-11e1-900d-005056b25af6
    description: test
    expression: 
    towhat: Vm
    guid: 51af8026-e661-11e1-900d-005056b25af6
    created_by: admin
    updated_by: admin
    notes: 
    active: true
    mode: control
    MiqPolicyContent: []
    Condition: []
